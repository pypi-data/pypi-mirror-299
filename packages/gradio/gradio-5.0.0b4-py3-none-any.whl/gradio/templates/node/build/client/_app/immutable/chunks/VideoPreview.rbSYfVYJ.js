import{s as de,v as Ce,w as Be,b as P,f as p,p as k,i as L,h as I,n as le,e as j,c as M,J as Ie,O as Ye,a as z,g as F,E as oe,F as J,R as Me,T as Se,P as Ee,q as Z,r as ee,L as te,z as se,t as we,d as ke,j as je,G as Ne,V as Ze,y as Je,M as Y,N as xe,W as $e}from"./scheduler.xQsDa6L3.js";import{S as ce,i as me,c as N,a as A,m as U,t as T,g as ie,b as V,e as ae,d as H,f as ne}from"./index.lnKugwF0.js";import{f as Ae,r as et,s as tt,y as fe,I as Re,p as nt,u as lt}from"./2.Bbgn9Xo5.js";import{B as it}from"./BlockLabel.EPnqKJ7A.js";import{E as at}from"./Empty.cyjo30Lv.js";import{S as rt}from"./ShareButton.D8AlU4Ik.js";import{D as ot}from"./Download.D3uG4UtN.js";import{V as Ke}from"./Video.erEfpUh6.js";import{I as st}from"./IconButtonWrapper.BqTT2q5U.js";import{D as ut}from"./DownloadLink.CKHw4SYR.js";import{T as ft,P as dt}from"./Trim.DWkxzAmU.js";import{P as _t}from"./Play.CU1vvr5w.js";import{U as Qe}from"./Undo.DbpOC6Td.js";import{b as ct,t as mt,V as ht}from"./Video.BpynpsrS.js";/* empty css                                             */import{M as gt}from"./ModifyUpload.Vg2xjd6m.js";function bt(l){let e,n;return{c(){e=Ce("svg"),n=Ce("path"),this.h()},l(t){e=Be(t,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,"stroke-linecap":!0,"stroke-linejoin":!0});var i=P(e);n=Be(i,"path",{d:!0}),P(n).forEach(p),i.forEach(p),this.h()},h(){k(n,"d","M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"width","100%"),k(e,"height","100%"),k(e,"viewBox","0 0 24 24"),k(e,"fill","none"),k(e,"stroke","currentColor"),k(e,"stroke-width","1.5"),k(e,"stroke-linecap","round"),k(e,"stroke-linejoin","round")},m(t,i){L(t,e,i),I(e,n)},p:le,i:le,o:le,d(t){t&&p(e)}}}class vt extends ce{constructor(e){super(),me(this,e,null,bt,de,{})}}function Ue(l,e,n){const t=l.slice();return t[20]=e[n],t[22]=n,t}function wt(l){let e,n,t,i,r,a=[],o=new Map,m,g,f,w,d=Ae(l[1]);const s=_=>_[22];for(let _=0;_<d.length;_+=1){let h=Ue(l,d,_),D=s(h);o.set(D,a[_]=He(D,h))}return{c(){e=j("div"),n=j("button"),t=z(),i=j("div"),r=z();for(let _=0;_<a.length;_+=1)a[_].c();m=z(),g=j("button"),this.h()},l(_){e=M(_,"DIV",{id:!0,class:!0});var h=P(e);n=M(h,"BUTTON",{"aria-label":!0,class:!0,style:!0}),P(n).forEach(p),t=F(h),i=M(h,"DIV",{class:!0,style:!0}),P(i).forEach(p),r=F(h);for(let D=0;D<a.length;D+=1)a[D].l(h);m=F(h),g=M(h,"BUTTON",{"aria-label":!0,class:!0,style:!0}),P(g).forEach(p),h.forEach(p),this.h()},h(){k(n,"aria-label","start drag handle for trimming video"),k(n,"class","handle left svelte-kn3uji"),oe(n,"left",l[2]+"%"),k(i,"class","opaque-layer svelte-kn3uji"),oe(i,"left",l[2]+"%"),oe(i,"right",100-l[3]+"%"),k(g,"aria-label","end drag handle for trimming video"),k(g,"class","handle right svelte-kn3uji"),oe(g,"left",l[3]+"%"),k(e,"id","timeline"),k(e,"class","thumbnail-wrapper svelte-kn3uji")},m(_,h){L(_,e,h),I(e,n),I(e,t),I(e,i),I(e,r);for(let D=0;D<a.length;D+=1)a[D]&&a[D].m(e,null);I(e,m),I(e,g),f||(w=[J(n,"mousedown",l[10]),J(n,"blur",l[5]),J(n,"keydown",l[11]),J(g,"mousedown",l[12]),J(g,"blur",l[5]),J(g,"keydown",l[13])],f=!0)},p(_,h){h&4&&oe(n,"left",_[2]+"%"),h&4&&oe(i,"left",_[2]+"%"),h&8&&oe(i,"right",100-_[3]+"%"),h&2&&(d=Ae(_[1]),a=et(a,h,s,1,_,d,o,e,tt,He,m,Ue)),h&8&&oe(g,"left",_[3]+"%")},d(_){_&&p(e);for(let h=0;h<a.length;h+=1)a[h].d();f=!1,Me(w)}}}function kt(l){let e,n='<span aria-label="loading timeline" class="loader svelte-kn3uji"></span>';return{c(){e=j("div"),e.innerHTML=n,this.h()},l(t){e=M(t,"DIV",{class:!0,"data-svelte-h":!0}),Se(e)!=="svelte-13yzice"&&(e.innerHTML=n),this.h()},h(){k(e,"class","load-wrap svelte-kn3uji")},m(t,i){L(t,e,i)},p:le,d(t){t&&p(e)}}}function He(l,e){let n,t,i;return{key:l,first:null,c(){n=j("img"),this.h()},l(r){n=M(r,"IMG",{src:!0,alt:!0,draggable:!0,class:!0}),this.h()},h(){Ee(n.src,t=e[20])||k(n,"src",t),k(n,"alt",i=`frame-${e[22]}`),k(n,"draggable","false"),k(n,"class","svelte-kn3uji"),this.first=n},m(r,a){L(r,n,a)},p(r,a){e=r,a&2&&!Ee(n.src,t=e[20])&&k(n,"src",t),a&2&&i!==(i=`frame-${e[22]}`)&&k(n,"alt",i)},d(r){r&&p(n)}}}function Et(l){let e;function n(r,a){return r[0]?kt:wt}let t=n(l),i=t(l);return{c(){e=j("div"),i.c(),this.h()},l(r){e=M(r,"DIV",{class:!0});var a=P(e);i.l(a),a.forEach(p),this.h()},h(){k(e,"class","container svelte-kn3uji")},m(r,a){L(r,e,a),i.m(e,null)},p(r,[a]){t===(t=n(r))&&i?i.p(r,a):(i.d(1),i=t(r),i&&(i.c(),i.m(e,null)))},i:le,o:le,d(r){r&&p(e),i.d()}}}let De=10;function pt(l,e,n){let{videoElement:t}=e,{trimmedDuration:i}=e,{dragStart:r}=e,{dragEnd:a}=e,{loadingTimeline:o}=e,m=[],g,f=0,w=100,d=null;const s=v=>{d=v},_=()=>{d=null},h=(v,R)=>{if(d){const c=document.getElementById("timeline");if(!c)return;const S=c.getBoundingClientRect();let B=(v.clientX-S.left)/S.width*100;if(R?B=d==="left"?f+R:w+R:B=(v.clientX-S.left)/S.width*100,B=Math.max(0,Math.min(B,100)),d==="left"){n(2,f=Math.min(B,w));const q=f/100*g;n(6,t.currentTime=q,t),n(8,r=q)}else if(d==="right"){n(3,w=Math.max(B,f));const q=w/100*g;n(6,t.currentTime=q,t),n(9,a=q)}const Q=f/100*g,E=w/100*g;n(7,i=E-Q),n(2,f),n(3,w)}},D=v=>{if(d){const R=1/g*100;v.key==="ArrowLeft"?h({clientX:0},-R):v.key==="ArrowRight"&&h({clientX:0},R)}},O=()=>{const v=document.createElement("canvas"),R=v.getContext("2d");if(!R)return;v.width=t.videoWidth,v.height=t.videoHeight,R.drawImage(t,0,0,v.width,v.height);const c=v.toDataURL("image/jpeg",.7);n(1,m=[...m,c])};Ie(()=>{const v=()=>{g=t.duration;const R=g/De;let c=0;const S=()=>{O(),c++,c<De?n(6,t.currentTime+=R,t):t.removeEventListener("seeked",S)};t.addEventListener("seeked",S),n(6,t.currentTime=0,t)};t.readyState>=1?v():t.addEventListener("loadedmetadata",v)}),Ye(()=>{window.removeEventListener("mousemove",h),window.removeEventListener("mouseup",_),window.removeEventListener("keydown",D)}),Ie(()=>{window.addEventListener("mousemove",h),window.addEventListener("mouseup",_),window.addEventListener("keydown",D)});const G=()=>s("left"),X=v=>{(v.key==="ArrowLeft"||v.key=="ArrowRight")&&s("left")},K=()=>s("right"),W=v=>{(v.key==="ArrowLeft"||v.key=="ArrowRight")&&s("right")};return l.$$set=v=>{"videoElement"in v&&n(6,t=v.videoElement),"trimmedDuration"in v&&n(7,i=v.trimmedDuration),"dragStart"in v&&n(8,r=v.dragStart),"dragEnd"in v&&n(9,a=v.dragEnd),"loadingTimeline"in v&&n(0,o=v.loadingTimeline)},l.$$.update=()=>{l.$$.dirty&2&&n(0,o=m.length!==De)},[o,m,f,w,s,_,t,i,r,a,G,X,K,W]}class Tt extends ce{constructor(e){super(),me(this,e,pt,Et,de,{videoElement:6,trimmedDuration:7,dragStart:8,dragEnd:9,loadingTimeline:0})}}function Oe(l){let e,n,t,i,r,a,o;function m(s){l[18](s)}function g(s){l[19](s)}function f(s){l[20](s)}function w(s){l[21](s)}let d={videoElement:l[2]};return l[14]!==void 0&&(d.dragStart=l[14]),l[15]!==void 0&&(d.dragEnd=l[15]),l[12]!==void 0&&(d.trimmedDuration=l[12]),l[16]!==void 0&&(d.loadingTimeline=l[16]),n=new Tt({props:d}),ee.push(()=>ne(n,"dragStart",m)),ee.push(()=>ne(n,"dragEnd",g)),ee.push(()=>ne(n,"trimmedDuration",f)),ee.push(()=>ne(n,"loadingTimeline",w)),{c(){e=j("div"),N(n.$$.fragment),this.h()},l(s){e=M(s,"DIV",{class:!0});var _=P(e);A(n.$$.fragment,_),_.forEach(p),this.h()},h(){k(e,"class","timeline-wrapper svelte-uu53fr")},m(s,_){L(s,e,_),U(n,e,null),o=!0},p(s,_){const h={};_&4&&(h.videoElement=s[2]),!t&&_&16384&&(t=!0,h.dragStart=s[14],te(()=>t=!1)),!i&&_&32768&&(i=!0,h.dragEnd=s[15],te(()=>i=!1)),!r&&_&4096&&(r=!0,h.trimmedDuration=s[12],te(()=>r=!1)),!a&&_&65536&&(a=!0,h.loadingTimeline=s[16],te(()=>a=!1)),n.$set(h)},i(s){o||(T(n.$$.fragment,s),o=!0)},o(s){V(n.$$.fragment,s),o=!1},d(s){s&&p(e),H(n)}}}function yt(l){let e;return{c(){e=j("div"),this.h()},l(n){e=M(n,"DIV",{class:!0}),P(e).forEach(p),this.h()},h(){k(e,"class","svelte-uu53fr")},m(n,t){L(n,e,t)},p:le,d(n){n&&p(e)}}}function Vt(l){let e,n=fe(l[12])+"",t,i,r,a,o="Trim",m,g,f="Cancel",w,d;return{c(){e=j("time"),t=we(n),i=z(),r=j("div"),a=j("button"),a.textContent=o,m=z(),g=j("button"),g.textContent=f,this.h()},l(s){e=M(s,"TIME",{"aria-label":!0,class:!0});var _=P(e);t=ke(_,n),_.forEach(p),i=F(s),r=M(s,"DIV",{class:!0});var h=P(r);a=M(h,"BUTTON",{class:!0,"data-svelte-h":!0}),Se(a)!=="svelte-18nzick"&&(a.textContent=o),m=F(h),g=M(h,"BUTTON",{class:!0,"data-svelte-h":!0}),Se(g)!=="svelte-1mj98i4"&&(g.textContent=f),h.forEach(p),this.h()},h(){k(e,"aria-label","duration of selected region in seconds"),k(e,"class","svelte-uu53fr"),Z(e,"hidden",l[16]),k(a,"class","text-button svelte-uu53fr"),Z(a,"hidden",l[16]),k(g,"class","text-button svelte-uu53fr"),Z(g,"hidden",l[16]),k(r,"class","edit-buttons svelte-uu53fr")},m(s,_){L(s,e,_),I(e,t),L(s,i,_),L(s,r,_),I(r,a),I(r,m),I(r,g),w||(d=[J(a,"click",l[22]),J(g,"click",l[17])],w=!0)},p(s,_){_&4096&&n!==(n=fe(s[12])+"")&&je(t,n),_&65536&&Z(e,"hidden",s[16]),_&65536&&Z(a,"hidden",s[16]),_&65536&&Z(g,"hidden",s[16])},d(s){s&&(p(e),p(i),p(r)),w=!1,Me(d)}}}function Xe(l){let e,n;return e=new Re({props:{Icon:Qe,label:"Reset video to initial value",disabled:l[1]||!l[11]}}),e.$on("click",l[23]),{c(){N(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,i){U(e,t,i),n=!0},p(t,i){const r={};i&2050&&(r.disabled=t[1]||!t[11]),e.$set(r)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){V(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function qe(l){let e,n;return e=new Re({props:{Icon:ft,label:"Trim video to selection",disabled:l[1]}}),e.$on("click",l[17]),{c(){N(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,i){U(e,t,i),n=!0},p(t,i){const r={};i&2&&(r.disabled=t[1]),e.$set(r)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){V(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function Dt(l){let e,n,t,i=l[3]&&l[0]===""&&Xe(l),r=l[4]&&l[0]===""&&qe(l);return{c(){i&&i.c(),e=z(),r&&r.c(),n=se()},l(a){i&&i.l(a),e=F(a),r&&r.l(a),n=se()},m(a,o){i&&i.m(a,o),L(a,e,o),r&&r.m(a,o),L(a,n,o),t=!0},p(a,o){a[3]&&a[0]===""?i?(i.p(a,o),o&9&&T(i,1)):(i=Xe(a),i.c(),T(i,1),i.m(e.parentNode,e)):i&&(ie(),V(i,1,1,()=>{i=null}),ae()),a[4]&&a[0]===""?r?(r.p(a,o),o&17&&T(r,1)):(r=qe(a),r.c(),T(r,1),r.m(n.parentNode,n)):r&&(ie(),V(r,1,1,()=>{r=null}),ae())},i(a){t||(T(i),T(r),t=!0)},o(a){V(i),V(r),t=!1},d(a){a&&(p(e),p(n)),i&&i.d(a),r&&r.d(a)}}}function It(l){var w;let e,n,t,i,r,a,o=l[0]==="edit"&&Oe(l);function m(d,s){return d[0]==="edit"&&d[12]!==null?Vt:yt}let g=m(l),f=g(l);return r=new gt({props:{i18n:l[7],download:l[9]?(w=l[8])==null?void 0:w.url:null,$$slots:{default:[Dt]},$$scope:{ctx:l}}}),r.$on("clear",l[24]),{c(){e=j("div"),o&&o.c(),n=z(),t=j("div"),f.c(),i=z(),N(r.$$.fragment),this.h()},l(d){e=M(d,"DIV",{class:!0});var s=P(e);o&&o.l(s),n=F(s),t=M(s,"DIV",{class:!0,"data-testid":!0});var _=P(t);f.l(_),_.forEach(p),s.forEach(p),i=F(d),A(r.$$.fragment,d),this.h()},h(){k(t,"class","controls svelte-uu53fr"),k(t,"data-testid","waveform-controls"),k(e,"class","container svelte-uu53fr"),Z(e,"hidden",l[0]!=="edit")},m(d,s){L(d,e,s),o&&o.m(e,null),I(e,n),I(e,t),f.m(t,null),L(d,i,s),U(r,d,s),a=!0},p(d,[s]){var h;d[0]==="edit"?o?(o.p(d,s),s&1&&T(o,1)):(o=Oe(d),o.c(),T(o,1),o.m(e,n)):o&&(ie(),V(o,1,1,()=>{o=null}),ae()),g===(g=m(d))&&f?f.p(d,s):(f.d(1),f=g(d),f&&(f.c(),f.m(t,null))),(!a||s&1)&&Z(e,"hidden",d[0]!=="edit");const _={};s&128&&(_.i18n=d[7]),s&768&&(_.download=d[9]?(h=d[8])==null?void 0:h.url:null),s&33556539&&(_.$$scope={dirty:s,ctx:d}),r.$set(_)},i(d){a||(T(o),T(r.$$.fragment,d),a=!0)},o(d){V(o),V(r.$$.fragment,d),a=!1},d(d){d&&(p(e),p(i)),o&&o.d(),f.d(),H(r,d)}}}function St(l,e,n){let{videoElement:t}=e,{showRedo:i=!1}=e,{interactive:r=!0}=e,{mode:a=""}=e,{handle_reset_value:o}=e,{handle_trim_video:m}=e,{processingVideo:g=!1}=e,{i18n:f}=e,{value:w=null}=e,{show_download_button:d=!1}=e,{handle_clear:s=()=>{}}=e,{has_change_history:_=!1}=e,h;Ie(async()=>{n(13,h=await ct())});let D=null,O=0,G=0,X=!1;const K=()=>{a==="edit"?(n(0,a=""),n(12,D=t.duration)):n(0,a="edit")};function W(E){O=E,n(14,O)}function v(E){G=E,n(15,G)}function R(E){D=E,n(12,D),n(0,a),n(2,t)}function c(E){X=E,n(16,X)}const S=()=>{n(0,a=""),n(1,g=!0),mt(h,O,G,t).then(E=>{m(E)}).then(()=>{n(1,g=!1)})},B=()=>{o(),n(0,a="")},Q=()=>s();return l.$$set=E=>{"videoElement"in E&&n(2,t=E.videoElement),"showRedo"in E&&n(3,i=E.showRedo),"interactive"in E&&n(4,r=E.interactive),"mode"in E&&n(0,a=E.mode),"handle_reset_value"in E&&n(5,o=E.handle_reset_value),"handle_trim_video"in E&&n(6,m=E.handle_trim_video),"processingVideo"in E&&n(1,g=E.processingVideo),"i18n"in E&&n(7,f=E.i18n),"value"in E&&n(8,w=E.value),"show_download_button"in E&&n(9,d=E.show_download_button),"handle_clear"in E&&n(10,s=E.handle_clear),"has_change_history"in E&&n(11,_=E.has_change_history)},l.$$.update=()=>{l.$$.dirty&4101&&a==="edit"&&D===null&&t&&n(12,D=t.duration)},[a,g,t,i,r,o,m,f,w,d,s,_,D,h,O,G,X,K,W,v,R,c,S,B,Q]}class jt extends ce{constructor(e){super(),me(this,e,St,It,de,{videoElement:2,showRedo:3,interactive:4,mode:0,handle_reset_value:5,handle_trim_video:6,processingVideo:1,i18n:7,value:8,show_download_button:9,handle_clear:10,has_change_history:11})}}function Mt(l){let e,n;return{c(){e=j("track"),this.h()},l(t){e=M(t,"TRACK",{kind:!0,src:!0}),this.h()},h(){k(e,"kind","captions"),Ee(e.src,n=l[1])||k(e,"src",n),e.default=!0},m(t,i){L(t,e,i)},p(t,i){i[0]&2&&!Ee(e.src,n=t[1])&&k(e,"src",n)},d(t){t&&p(e)}}}function Rt(l){let e,n;return e=new dt({}),{c(){N(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,i){U(e,t,i),n=!0},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){V(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function Lt(l){let e,n;return e=new _t({}),{c(){N(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,i){U(e,t,i),n=!0},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){V(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function Pt(l){let e,n;return e=new Qe({}),{c(){N(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,i){U(e,t,i),n=!0},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){V(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function ze(l){let e,n,t;function i(a){l[35](a)}let r={videoElement:l[17],showRedo:!0,handle_trim_video:l[23],handle_reset_value:l[7],value:l[11],i18n:l[9],show_download_button:l[10],handle_clear:l[12],has_change_history:l[13]};return l[18]!==void 0&&(r.processingVideo=l[18]),e=new jt({props:r}),ee.push(()=>ne(e,"processingVideo",i)),{c(){N(e.$$.fragment)},l(a){A(e.$$.fragment,a)},m(a,o){U(e,a,o),t=!0},p(a,o){const m={};o[0]&131072&&(m.videoElement=a[17]),o[0]&128&&(m.handle_reset_value=a[7]),o[0]&2048&&(m.value=a[11]),o[0]&512&&(m.i18n=a[9]),o[0]&1024&&(m.show_download_button=a[10]),o[0]&4096&&(m.handle_clear=a[12]),o[0]&8192&&(m.has_change_history=a[13]),!n&&o[0]&262144&&(n=!0,m.processingVideo=a[18],te(()=>n=!1)),e.$set(m)},i(a){t||(T(e.$$.fragment,a),t=!0)},o(a){V(e.$$.fragment,a),t=!1},d(a){H(e,a)}}}function Ct(l){let e,n,t,i,r,a,o,m,g,f,w,d,s,_,h,D=fe(l[14])+"",O,G,X=fe(l[15])+"",K,W,v,R,c,S,B,Q,E,q,_e,he;function pe(b){l[28](b)}function Te(b){l[29](b)}function ye(b){l[30](b)}function Ve(b){l[31](b)}let ue={src:l[0],preload:"auto",autoplay:l[3],loop:l[4],is_stream:l[8],"data-testid":`${l[5]}-player`,processingVideo:l[18],$$slots:{default:[Mt]},$$scope:{ctx:l}};l[14]!==void 0&&(ue.currentTime=l[14]),l[15]!==void 0&&(ue.duration=l[15]),l[16]!==void 0&&(ue.paused=l[16]),l[17]!==void 0&&(ue.node=l[17]),t=new ht({props:ue}),ee.push(()=>ne(t,"currentTime",pe)),ee.push(()=>ne(t,"duration",Te)),ee.push(()=>ne(t,"paused",ye)),ee.push(()=>ne(t,"node",Ve)),t.$on("click",l[20]),t.$on("play",l[32]),t.$on("pause",l[33]),t.$on("ended",l[22]),t.$on("load",l[34]);const ge=[Pt,Lt,Rt],x=[];function be(b,y){return b[14]===b[15]?0:b[16]?1:2}d=be(l),s=x[d]=ge[d](l),B=new vt({});let u=l[6]&&ze(l);return{c(){e=j("div"),n=j("div"),N(t.$$.fragment),m=z(),g=j("div"),f=j("div"),w=j("span"),s.c(),_=z(),h=j("span"),O=we(D),G=we(" / "),K=we(X),W=z(),v=j("progress"),c=z(),S=j("div"),N(B.$$.fragment),Q=z(),u&&u.c(),E=se(),this.h()},l(b){e=M(b,"DIV",{class:!0});var y=P(e);n=M(y,"DIV",{class:!0});var C=P(n);A(t.$$.fragment,C),C.forEach(p),m=F(y),g=M(y,"DIV",{class:!0});var $=P(g);f=M($,"DIV",{class:!0});var re=P(f);w=M(re,"SPAN",{role:!0,tabindex:!0,class:!0,"aria-label":!0});var Le=P(w);s.l(Le),Le.forEach(p),_=F(re),h=M(re,"SPAN",{class:!0});var ve=P(h);O=ke(ve,D),G=ke(ve," / "),K=ke(ve,X),ve.forEach(p),W=F(re),v=M(re,"PROGRESS",{class:!0}),P(v).forEach(p),c=F(re),S=M(re,"DIV",{role:!0,tabindex:!0,class:!0,"aria-label":!0});var Pe=P(S);A(B.$$.fragment,Pe),Pe.forEach(p),re.forEach(p),$.forEach(p),y.forEach(p),Q=F(b),u&&u.l(b),E=se(),this.h()},h(){k(n,"class","mirror-wrap svelte-1laj904"),Z(n,"mirror",l[2]),k(w,"role","button"),k(w,"tabindex","0"),k(w,"class","icon svelte-1laj904"),k(w,"aria-label","play-pause-replay-button"),k(h,"class","time svelte-1laj904"),v.value=R=l[14]/l[15]||0,k(v,"class","svelte-1laj904"),k(S,"role","button"),k(S,"tabindex","0"),k(S,"class","icon svelte-1laj904"),k(S,"aria-label","full-screen"),k(f,"class","inner svelte-1laj904"),k(g,"class","controls svelte-1laj904"),k(e,"class","wrap svelte-1laj904")},m(b,y){L(b,e,y),I(e,n),U(t,n,null),I(e,m),I(e,g),I(g,f),I(f,w),x[d].m(w,null),I(f,_),I(f,h),I(h,O),I(h,G),I(h,K),I(f,W),I(f,v),I(f,c),I(f,S),U(B,S,null),L(b,Q,y),u&&u.m(b,y),L(b,E,y),q=!0,_e||(he=[J(w,"click",l[20]),J(w,"keydown",l[20]),J(v,"mousemove",l[19]),J(v,"touchmove",Ne(l[19])),J(v,"click",Ze(Ne(l[21]))),J(S,"click",l[24]),J(S,"keypress",l[24])],_e=!0)},p(b,y){const C={};y[0]&1&&(C.src=b[0]),y[0]&8&&(C.autoplay=b[3]),y[0]&16&&(C.loop=b[4]),y[0]&256&&(C.is_stream=b[8]),y[0]&32&&(C["data-testid"]=`${b[5]}-player`),y[0]&262144&&(C.processingVideo=b[18]),y[0]&2|y[1]&64&&(C.$$scope={dirty:y,ctx:b}),!i&&y[0]&16384&&(i=!0,C.currentTime=b[14],te(()=>i=!1)),!r&&y[0]&32768&&(r=!0,C.duration=b[15],te(()=>r=!1)),!a&&y[0]&65536&&(a=!0,C.paused=b[16],te(()=>a=!1)),!o&&y[0]&131072&&(o=!0,C.node=b[17],te(()=>o=!1)),t.$set(C),(!q||y[0]&4)&&Z(n,"mirror",b[2]);let $=d;d=be(b),d!==$&&(ie(),V(x[$],1,1,()=>{x[$]=null}),ae(),s=x[d],s||(s=x[d]=ge[d](b),s.c()),T(s,1),s.m(w,null)),(!q||y[0]&16384)&&D!==(D=fe(b[14])+"")&&je(O,D),(!q||y[0]&32768)&&X!==(X=fe(b[15])+"")&&je(K,X),(!q||y[0]&49152&&R!==(R=b[14]/b[15]||0))&&(v.value=R),b[6]?u?(u.p(b,y),y[0]&64&&T(u,1)):(u=ze(b),u.c(),T(u,1),u.m(E.parentNode,E)):u&&(ie(),V(u,1,1,()=>{u=null}),ae())},i(b){q||(T(t.$$.fragment,b),T(s),T(B.$$.fragment,b),T(u),q=!0)},o(b){V(t.$$.fragment,b),V(s),V(B.$$.fragment,b),V(u),q=!1},d(b){b&&(p(e),p(Q),p(E)),H(t),x[d].d(),H(B),u&&u.d(b),_e=!1,Me(he)}}}function Bt(l,e,n){let{root:t=""}=e,{src:i}=e,{subtitle:r=null}=e,{mirror:a}=e,{autoplay:o}=e,{loop:m}=e,{label:g="test"}=e,{interactive:f=!1}=e,{handle_change:w=()=>{}}=e,{handle_reset_value:d=()=>{}}=e,{upload:s}=e,{is_stream:_}=e,{i18n:h}=e,{show_download_button:D=!1}=e,{value:O=null}=e,{handle_clear:G=()=>{}}=e,{has_change_history:X=!1}=e;const K=Je();let W=0,v,R=!0,c,S=!1;function B(u){if(!v)return;if(u.type==="click"){E(u);return}if(u.type!=="touchmove"&&!(u.buttons&1))return;const b=u.type==="touchmove"?u.touches[0].clientX:u.clientX,{left:y,right:C}=u.currentTarget.getBoundingClientRect();n(14,W=v*(b-y)/(C-y))}async function Q(){document.fullscreenElement!=c&&(c.currentTime>0&&!c.paused&&!c.ended&&c.readyState>c.HAVE_CURRENT_DATA?c.pause():await c.play())}function E(u){const{left:b,right:y}=u.currentTarget.getBoundingClientRect();n(14,W=v*(u.clientX-b)/(y-b))}function q(){K("stop"),K("end")}const _e=async u=>{var $;let b=new File([u],"video.mp4");const y=await nt([b]);let C=($=await s(y,t))==null?void 0:$.filter(Boolean)[0];w(C)};function he(){c.requestFullscreen()}function pe(u){W=u,n(14,W)}function Te(u){v=u,n(15,v)}function ye(u){R=u,n(16,R)}function Ve(u){c=u,n(17,c)}function ue(u){Y.call(this,l,u)}function ge(u){Y.call(this,l,u)}function x(u){Y.call(this,l,u)}function be(u){S=u,n(18,S)}return l.$$set=u=>{"root"in u&&n(25,t=u.root),"src"in u&&n(0,i=u.src),"subtitle"in u&&n(1,r=u.subtitle),"mirror"in u&&n(2,a=u.mirror),"autoplay"in u&&n(3,o=u.autoplay),"loop"in u&&n(4,m=u.loop),"label"in u&&n(5,g=u.label),"interactive"in u&&n(6,f=u.interactive),"handle_change"in u&&n(26,w=u.handle_change),"handle_reset_value"in u&&n(7,d=u.handle_reset_value),"upload"in u&&n(27,s=u.upload),"is_stream"in u&&n(8,_=u.is_stream),"i18n"in u&&n(9,h=u.i18n),"show_download_button"in u&&n(10,D=u.show_download_button),"value"in u&&n(11,O=u.value),"handle_clear"in u&&n(12,G=u.handle_clear),"has_change_history"in u&&n(13,X=u.has_change_history)},[i,r,a,o,m,g,f,d,_,h,D,O,G,X,W,v,R,c,S,B,Q,E,q,_e,he,t,w,s,pe,Te,ye,Ve,ue,ge,x,be]}class Nt extends ce{constructor(e){super(),me(this,e,Bt,Ct,de,{root:25,src:0,subtitle:1,mirror:2,autoplay:3,loop:4,label:5,interactive:6,handle_change:26,handle_reset_value:7,upload:27,is_stream:8,i18n:9,show_download_button:10,value:11,handle_clear:12,has_change_history:13},null,[-1,-1])}}const At=Nt;function Ut(l){let e=l[0].url,n,t,i,r,a=Fe(l);return i=new st({props:{$$slots:{default:[Xt]},$$scope:{ctx:l}}}),{c(){a.c(),n=z(),t=j("div"),N(i.$$.fragment),this.h()},l(o){a.l(o),n=F(o),t=M(o,"DIV",{"data-testid":!0});var m=P(t);A(i.$$.fragment,m),m.forEach(p),this.h()},h(){k(t,"data-testid","download-div")},m(o,m){a.m(o,m),L(o,n,m),L(o,t,m),U(i,t,null),r=!0},p(o,m){m&1&&de(e,e=o[0].url)?(ie(),V(a,1,1,le),ae(),a=Fe(o),a.c(),T(a,1),a.m(n.parentNode,n)):a.p(o,m);const g={};m&2097505&&(g.$$scope={dirty:m,ctx:o}),i.$set(g)},i(o){r||(T(a),T(i.$$.fragment,o),r=!0)},o(o){V(a),V(i.$$.fragment,o),r=!1},d(o){o&&(p(n),p(t)),a.d(o),H(i)}}}function Ht(l){let e,n;return e=new at({props:{unpadded_box:!0,size:"large",$$slots:{default:[qt]},$$scope:{ctx:l}}}),{c(){N(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,i){U(e,t,i),n=!0},p(t,i){const r={};i&2097152&&(r.$$scope={dirty:i,ctx:t}),e.$set(r)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){V(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function Fe(l){var t;let e,n;return e=new At({props:{src:l[0].url,subtitle:(t=l[1])==null?void 0:t.url,is_stream:l[0].is_stream,autoplay:l[4],mirror:!1,label:l[2],loop:l[7],interactive:!1,upload:l[9],i18n:l[8]}}),e.$on("play",l[10]),e.$on("pause",l[11]),e.$on("stop",l[12]),e.$on("end",l[13]),e.$on("load",l[14]),{c(){N(e.$$.fragment)},l(i){A(e.$$.fragment,i)},m(i,r){U(e,i,r),n=!0},p(i,r){var o;const a={};r&1&&(a.src=i[0].url),r&2&&(a.subtitle=(o=i[1])==null?void 0:o.url),r&1&&(a.is_stream=i[0].is_stream),r&16&&(a.autoplay=i[4]),r&4&&(a.label=i[2]),r&128&&(a.loop=i[7]),r&512&&(a.upload=i[9]),r&256&&(a.i18n=i[8]),e.$set(a)},i(i){n||(T(e.$$.fragment,i),n=!0)},o(i){V(e.$$.fragment,i),n=!1},d(i){H(e,i)}}}function Ge(l){var t;let e,n;return e=new ut({props:{href:l[0].is_stream?(t=l[0].url)==null?void 0:t.replace("playlist.m3u8","playlist-file"):l[0].url,download:l[0].orig_name||l[0].path,$$slots:{default:[Ot]},$$scope:{ctx:l}}}),{c(){N(e.$$.fragment)},l(i){A(e.$$.fragment,i)},m(i,r){U(e,i,r),n=!0},p(i,r){var o;const a={};r&1&&(a.href=i[0].is_stream?(o=i[0].url)==null?void 0:o.replace("playlist.m3u8","playlist-file"):i[0].url),r&1&&(a.download=i[0].orig_name||i[0].path),r&2097152&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){n||(T(e.$$.fragment,i),n=!0)},o(i){V(e.$$.fragment,i),n=!1},d(i){H(e,i)}}}function Ot(l){let e,n;return e=new Re({props:{Icon:ot,label:"Download"}}),{c(){N(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,i){U(e,t,i),n=!0},p:le,i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){V(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function We(l){let e,n;return e=new rt({props:{i18n:l[8],value:l[0],formatter:l[15]}}),e.$on("error",l[16]),e.$on("share",l[17]),{c(){N(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,i){U(e,t,i),n=!0},p(t,i){const r={};i&256&&(r.i18n=t[8]),i&1&&(r.value=t[0]),e.$set(r)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){V(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function Xt(l){let e,n,t,i=l[6]&&Ge(l),r=l[5]&&We(l);return{c(){i&&i.c(),e=z(),r&&r.c(),n=se()},l(a){i&&i.l(a),e=F(a),r&&r.l(a),n=se()},m(a,o){i&&i.m(a,o),L(a,e,o),r&&r.m(a,o),L(a,n,o),t=!0},p(a,o){a[6]?i?(i.p(a,o),o&64&&T(i,1)):(i=Ge(a),i.c(),T(i,1),i.m(e.parentNode,e)):i&&(ie(),V(i,1,1,()=>{i=null}),ae()),a[5]?r?(r.p(a,o),o&32&&T(r,1)):(r=We(a),r.c(),T(r,1),r.m(n.parentNode,n)):r&&(ie(),V(r,1,1,()=>{r=null}),ae())},i(a){t||(T(i),T(r),t=!0)},o(a){V(i),V(r),t=!1},d(a){a&&(p(e),p(n)),i&&i.d(a),r&&r.d(a)}}}function qt(l){let e,n;return e=new Ke({}),{c(){N(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,i){U(e,t,i),n=!0},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){V(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function zt(l){let e,n,t,i,r,a;e=new it({props:{show_label:l[3],Icon:Ke,label:l[2]||"Video"}});const o=[Ht,Ut],m=[];function g(f,w){return!f[0]||f[0].url===void 0?0:1}return t=g(l),i=m[t]=o[t](l),{c(){N(e.$$.fragment),n=z(),i.c(),r=se()},l(f){A(e.$$.fragment,f),n=F(f),i.l(f),r=se()},m(f,w){U(e,f,w),L(f,n,w),m[t].m(f,w),L(f,r,w),a=!0},p(f,[w]){const d={};w&8&&(d.show_label=f[3]),w&4&&(d.label=f[2]||"Video"),e.$set(d);let s=t;t=g(f),t===s?m[t].p(f,w):(ie(),V(m[s],1,1,()=>{m[s]=null}),ae(),i=m[t],i?i.p(f,w):(i=m[t]=o[t](f),i.c()),T(i,1),i.m(r.parentNode,r))},i(f){a||(T(e.$$.fragment,f),T(i),a=!0)},o(f){V(e.$$.fragment,f),V(i),a=!1},d(f){f&&(p(n),p(r)),H(e,f),m[t].d(f)}}}function Ft(l,e,n){let{value:t=null}=e,{subtitle:i=null}=e,{label:r=void 0}=e,{show_label:a=!0}=e,{autoplay:o}=e,{show_share_button:m=!0}=e,{show_download_button:g=!0}=e,{loop:f}=e,{i18n:w}=e,{upload:d}=e,s=null,_=null;const h=Je();xe(async()=>{t!==s&&i!==_&&_!==null&&(s=t,n(0,t=null),await $e(),n(0,t=s)),s=t,_=i});function D(c){Y.call(this,l,c)}function O(c){Y.call(this,l,c)}function G(c){Y.call(this,l,c)}function X(c){Y.call(this,l,c)}function K(c){Y.call(this,l,c)}const W=async c=>c?await lt(c.data):"";function v(c){Y.call(this,l,c)}function R(c){Y.call(this,l,c)}return l.$$set=c=>{"value"in c&&n(0,t=c.value),"subtitle"in c&&n(1,i=c.subtitle),"label"in c&&n(2,r=c.label),"show_label"in c&&n(3,a=c.show_label),"autoplay"in c&&n(4,o=c.autoplay),"show_share_button"in c&&n(5,m=c.show_share_button),"show_download_button"in c&&n(6,g=c.show_download_button),"loop"in c&&n(7,f=c.loop),"i18n"in c&&n(8,w=c.i18n),"upload"in c&&n(9,d=c.upload)},l.$$.update=()=>{l.$$.dirty&1&&t&&h("change",t)},[t,i,r,a,o,m,g,f,w,d,D,O,G,X,K,W,v,R]}class Gt extends ce{constructor(e){super(),me(this,e,Ft,zt,de,{value:0,subtitle:1,label:2,show_label:3,autoplay:4,show_share_button:5,show_download_button:6,loop:7,i18n:8,upload:9})}}const un=Object.freeze(Object.defineProperty({__proto__:null,default:Gt},Symbol.toStringTag,{value:"Module"}));export{At as P,Gt as V,un as a};
