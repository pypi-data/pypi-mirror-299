{% extends "generic/object.html" %}
{% load buttons %}
{% load custom_links %}
{% load helpers %}
{% load perms %}
{% load plugins %}
{% load tabs %}
{% load i18n %}

{% block breadcrumbs %}
    {% include 'sop_phone/tools/breadcrumbs.html' with object=object name=object|meta:"verbose_name" %}
{% endblock %}


{% block control-buttons %}
  {% if perms.extras.add_bookmark and object.bookmarks %}
    {% bookmark_button object %}
  {% endif %}
  {% if perms.extras.add_subscription and object.subscriptions %}
    {% subscribe_button object %}
  {% endif %}
  {% if request.user|can_change:object %}
    {% edit_button object %}
  {% endif %}
  {% if request.user|can_delete:object %}
    {% delete_button object %}
  {% endif %}
{% endblock control-buttons %}


{% block title %}{{object.site.name}} Phone {{object|meta:"verbose_name"|bettertitle}}{% endblock %}


{% block content %}
<div class="row">
  <div class="col col-md-6">
    <div class="card">

      <h5 class="card-header">{{object|meta:"verbose_name"|bettertitle}}</h5>
      <table class="table table-hover attr-table">

        <tr>
          <th scope="row">{% trans "Maintainer" %}</th>
          <td>
            {{object.maintainer|linkify}}
          </td>
        </tr>

        <tr>
          <th scope="row">{% trans "Maintainer status" %}</th>
          <td>
            {% badge object.maintainer.get_status_display bg_color=object.maintainer.get_status_color %}
          </td>
        </tr>

        <tr>
          <th scope="row">{% trans "DID range maintained" %}</th>
            <td>
              {{num_range}} {% trans "ranges "%}({{num_did}} {% trans "numbers" %})
            </td>
        </tr>

      </table>
    </div>
  </div>

  <div class="col-md-6">
    {% if object.site %}
      {% include 'sop_phone/tools/site.html' with object=object maintainer=maintainer.maintainer %}
    {% endif %}
  </div>

  {% if object.maintainer %}
  <div class="col col-md-12">
    <div class="card">

      <h2 class="card-header">
        <a href="{% url object.maintainer|viewname:"detail" pk=object.maintainer.pk %}/contacts/">Contacts</a>
        <div class="card-actions">
          <a href="{% url 'tenancy:contactassignment_add' %}?object_type={{ object.maintainer|content_type_id }}&object_id={{ object.maintainer.pk }}" class="btn btn-ghost-primary btn-sm">
            <i class="mdi mdi-plus-thick" aria-hidden="true"></i> {% trans "Add a contact" %}
          </a>
        </div>
      </h2>
    
      <div class="htmx-container table-responsive"
        hx-get="{% url "plugins:sop_phone:phonemaintainer_contacts" pk=object.maintainer.pk %}"
        hx-target="this"
        hx-trigger="load" hx-select=".htmx-container" hx-swap="outerHTML"
      ></div>

    </div>
  </div>
  {% endif %}


</div>
{% endblock content %}
