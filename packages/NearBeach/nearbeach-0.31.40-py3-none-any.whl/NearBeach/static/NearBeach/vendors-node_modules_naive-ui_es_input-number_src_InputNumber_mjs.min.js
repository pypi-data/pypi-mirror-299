"use strict";
(self["webpackChunknearbeach"] = self["webpackChunknearbeach"] || []).push([["vendors-node_modules_naive-ui_es_input-number_src_InputNumber_mjs"],{

/***/ "./node_modules/naive-ui/es/_internal/icons/Add.mjs":
/*!**********************************************************!*\
  !*** ./node_modules/naive-ui/es/_internal/icons/Add.mjs ***!
  \**********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var vue__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! vue */ "./node_modules/vue/dist/vue.runtime.esm-bundler.js");

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,vue__WEBPACK_IMPORTED_MODULE_0__.defineComponent)({
  name: 'Add',
  render() {
    return (0,vue__WEBPACK_IMPORTED_MODULE_0__.h)("svg", {
      width: "512",
      height: "512",
      viewBox: "0 0 512 512",
      fill: "none",
      xmlns: "http://www.w3.org/2000/svg"
    }, (0,vue__WEBPACK_IMPORTED_MODULE_0__.h)("path", {
      d: "M256 112V400M400 256H112",
      stroke: "currentColor",
      "stroke-width": "32",
      "stroke-linecap": "round",
      "stroke-linejoin": "round"
    }));
  }
}));

/***/ }),

/***/ "./node_modules/naive-ui/es/_internal/icons/Remove.mjs":
/*!*************************************************************!*\
  !*** ./node_modules/naive-ui/es/_internal/icons/Remove.mjs ***!
  \*************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var vue__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! vue */ "./node_modules/vue/dist/vue.runtime.esm-bundler.js");

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,vue__WEBPACK_IMPORTED_MODULE_0__.defineComponent)({
  name: 'Remove',
  render() {
    return (0,vue__WEBPACK_IMPORTED_MODULE_0__.h)("svg", {
      xmlns: "http://www.w3.org/2000/svg",
      viewBox: "0 0 512 512"
    }, (0,vue__WEBPACK_IMPORTED_MODULE_0__.h)("line", {
      x1: "400",
      y1: "256",
      x2: "112",
      y2: "256",
      style: "\n        fill: none;\n        stroke: currentColor;\n        stroke-linecap: round;\n        stroke-linejoin: round;\n        stroke-width: 32px;\n      "
    }));
  }
}));

/***/ }),

/***/ "./node_modules/naive-ui/es/input-number/src/InputNumber.mjs":
/*!*******************************************************************!*\
  !*** ./node_modules/naive-ui/es/input-number/src/InputNumber.mjs ***!
  \*******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__),
/* harmony export */   inputNumberProps: () => (/* binding */ inputNumberProps)
/* harmony export */ });
/* harmony import */ var vue__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! vue */ "./node_modules/vue/dist/vue.runtime.esm-bundler.js");
/* harmony import */ var seemly__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! seemly */ "./node_modules/seemly/es/color/index.js");
/* harmony import */ var vooks__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! vooks */ "./node_modules/vooks/es/use-merged-state.js");
/* harmony import */ var vooks__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! vooks */ "./node_modules/vooks/es/use-memo.js");
/* harmony import */ var evtd__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! evtd */ "./node_modules/evtd/es/delegate.js");
/* harmony import */ var _internal_icons_index_mjs__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../_internal/icons/index.mjs */ "./node_modules/naive-ui/es/_internal/icons/Remove.mjs");
/* harmony import */ var _internal_icons_index_mjs__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../_internal/icons/index.mjs */ "./node_modules/naive-ui/es/_internal/icons/Add.mjs");
/* harmony import */ var _input_index_mjs__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../input/index.mjs */ "./node_modules/naive-ui/es/input/src/Input.mjs");
/* harmony import */ var _internal_index_mjs__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../_internal/index.mjs */ "./node_modules/naive-ui/es/_internal/icon/src/Icon.mjs");
/* harmony import */ var _button_index_mjs__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../button/index.mjs */ "./node_modules/naive-ui/es/button/src/Button.mjs");
/* harmony import */ var _mixins_index_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../_mixins/index.mjs */ "./node_modules/naive-ui/es/_mixins/use-theme.mjs");
/* harmony import */ var _mixins_index_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../_mixins/index.mjs */ "./node_modules/naive-ui/es/_mixins/use-config.mjs");
/* harmony import */ var _mixins_index_mjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../_mixins/index.mjs */ "./node_modules/naive-ui/es/_mixins/use-locale.mjs");
/* harmony import */ var _mixins_index_mjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../_mixins/index.mjs */ "./node_modules/naive-ui/es/_mixins/use-form-item.mjs");
/* harmony import */ var _utils_index_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../_utils/index.mjs */ "./node_modules/naive-ui/es/_utils/naive/warn.mjs");
/* harmony import */ var _utils_index_mjs__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../_utils/index.mjs */ "./node_modules/naive-ui/es/_utils/vue/call.mjs");
/* harmony import */ var _utils_index_mjs__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../_utils/index.mjs */ "./node_modules/naive-ui/es/_utils/vue/resolve-slot.mjs");
/* harmony import */ var _styles_index_mjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../styles/index.mjs */ "./node_modules/naive-ui/es/input-number/styles/light.mjs");
/* harmony import */ var _utils_mjs__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./utils.mjs */ "./node_modules/naive-ui/es/input-number/src/utils.mjs");
/* harmony import */ var _styles_input_number_cssr_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./styles/input-number.cssr.mjs */ "./node_modules/naive-ui/es/input-number/src/styles/input-number.cssr.mjs");
/* harmony import */ var _mixins_use_rtl_mjs__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../_mixins/use-rtl.mjs */ "./node_modules/naive-ui/es/_mixins/use-rtl.mjs");














const HOLDING_CHANGE_THRESHOLD = 800;
const HOLDING_CHANGE_INTERVAL = 100;
const inputNumberProps = Object.assign(Object.assign({}, _mixins_index_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].props), {
  autofocus: Boolean,
  loading: {
    type: Boolean,
    default: undefined
  },
  placeholder: String,
  defaultValue: {
    type: Number,
    default: null
  },
  value: Number,
  step: {
    type: [Number, String],
    default: 1
  },
  min: [Number, String],
  max: [Number, String],
  size: String,
  disabled: {
    type: Boolean,
    default: undefined
  },
  validator: Function,
  bordered: {
    type: Boolean,
    default: undefined
  },
  showButton: {
    type: Boolean,
    default: true
  },
  buttonPlacement: {
    type: String,
    default: 'right'
  },
  inputProps: Object,
  readonly: Boolean,
  clearable: Boolean,
  keyboard: {
    type: Object,
    default: {}
  },
  updateValueOnInput: {
    type: Boolean,
    default: true
  },
  parse: Function,
  format: Function,
  precision: Number,
  status: String,
  'onUpdate:value': [Function, Array],
  onUpdateValue: [Function, Array],
  onFocus: [Function, Array],
  onBlur: [Function, Array],
  onClear: [Function, Array],
  // deprecated
  onChange: [Function, Array]
});
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,vue__WEBPACK_IMPORTED_MODULE_0__.defineComponent)({
  name: 'InputNumber',
  props: inputNumberProps,
  setup(props) {
    if (true) {
      (0,vue__WEBPACK_IMPORTED_MODULE_0__.watchEffect)(() => {
        if (props.onChange !== undefined) {
          (0,_utils_index_mjs__WEBPACK_IMPORTED_MODULE_2__.warnOnce)('input-number', '`on-change` is deprecated, please use `on-update:value` instead');
        }
      });
    }
    const {
      mergedBorderedRef,
      mergedClsPrefixRef,
      mergedRtlRef
    } = (0,_mixins_index_mjs__WEBPACK_IMPORTED_MODULE_3__["default"])(props);
    const themeRef = (0,_mixins_index_mjs__WEBPACK_IMPORTED_MODULE_1__["default"])('InputNumber', '-input-number', _styles_input_number_cssr_mjs__WEBPACK_IMPORTED_MODULE_4__["default"], _styles_index_mjs__WEBPACK_IMPORTED_MODULE_5__["default"], props, mergedClsPrefixRef);
    const {
      localeRef
    } = (0,_mixins_index_mjs__WEBPACK_IMPORTED_MODULE_6__["default"])('InputNumber');
    const formItem = (0,_mixins_index_mjs__WEBPACK_IMPORTED_MODULE_7__["default"])(props);
    const {
      mergedSizeRef,
      mergedDisabledRef,
      mergedStatusRef
    } = formItem;
    // dom ref
    const inputInstRef = (0,vue__WEBPACK_IMPORTED_MODULE_0__.ref)(null);
    const minusButtonInstRef = (0,vue__WEBPACK_IMPORTED_MODULE_0__.ref)(null);
    const addButtonInstRef = (0,vue__WEBPACK_IMPORTED_MODULE_0__.ref)(null);
    // value
    const uncontrolledValueRef = (0,vue__WEBPACK_IMPORTED_MODULE_0__.ref)(props.defaultValue);
    const controlledValueRef = (0,vue__WEBPACK_IMPORTED_MODULE_0__.toRef)(props, 'value');
    const mergedValueRef = (0,vooks__WEBPACK_IMPORTED_MODULE_8__["default"])(controlledValueRef, uncontrolledValueRef);
    const displayedValueRef = (0,vue__WEBPACK_IMPORTED_MODULE_0__.ref)('');
    const getPrecision = value => {
      const fraction = String(value).split('.')[1];
      return fraction ? fraction.length : 0;
    };
    const getMaxPrecision = currentValue => {
      const precisions = [props.min, props.max, props.step, currentValue].map(value => {
        if (value === undefined) return 0;
        return getPrecision(value);
      });
      return Math.max(...precisions);
    };
    const mergedPlaceholderRef = (0,vooks__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
      const {
        placeholder
      } = props;
      if (placeholder !== undefined) return placeholder;
      return localeRef.value.placeholder;
    });
    const mergedStepRef = (0,vooks__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
      const parsedNumber = (0,_utils_mjs__WEBPACK_IMPORTED_MODULE_10__.parseNumber)(props.step);
      if (parsedNumber !== null) {
        return parsedNumber === 0 ? 1 : Math.abs(parsedNumber);
      }
      return 1;
    });
    const mergedMinRef = (0,vooks__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
      const parsedNumber = (0,_utils_mjs__WEBPACK_IMPORTED_MODULE_10__.parseNumber)(props.min);
      if (parsedNumber !== null) return parsedNumber;else return null;
    });
    const mergedMaxRef = (0,vooks__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
      const parsedNumber = (0,_utils_mjs__WEBPACK_IMPORTED_MODULE_10__.parseNumber)(props.max);
      if (parsedNumber !== null) return parsedNumber;else return null;
    });
    const doUpdateValue = value => {
      const {
        value: mergedValue
      } = mergedValueRef;
      if (value === mergedValue) {
        deriveDisplayedValueFromValue();
        return;
      }
      const {
        'onUpdate:value': _onUpdateValue,
        onUpdateValue,
        onChange
      } = props;
      const {
        nTriggerFormInput,
        nTriggerFormChange
      } = formItem;
      if (onChange) (0,_utils_index_mjs__WEBPACK_IMPORTED_MODULE_11__.call)(onChange, value);
      if (onUpdateValue) (0,_utils_index_mjs__WEBPACK_IMPORTED_MODULE_11__.call)(onUpdateValue, value);
      if (_onUpdateValue) (0,_utils_index_mjs__WEBPACK_IMPORTED_MODULE_11__.call)(_onUpdateValue, value);
      uncontrolledValueRef.value = value;
      nTriggerFormInput();
      nTriggerFormChange();
    };
    const deriveValueFromDisplayedValue = ({
      offset,
      doUpdateIfValid,
      fixPrecision,
      isInputing
    }) => {
      const {
        value: displayedValue
      } = displayedValueRef;
      if (isInputing && (0,_utils_mjs__WEBPACK_IMPORTED_MODULE_10__.isWipValue)(displayedValue)) {
        return false;
      }
      const parsedValue = (props.parse || _utils_mjs__WEBPACK_IMPORTED_MODULE_10__.parse)(displayedValue);
      if (parsedValue === null) {
        if (doUpdateIfValid) doUpdateValue(null);
        return null;
      }
      if ((0,_utils_mjs__WEBPACK_IMPORTED_MODULE_10__.validator)(parsedValue)) {
        const currentPrecision = getPrecision(parsedValue);
        const {
          precision
        } = props;
        if (precision !== undefined && precision < currentPrecision && !fixPrecision) {
          return false;
        }
        let nextValue = parseFloat((parsedValue + offset).toFixed(precision !== null && precision !== void 0 ? precision : getMaxPrecision(parsedValue)));
        if ((0,_utils_mjs__WEBPACK_IMPORTED_MODULE_10__.validator)(nextValue)) {
          const {
            value: mergedMax
          } = mergedMaxRef;
          const {
            value: mergedMin
          } = mergedMinRef;
          if (mergedMax !== null && nextValue > mergedMax) {
            if (!doUpdateIfValid || isInputing) return false;
            // if doUpdateIfValid=true, we try to make it a valid value
            nextValue = mergedMax;
          }
          if (mergedMin !== null && nextValue < mergedMin) {
            if (!doUpdateIfValid || isInputing) return false;
            // if doUpdateIfValid=true, we try to make it a valid value
            nextValue = mergedMin;
          }
          if (props.validator && !props.validator(nextValue)) return false;
          if (doUpdateIfValid) doUpdateValue(nextValue);
          return nextValue;
        }
      }
      return false;
    };
    const deriveDisplayedValueFromValue = () => {
      const {
        value: mergedValue
      } = mergedValueRef;
      if ((0,_utils_mjs__WEBPACK_IMPORTED_MODULE_10__.validator)(mergedValue)) {
        const {
          format: formatProp,
          precision
        } = props;
        if (formatProp) {
          displayedValueRef.value = formatProp(mergedValue);
        } else {
          if (mergedValue === null || precision === undefined ||
          // precision overflow
          getPrecision(mergedValue) > precision) {
            displayedValueRef.value = (0,_utils_mjs__WEBPACK_IMPORTED_MODULE_10__.format)(mergedValue, undefined);
          } else {
            displayedValueRef.value = (0,_utils_mjs__WEBPACK_IMPORTED_MODULE_10__.format)(mergedValue, precision);
          }
        }
      } else {
        // null can pass the validator check
        // so mergedValue is a number
        displayedValueRef.value = String(mergedValue);
      }
    };
    deriveDisplayedValueFromValue();
    const displayedValueInvalidRef = (0,vooks__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
      const derivedValue = deriveValueFromDisplayedValue({
        offset: 0,
        doUpdateIfValid: false,
        isInputing: false,
        fixPrecision: false
      });
      return derivedValue === false;
    });
    const minusableRef = (0,vooks__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
      const {
        value: mergedValue
      } = mergedValueRef;
      if (props.validator && mergedValue === null) {
        return false;
      }
      const {
        value: mergedStep
      } = mergedStepRef;
      const derivedNextValue = deriveValueFromDisplayedValue({
        offset: -mergedStep,
        doUpdateIfValid: false,
        isInputing: false,
        fixPrecision: false
      });
      return derivedNextValue !== false;
    });
    const addableRef = (0,vooks__WEBPACK_IMPORTED_MODULE_9__["default"])(() => {
      const {
        value: mergedValue
      } = mergedValueRef;
      if (props.validator && mergedValue === null) {
        return false;
      }
      const {
        value: mergedStep
      } = mergedStepRef;
      const derivedNextValue = deriveValueFromDisplayedValue({
        offset: +mergedStep,
        doUpdateIfValid: false,
        isInputing: false,
        fixPrecision: false
      });
      return derivedNextValue !== false;
    });
    function doFocus(e) {
      const {
        onFocus
      } = props;
      const {
        nTriggerFormFocus
      } = formItem;
      if (onFocus) (0,_utils_index_mjs__WEBPACK_IMPORTED_MODULE_11__.call)(onFocus, e);
      nTriggerFormFocus();
    }
    function doBlur(e) {
      var _a, _b;
      if (e.target === ((_a = inputInstRef.value) === null || _a === void 0 ? void 0 : _a.wrapperElRef)) {
        // hit input wrapper
        // which means not activated
        return;
      }
      const value = deriveValueFromDisplayedValue({
        offset: 0,
        doUpdateIfValid: true,
        isInputing: false,
        fixPrecision: true
      });
      // If valid, update event has been emitted
      // make sure e.target.value is correct in blur callback
      if (value !== false) {
        const inputElRef = (_b = inputInstRef.value) === null || _b === void 0 ? void 0 : _b.inputElRef;
        if (inputElRef) {
          inputElRef.value = String(value || '');
        }
        // If value is not changed, the displayed value may be greater than or
        // less than the current value. The derived value is reformatted so the
        // value is not changed. We can simply derive a new displayed value
        if (mergedValueRef.value === value) {
          deriveDisplayedValueFromValue();
        }
      } else {
        // If not valid, nothing will be emitted, so derive displayed value from
        // origin value
        deriveDisplayedValueFromValue();
      }
      const {
        onBlur
      } = props;
      const {
        nTriggerFormBlur
      } = formItem;
      if (onBlur) (0,_utils_index_mjs__WEBPACK_IMPORTED_MODULE_11__.call)(onBlur, e);
      nTriggerFormBlur();
      // User may change value in blur callback, we make sure it will be
      // displayed. Sometimes mergedValue won't be viewed as changed
      void (0,vue__WEBPACK_IMPORTED_MODULE_0__.nextTick)(() => {
        deriveDisplayedValueFromValue();
      });
    }
    function doClear(e) {
      const {
        onClear
      } = props;
      if (onClear) (0,_utils_index_mjs__WEBPACK_IMPORTED_MODULE_11__.call)(onClear, e);
    }
    function doAdd() {
      const {
        value: addable
      } = addableRef;
      if (!addable) {
        clearAddHoldTimeout();
        return;
      }
      const {
        value: mergedValue
      } = mergedValueRef;
      if (mergedValue === null) {
        if (!props.validator) {
          doUpdateValue(createValidValue());
        }
      } else {
        const {
          value: mergedStep
        } = mergedStepRef;
        deriveValueFromDisplayedValue({
          offset: mergedStep,
          doUpdateIfValid: true,
          isInputing: false,
          fixPrecision: true
        });
      }
    }
    function doMinus() {
      const {
        value: minusable
      } = minusableRef;
      if (!minusable) {
        clearMinusHoldTimeout();
        return;
      }
      const {
        value: mergedValue
      } = mergedValueRef;
      if (mergedValue === null) {
        if (!props.validator) {
          doUpdateValue(createValidValue());
        }
      } else {
        const {
          value: mergedStep
        } = mergedStepRef;
        deriveValueFromDisplayedValue({
          offset: -mergedStep,
          doUpdateIfValid: true,
          isInputing: false,
          fixPrecision: true
        });
      }
    }
    const handleFocus = doFocus;
    const handleBlur = doBlur;
    function createValidValue() {
      if (props.validator) return null;
      const {
        value: mergedMin
      } = mergedMinRef;
      const {
        value: mergedMax
      } = mergedMaxRef;
      if (mergedMin !== null) {
        return Math.max(0, mergedMin);
      } else if (mergedMax !== null) {
        return Math.min(0, mergedMax);
      } else {
        return 0;
      }
    }
    function handleClear(e) {
      doClear(e);
      doUpdateValue(null);
    }
    function handleMouseDown(e) {
      var _a, _b, _c;
      if ((_a = addButtonInstRef.value) === null || _a === void 0 ? void 0 : _a.$el.contains(e.target)) {
        e.preventDefault();
      }
      if ((_b = minusButtonInstRef.value) === null || _b === void 0 ? void 0 : _b.$el.contains(e.target)) {
        e.preventDefault();
      }
      (_c = inputInstRef.value) === null || _c === void 0 ? void 0 : _c.activate();
    }
    let minusHoldStateIntervalId = null;
    let addHoldStateIntervalId = null;
    let firstMinusMousedownId = null;
    function clearMinusHoldTimeout() {
      if (firstMinusMousedownId) {
        window.clearTimeout(firstMinusMousedownId);
        firstMinusMousedownId = null;
      }
      if (minusHoldStateIntervalId) {
        window.clearInterval(minusHoldStateIntervalId);
        minusHoldStateIntervalId = null;
      }
    }
    function clearAddHoldTimeout() {
      if (firstAddMousedownId) {
        window.clearTimeout(firstAddMousedownId);
        firstAddMousedownId = null;
      }
      if (addHoldStateIntervalId) {
        window.clearInterval(addHoldStateIntervalId);
        addHoldStateIntervalId = null;
      }
    }
    function handleMinusMousedown() {
      clearMinusHoldTimeout();
      firstMinusMousedownId = window.setTimeout(() => {
        minusHoldStateIntervalId = window.setInterval(() => {
          doMinus();
        }, HOLDING_CHANGE_INTERVAL);
      }, HOLDING_CHANGE_THRESHOLD);
      (0,evtd__WEBPACK_IMPORTED_MODULE_12__.on)('mouseup', document, clearMinusHoldTimeout, {
        once: true
      });
    }
    let firstAddMousedownId = null;
    function handleAddMousedown() {
      clearAddHoldTimeout();
      firstAddMousedownId = window.setTimeout(() => {
        addHoldStateIntervalId = window.setInterval(() => {
          doAdd();
        }, HOLDING_CHANGE_INTERVAL);
      }, HOLDING_CHANGE_THRESHOLD);
      (0,evtd__WEBPACK_IMPORTED_MODULE_12__.on)('mouseup', document, clearAddHoldTimeout, {
        once: true
      });
    }
    const handleAddClick = () => {
      if (addHoldStateIntervalId) return;
      doAdd();
    };
    const handleMinusClick = () => {
      if (minusHoldStateIntervalId) return;
      doMinus();
    };
    function handleKeyDown(e) {
      var _a, _b;
      if (e.key === 'Enter') {
        if (e.target === ((_a = inputInstRef.value) === null || _a === void 0 ? void 0 : _a.wrapperElRef)) {
          // hit input wrapper
          // which means not activated
          return;
        }
        const value = deriveValueFromDisplayedValue({
          offset: 0,
          doUpdateIfValid: true,
          isInputing: false,
          fixPrecision: true
        });
        if (value !== false) {
          (_b = inputInstRef.value) === null || _b === void 0 ? void 0 : _b.deactivate();
        }
      } else if (e.key === 'ArrowUp') {
        if (!addableRef.value) return;
        if (props.keyboard.ArrowUp === false) return;
        e.preventDefault();
        const value = deriveValueFromDisplayedValue({
          offset: 0,
          doUpdateIfValid: true,
          isInputing: false,
          fixPrecision: true
        });
        if (value !== false) {
          doAdd();
        }
      } else if (e.key === 'ArrowDown') {
        if (!minusableRef.value) return;
        if (props.keyboard.ArrowDown === false) return;
        e.preventDefault();
        const value = deriveValueFromDisplayedValue({
          offset: 0,
          doUpdateIfValid: true,
          isInputing: false,
          fixPrecision: true
        });
        if (value !== false) {
          doMinus();
        }
      }
    }
    function handleUpdateDisplayedValue(value) {
      displayedValueRef.value = value;
      if (props.updateValueOnInput && !props.format && !props.parse && props.precision === undefined) {
        deriveValueFromDisplayedValue({
          offset: 0,
          doUpdateIfValid: true,
          isInputing: true,
          fixPrecision: false
        });
      }
    }
    (0,vue__WEBPACK_IMPORTED_MODULE_0__.watch)(mergedValueRef, () => {
      deriveDisplayedValueFromValue();
    });
    const exposedMethods = {
      focus: () => {
        var _a;
        return (_a = inputInstRef.value) === null || _a === void 0 ? void 0 : _a.focus();
      },
      blur: () => {
        var _a;
        return (_a = inputInstRef.value) === null || _a === void 0 ? void 0 : _a.blur();
      },
      select: () => {
        var _a;
        return (_a = inputInstRef.value) === null || _a === void 0 ? void 0 : _a.select();
      }
    };
    const rtlEnabledRef = (0,_mixins_use_rtl_mjs__WEBPACK_IMPORTED_MODULE_13__.useRtl)('InputNumber', mergedRtlRef, mergedClsPrefixRef);
    return Object.assign(Object.assign({}, exposedMethods), {
      rtlEnabled: rtlEnabledRef,
      inputInstRef,
      minusButtonInstRef,
      addButtonInstRef,
      mergedClsPrefix: mergedClsPrefixRef,
      mergedBordered: mergedBorderedRef,
      uncontrolledValue: uncontrolledValueRef,
      mergedValue: mergedValueRef,
      mergedPlaceholder: mergedPlaceholderRef,
      displayedValueInvalid: displayedValueInvalidRef,
      mergedSize: mergedSizeRef,
      mergedDisabled: mergedDisabledRef,
      displayedValue: displayedValueRef,
      addable: addableRef,
      minusable: minusableRef,
      mergedStatus: mergedStatusRef,
      handleFocus,
      handleBlur,
      handleClear,
      handleMouseDown,
      handleAddClick,
      handleMinusClick,
      handleAddMousedown,
      handleMinusMousedown,
      handleKeyDown,
      handleUpdateDisplayedValue,
      // theme
      mergedTheme: themeRef,
      inputThemeOverrides: {
        paddingSmall: '0 8px 0 10px',
        paddingMedium: '0 8px 0 12px',
        paddingLarge: '0 8px 0 14px'
      },
      buttonThemeOverrides: (0,vue__WEBPACK_IMPORTED_MODULE_0__.computed)(() => {
        const {
          self: {
            iconColorDisabled
          }
        } = themeRef.value;
        const [r, g, b, a] = (0,seemly__WEBPACK_IMPORTED_MODULE_14__.rgba)(iconColorDisabled);
        return {
          textColorTextDisabled: `rgb(${r}, ${g}, ${b})`,
          opacityDisabled: `${a}`
        };
      })
    });
  },
  render() {
    const {
      mergedClsPrefix,
      $slots
    } = this;
    const renderMinusButton = () => {
      return (0,vue__WEBPACK_IMPORTED_MODULE_0__.h)(_button_index_mjs__WEBPACK_IMPORTED_MODULE_15__.XButton, {
        text: true,
        disabled: !this.minusable || this.mergedDisabled || this.readonly,
        focusable: false,
        theme: this.mergedTheme.peers.Button,
        themeOverrides: this.mergedTheme.peerOverrides.Button,
        builtinThemeOverrides: this.buttonThemeOverrides,
        onClick: this.handleMinusClick,
        onMousedown: this.handleMinusMousedown,
        ref: "minusButtonInstRef"
      }, {
        icon: () => (0,_utils_index_mjs__WEBPACK_IMPORTED_MODULE_16__.resolveSlot)($slots['minus-icon'], () => [(0,vue__WEBPACK_IMPORTED_MODULE_0__.h)(_internal_index_mjs__WEBPACK_IMPORTED_MODULE_17__["default"], {
          clsPrefix: mergedClsPrefix
        }, {
          default: () => (0,vue__WEBPACK_IMPORTED_MODULE_0__.h)(_internal_icons_index_mjs__WEBPACK_IMPORTED_MODULE_18__["default"], null)
        })])
      });
    };
    const renderAddButton = () => {
      return (0,vue__WEBPACK_IMPORTED_MODULE_0__.h)(_button_index_mjs__WEBPACK_IMPORTED_MODULE_15__.XButton, {
        text: true,
        disabled: !this.addable || this.mergedDisabled || this.readonly,
        focusable: false,
        theme: this.mergedTheme.peers.Button,
        themeOverrides: this.mergedTheme.peerOverrides.Button,
        builtinThemeOverrides: this.buttonThemeOverrides,
        onClick: this.handleAddClick,
        onMousedown: this.handleAddMousedown,
        ref: "addButtonInstRef"
      }, {
        icon: () => (0,_utils_index_mjs__WEBPACK_IMPORTED_MODULE_16__.resolveSlot)($slots['add-icon'], () => [(0,vue__WEBPACK_IMPORTED_MODULE_0__.h)(_internal_index_mjs__WEBPACK_IMPORTED_MODULE_17__["default"], {
          clsPrefix: mergedClsPrefix
        }, {
          default: () => (0,vue__WEBPACK_IMPORTED_MODULE_0__.h)(_internal_icons_index_mjs__WEBPACK_IMPORTED_MODULE_19__["default"], null)
        })])
      });
    };
    return (0,vue__WEBPACK_IMPORTED_MODULE_0__.h)("div", {
      class: [`${mergedClsPrefix}-input-number`, this.rtlEnabled && `${mergedClsPrefix}-input-number--rtl`]
    }, (0,vue__WEBPACK_IMPORTED_MODULE_0__.h)(_input_index_mjs__WEBPACK_IMPORTED_MODULE_20__["default"], {
      ref: "inputInstRef",
      autofocus: this.autofocus,
      status: this.mergedStatus,
      bordered: this.mergedBordered,
      loading: this.loading,
      value: this.displayedValue,
      onUpdateValue: this.handleUpdateDisplayedValue,
      theme: this.mergedTheme.peers.Input,
      themeOverrides: this.mergedTheme.peerOverrides.Input,
      builtinThemeOverrides: this.inputThemeOverrides,
      size: this.mergedSize,
      placeholder: this.mergedPlaceholder,
      disabled: this.mergedDisabled,
      readonly: this.readonly,
      textDecoration: this.displayedValueInvalid ? 'line-through' : undefined,
      onFocus: this.handleFocus,
      onBlur: this.handleBlur,
      onKeydown: this.handleKeyDown,
      onMousedown: this.handleMouseDown,
      onClear: this.handleClear,
      clearable: this.clearable,
      inputProps: this.inputProps,
      internalLoadingBeforeSuffix: true
    }, {
      prefix: () => {
        var _a;
        return this.showButton && this.buttonPlacement === 'both' ? [renderMinusButton(), (0,_utils_index_mjs__WEBPACK_IMPORTED_MODULE_16__.resolveWrappedSlot)($slots.prefix, children => {
          if (children) {
            return (0,vue__WEBPACK_IMPORTED_MODULE_0__.h)("span", {
              class: `${mergedClsPrefix}-input-number-prefix`
            }, children);
          }
          return null;
        })] : (_a = $slots.prefix) === null || _a === void 0 ? void 0 : _a.call($slots);
      },
      suffix: () => {
        var _a;
        return this.showButton ? [(0,_utils_index_mjs__WEBPACK_IMPORTED_MODULE_16__.resolveWrappedSlot)($slots.suffix, children => {
          if (children) {
            return (0,vue__WEBPACK_IMPORTED_MODULE_0__.h)("span", {
              class: `${mergedClsPrefix}-input-number-suffix`
            }, children);
          }
          return null;
        }), this.buttonPlacement === 'right' ? renderMinusButton() : null, renderAddButton()] : (_a = $slots.suffix) === null || _a === void 0 ? void 0 : _a.call($slots);
      }
    }));
  }
}));

/***/ }),

/***/ "./node_modules/naive-ui/es/input-number/src/styles/input-number.cssr.mjs":
/*!********************************************************************************!*\
  !*** ./node_modules/naive-ui/es/input-number/src/styles/input-number.cssr.mjs ***!
  \********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _utils_cssr_index_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../_utils/cssr/index.mjs */ "./node_modules/naive-ui/es/_utils/cssr/index.mjs");

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_utils_cssr_index_mjs__WEBPACK_IMPORTED_MODULE_0__.c)([(0,_utils_cssr_index_mjs__WEBPACK_IMPORTED_MODULE_0__.cB)('input-number-suffix', `
 display: inline-block;
 margin-right: 10px;
 `), (0,_utils_cssr_index_mjs__WEBPACK_IMPORTED_MODULE_0__.cB)('input-number-prefix', `
 display: inline-block;
 margin-left: 10px;
 `)]));

/***/ }),

/***/ "./node_modules/naive-ui/es/input-number/src/utils.mjs":
/*!*************************************************************!*\
  !*** ./node_modules/naive-ui/es/input-number/src/utils.mjs ***!
  \*************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   format: () => (/* binding */ format),
/* harmony export */   isWipValue: () => (/* binding */ isWipValue),
/* harmony export */   parse: () => (/* binding */ parse),
/* harmony export */   parseNumber: () => (/* binding */ parseNumber),
/* harmony export */   validator: () => (/* binding */ validator)
/* harmony export */ });
// string => string (expected, not implemented)
// string => number (legacy)
function parse(value) {
  if (value === undefined || value === null || typeof value === 'string' && value.trim() === '') {
    return null;
  }
  return Number(value);
}
// can be parsed to number but shouldn't be applied when inputing
// when value includes `.`, ending with 0 and`.`, doesn't update, if 0 parse func will remove 0
function isWipValue(value) {
  return value.includes('.') && (/^(-)?\d+.*(\.|0)$/.test(value) || /^\.\d+$/.test(value));
}
// string => boolean (expected, not implemented)
// number => boolean (legacy)
function validator(value) {
  if (value === undefined || value === null) return true;
  if (Number.isNaN(value)) return false;
  return true;
}
// string => string (expected, not implemented)
// number => string (legacy)
function format(value, precision) {
  if (value === undefined || value === null) return '';
  return precision === undefined ? String(value) : value.toFixed(precision);
}
function parseNumber(number) {
  if (number === null) return null;
  if (typeof number === 'number') {
    return number;
  } else {
    const parsedNumber = Number(number);
    if (Number.isNaN(parsedNumber)) return null;else {
      return parsedNumber;
    }
  }
}

/***/ }),

/***/ "./node_modules/naive-ui/es/input-number/styles/light.mjs":
/*!****************************************************************!*\
  !*** ./node_modules/naive-ui/es/input-number/styles/light.mjs ***!
  \****************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _button_styles_index_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../button/styles/index.mjs */ "./node_modules/naive-ui/es/button/styles/light.mjs");
/* harmony import */ var _input_styles_index_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../input/styles/index.mjs */ "./node_modules/naive-ui/es/input/styles/light.mjs");
/* harmony import */ var _styles_common_index_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../_styles/common/index.mjs */ "./node_modules/naive-ui/es/_styles/common/light.mjs");
/* harmony import */ var _mixins_index_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../_mixins/index.mjs */ "./node_modules/naive-ui/es/_mixins/use-theme.mjs");




const self = vars => {
  const {
    textColorDisabled
  } = vars;
  return {
    iconColorDisabled: textColorDisabled
  };
};
const inputNumberLight = (0,_mixins_index_mjs__WEBPACK_IMPORTED_MODULE_0__.createTheme)({
  name: 'InputNumber',
  common: _styles_common_index_mjs__WEBPACK_IMPORTED_MODULE_1__["default"],
  peers: {
    Button: _button_styles_index_mjs__WEBPACK_IMPORTED_MODULE_2__["default"],
    Input: _input_styles_index_mjs__WEBPACK_IMPORTED_MODULE_3__["default"]
  },
  self
});
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (inputNumberLight);

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVuZG9ycy1ub2RlX21vZHVsZXNfbmFpdmUtdWlfZXNfaW5wdXQtbnVtYmVyX3NyY19JbnB1dE51bWJlcl9tanMubWluLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQXlDO0FBQ3pDLGlFQUFlLG9EQUFlO0FBQzlCO0FBQ0E7QUFDQSxXQUFXLHNDQUFDO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssRUFBRSxzQ0FBQztBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDLENBQUM7Ozs7Ozs7Ozs7Ozs7OztBQ2xCdUM7QUFDekMsaUVBQWUsb0RBQWU7QUFDOUI7QUFDQTtBQUNBLFdBQVcsc0NBQUM7QUFDWjtBQUNBO0FBQ0EsS0FBSyxFQUFFLHNDQUFDO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsK0JBQStCLGdDQUFnQyxpQ0FBaUMsNkJBQTZCO0FBQ2hLLEtBQUs7QUFDTDtBQUNBLENBQUMsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDZjJGO0FBQy9EO0FBQ2tCO0FBQ3RCO0FBQzRDO0FBQ3ZCO0FBQ087QUFDSjtBQUNvQztBQUNHO0FBQ2xDO0FBQ3lCO0FBQzdCO0FBQ0E7QUFDbkQ7QUFDQTtBQUNPLHVEQUF1RCxFQUFFLHlEQUFRO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxpRUFBZSxvREFBZTtBQUM5QjtBQUNBO0FBQ0E7QUFDQSxRQUFRLElBQXFDO0FBQzdDLE1BQU0sZ0RBQVc7QUFDakI7QUFDQSxVQUFVLDBEQUFRO0FBQ2xCO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNLEVBQUUsNkRBQVM7QUFDakIscUJBQXFCLDZEQUFRLGlDQUFpQyxxRUFBSyxFQUFFLHlEQUFnQjtBQUNyRjtBQUNBO0FBQ0EsTUFBTSxFQUFFLDZEQUFTO0FBQ2pCLHFCQUFxQiw2REFBVztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLHlCQUF5Qix3Q0FBRztBQUM1QiwrQkFBK0Isd0NBQUc7QUFDbEMsNkJBQTZCLHdDQUFHO0FBQ2hDO0FBQ0EsaUNBQWlDLHdDQUFHO0FBQ3BDLCtCQUErQiwwQ0FBSztBQUNwQywyQkFBMkIsaURBQWM7QUFDekMsOEJBQThCLHdDQUFHO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLGlDQUFpQyxpREFBTztBQUN4QztBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsMEJBQTBCLGlEQUFPO0FBQ2pDLDJCQUEyQix3REFBVztBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCx5QkFBeUIsaURBQU87QUFDaEMsMkJBQTJCLHdEQUFXO0FBQ3RDLHFEQUFxRDtBQUNyRCxLQUFLO0FBQ0wseUJBQXlCLGlEQUFPO0FBQ2hDLDJCQUEyQix3REFBVztBQUN0QyxxREFBcUQ7QUFDckQsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUixvQkFBb0IsdURBQUk7QUFDeEIseUJBQXlCLHVEQUFJO0FBQzdCLDBCQUEwQix1REFBSTtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFFBQVE7QUFDUix3QkFBd0IsdURBQVU7QUFDbEM7QUFDQTtBQUNBLDBDQUEwQyw4Q0FBSztBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsc0RBQVM7QUFDbkI7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxzREFBUztBQUNyQjtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUixVQUFVLHNEQUFTO0FBQ25CO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyxtREFBTTtBQUM1QyxZQUFZO0FBQ1osc0NBQXNDLG1EQUFNO0FBQzVDO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLGlEQUFPO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0wseUJBQXlCLGlEQUFPO0FBQ2hDO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMLHVCQUF1QixpREFBTztBQUM5QjtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBLFFBQVE7QUFDUixtQkFBbUIsdURBQUk7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBLFFBQVE7QUFDUixrQkFBa0IsdURBQUk7QUFDdEI7QUFDQTtBQUNBO0FBQ0EsV0FBVyw2Q0FBUTtBQUNuQjtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUixtQkFBbUIsdURBQUk7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87QUFDUCxNQUFNLHlDQUFFO0FBQ1I7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQLE1BQU0seUNBQUU7QUFDUjtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsSUFBSSwwQ0FBSztBQUNUO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLDREQUFNO0FBQ2hDLHlDQUF5QztBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLDRCQUE0Qiw2Q0FBUTtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDViw2QkFBNkIsNkNBQUk7QUFDakM7QUFDQSx3Q0FBd0MsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFO0FBQ3RELDhCQUE4QixFQUFFO0FBQ2hDO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxhQUFhLHNDQUFDLENBQUMsdURBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLG9CQUFvQiw4REFBVyw4QkFBOEIsc0NBQUMsQ0FBQyw0REFBUztBQUN4RTtBQUNBLFNBQVM7QUFDVCx5QkFBeUIsc0NBQUMsQ0FBQyxrRUFBVTtBQUNyQyxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0E7QUFDQSxhQUFhLHNDQUFDLENBQUMsdURBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLG9CQUFvQiw4REFBVyw0QkFBNEIsc0NBQUMsQ0FBQyw0REFBUztBQUN0RTtBQUNBLFNBQVM7QUFDVCx5QkFBeUIsc0NBQUMsQ0FBQyxrRUFBTztBQUNsQyxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0EsV0FBVyxzQ0FBQztBQUNaLGlCQUFpQixnQkFBZ0Isc0NBQXNDLGdCQUFnQjtBQUN2RixLQUFLLEVBQUUsc0NBQUMsQ0FBQyx5REFBTTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLDBGQUEwRixxRUFBa0I7QUFDNUc7QUFDQSxtQkFBbUIsc0NBQUM7QUFDcEIsd0JBQXdCLGdCQUFnQjtBQUN4QyxhQUFhO0FBQ2I7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQTtBQUNBLGtDQUFrQyxxRUFBa0I7QUFDcEQ7QUFDQSxtQkFBbUIsc0NBQUM7QUFDcEIsd0JBQXdCLGdCQUFnQjtBQUN4QyxhQUFhO0FBQ2I7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUMsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7O0FDbHNCcUQ7QUFDdkQsaUVBQWUsd0RBQUMsRUFBRSx5REFBRTtBQUNwQjtBQUNBO0FBQ0EsS0FBSyx5REFBRTtBQUNQO0FBQ0E7QUFDQSxLQUFLOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNQTDtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSxnREFBZ0Q7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3BDNEQ7QUFDRjtBQUNHO0FBQ1A7QUFDdEQ7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLDhEQUFXO0FBQ3BDO0FBQ0EsVUFBVSxnRUFBVztBQUNyQjtBQUNBLFlBQVksZ0VBQVc7QUFDdkIsV0FBVywrREFBVTtBQUNyQixHQUFHO0FBQ0g7QUFDQSxDQUFDO0FBQ0QsaUVBQWUsZ0JBQWdCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmVhcmJlYWNoLy4vbm9kZV9tb2R1bGVzL25haXZlLXVpL2VzL19pbnRlcm5hbC9pY29ucy9BZGQubWpzIiwid2VicGFjazovL25lYXJiZWFjaC8uL25vZGVfbW9kdWxlcy9uYWl2ZS11aS9lcy9faW50ZXJuYWwvaWNvbnMvUmVtb3ZlLm1qcyIsIndlYnBhY2s6Ly9uZWFyYmVhY2gvLi9ub2RlX21vZHVsZXMvbmFpdmUtdWkvZXMvaW5wdXQtbnVtYmVyL3NyYy9JbnB1dE51bWJlci5tanMiLCJ3ZWJwYWNrOi8vbmVhcmJlYWNoLy4vbm9kZV9tb2R1bGVzL25haXZlLXVpL2VzL2lucHV0LW51bWJlci9zcmMvc3R5bGVzL2lucHV0LW51bWJlci5jc3NyLm1qcyIsIndlYnBhY2s6Ly9uZWFyYmVhY2gvLi9ub2RlX21vZHVsZXMvbmFpdmUtdWkvZXMvaW5wdXQtbnVtYmVyL3NyYy91dGlscy5tanMiLCJ3ZWJwYWNrOi8vbmVhcmJlYWNoLy4vbm9kZV9tb2R1bGVzL25haXZlLXVpL2VzL2lucHV0LW51bWJlci9zdHlsZXMvbGlnaHQubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGgsIGRlZmluZUNvbXBvbmVudCB9IGZyb20gJ3Z1ZSc7XG5leHBvcnQgZGVmYXVsdCBkZWZpbmVDb21wb25lbnQoe1xuICBuYW1lOiAnQWRkJyxcbiAgcmVuZGVyKCkge1xuICAgIHJldHVybiBoKFwic3ZnXCIsIHtcbiAgICAgIHdpZHRoOiBcIjUxMlwiLFxuICAgICAgaGVpZ2h0OiBcIjUxMlwiLFxuICAgICAgdmlld0JveDogXCIwIDAgNTEyIDUxMlwiLFxuICAgICAgZmlsbDogXCJub25lXCIsXG4gICAgICB4bWxuczogXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiXG4gICAgfSwgaChcInBhdGhcIiwge1xuICAgICAgZDogXCJNMjU2IDExMlY0MDBNNDAwIDI1NkgxMTJcIixcbiAgICAgIHN0cm9rZTogXCJjdXJyZW50Q29sb3JcIixcbiAgICAgIFwic3Ryb2tlLXdpZHRoXCI6IFwiMzJcIixcbiAgICAgIFwic3Ryb2tlLWxpbmVjYXBcIjogXCJyb3VuZFwiLFxuICAgICAgXCJzdHJva2UtbGluZWpvaW5cIjogXCJyb3VuZFwiXG4gICAgfSkpO1xuICB9XG59KTsiLCJpbXBvcnQgeyBoLCBkZWZpbmVDb21wb25lbnQgfSBmcm9tICd2dWUnO1xuZXhwb3J0IGRlZmF1bHQgZGVmaW5lQ29tcG9uZW50KHtcbiAgbmFtZTogJ1JlbW92ZScsXG4gIHJlbmRlcigpIHtcbiAgICByZXR1cm4gaChcInN2Z1wiLCB7XG4gICAgICB4bWxuczogXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiLFxuICAgICAgdmlld0JveDogXCIwIDAgNTEyIDUxMlwiXG4gICAgfSwgaChcImxpbmVcIiwge1xuICAgICAgeDE6IFwiNDAwXCIsXG4gICAgICB5MTogXCIyNTZcIixcbiAgICAgIHgyOiBcIjExMlwiLFxuICAgICAgeTI6IFwiMjU2XCIsXG4gICAgICBzdHlsZTogXCJcXG4gICAgICAgIGZpbGw6IG5vbmU7XFxuICAgICAgICBzdHJva2U6IGN1cnJlbnRDb2xvcjtcXG4gICAgICAgIHN0cm9rZS1saW5lY2FwOiByb3VuZDtcXG4gICAgICAgIHN0cm9rZS1saW5lam9pbjogcm91bmQ7XFxuICAgICAgICBzdHJva2Utd2lkdGg6IDMycHg7XFxuICAgICAgXCJcbiAgICB9KSk7XG4gIH1cbn0pOyIsImltcG9ydCB7IGgsIGRlZmluZUNvbXBvbmVudCwgcmVmLCB0b1JlZiwgd2F0Y2gsIGNvbXB1dGVkLCB3YXRjaEVmZmVjdCwgbmV4dFRpY2sgfSBmcm9tICd2dWUnO1xuaW1wb3J0IHsgcmdiYSB9IGZyb20gJ3NlZW1seSc7XG5pbXBvcnQgeyB1c2VNZW1vLCB1c2VNZXJnZWRTdGF0ZSB9IGZyb20gJ3Zvb2tzJztcbmltcG9ydCB7IG9uIH0gZnJvbSAnZXZ0ZCc7XG5pbXBvcnQgeyBSZW1vdmVJY29uLCBBZGRJY29uIH0gZnJvbSBcIi4uLy4uL19pbnRlcm5hbC9pY29ucy9pbmRleC5tanNcIjtcbmltcG9ydCB7IE5JbnB1dCB9IGZyb20gXCIuLi8uLi9pbnB1dC9pbmRleC5tanNcIjtcbmltcG9ydCB7IE5CYXNlSWNvbiB9IGZyb20gXCIuLi8uLi9faW50ZXJuYWwvaW5kZXgubWpzXCI7XG5pbXBvcnQgeyBOeEJ1dHRvbiB9IGZyb20gXCIuLi8uLi9idXR0b24vaW5kZXgubWpzXCI7XG5pbXBvcnQgeyB1c2VUaGVtZSwgdXNlRm9ybUl0ZW0sIHVzZUxvY2FsZSwgdXNlQ29uZmlnIH0gZnJvbSBcIi4uLy4uL19taXhpbnMvaW5kZXgubWpzXCI7XG5pbXBvcnQgeyB3YXJuT25jZSwgY2FsbCwgcmVzb2x2ZVNsb3QsIHJlc29sdmVXcmFwcGVkU2xvdCB9IGZyb20gXCIuLi8uLi9fdXRpbHMvaW5kZXgubWpzXCI7XG5pbXBvcnQgeyBpbnB1dE51bWJlckxpZ2h0IH0gZnJvbSBcIi4uL3N0eWxlcy9pbmRleC5tanNcIjtcbmltcG9ydCB7IHBhcnNlLCB2YWxpZGF0b3IsIGZvcm1hdCwgcGFyc2VOdW1iZXIsIGlzV2lwVmFsdWUgfSBmcm9tIFwiLi91dGlscy5tanNcIjtcbmltcG9ydCBzdHlsZSBmcm9tIFwiLi9zdHlsZXMvaW5wdXQtbnVtYmVyLmNzc3IubWpzXCI7XG5pbXBvcnQgeyB1c2VSdGwgfSBmcm9tIFwiLi4vLi4vX21peGlucy91c2UtcnRsLm1qc1wiO1xuY29uc3QgSE9MRElOR19DSEFOR0VfVEhSRVNIT0xEID0gODAwO1xuY29uc3QgSE9MRElOR19DSEFOR0VfSU5URVJWQUwgPSAxMDA7XG5leHBvcnQgY29uc3QgaW5wdXROdW1iZXJQcm9wcyA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgdXNlVGhlbWUucHJvcHMpLCB7XG4gIGF1dG9mb2N1czogQm9vbGVhbixcbiAgbG9hZGluZzoge1xuICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgZGVmYXVsdDogdW5kZWZpbmVkXG4gIH0sXG4gIHBsYWNlaG9sZGVyOiBTdHJpbmcsXG4gIGRlZmF1bHRWYWx1ZToge1xuICAgIHR5cGU6IE51bWJlcixcbiAgICBkZWZhdWx0OiBudWxsXG4gIH0sXG4gIHZhbHVlOiBOdW1iZXIsXG4gIHN0ZXA6IHtcbiAgICB0eXBlOiBbTnVtYmVyLCBTdHJpbmddLFxuICAgIGRlZmF1bHQ6IDFcbiAgfSxcbiAgbWluOiBbTnVtYmVyLCBTdHJpbmddLFxuICBtYXg6IFtOdW1iZXIsIFN0cmluZ10sXG4gIHNpemU6IFN0cmluZyxcbiAgZGlzYWJsZWQ6IHtcbiAgICB0eXBlOiBCb29sZWFuLFxuICAgIGRlZmF1bHQ6IHVuZGVmaW5lZFxuICB9LFxuICB2YWxpZGF0b3I6IEZ1bmN0aW9uLFxuICBib3JkZXJlZDoge1xuICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgZGVmYXVsdDogdW5kZWZpbmVkXG4gIH0sXG4gIHNob3dCdXR0b246IHtcbiAgICB0eXBlOiBCb29sZWFuLFxuICAgIGRlZmF1bHQ6IHRydWVcbiAgfSxcbiAgYnV0dG9uUGxhY2VtZW50OiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGRlZmF1bHQ6ICdyaWdodCdcbiAgfSxcbiAgaW5wdXRQcm9wczogT2JqZWN0LFxuICByZWFkb25seTogQm9vbGVhbixcbiAgY2xlYXJhYmxlOiBCb29sZWFuLFxuICBrZXlib2FyZDoge1xuICAgIHR5cGU6IE9iamVjdCxcbiAgICBkZWZhdWx0OiB7fVxuICB9LFxuICB1cGRhdGVWYWx1ZU9uSW5wdXQ6IHtcbiAgICB0eXBlOiBCb29sZWFuLFxuICAgIGRlZmF1bHQ6IHRydWVcbiAgfSxcbiAgcGFyc2U6IEZ1bmN0aW9uLFxuICBmb3JtYXQ6IEZ1bmN0aW9uLFxuICBwcmVjaXNpb246IE51bWJlcixcbiAgc3RhdHVzOiBTdHJpbmcsXG4gICdvblVwZGF0ZTp2YWx1ZSc6IFtGdW5jdGlvbiwgQXJyYXldLFxuICBvblVwZGF0ZVZhbHVlOiBbRnVuY3Rpb24sIEFycmF5XSxcbiAgb25Gb2N1czogW0Z1bmN0aW9uLCBBcnJheV0sXG4gIG9uQmx1cjogW0Z1bmN0aW9uLCBBcnJheV0sXG4gIG9uQ2xlYXI6IFtGdW5jdGlvbiwgQXJyYXldLFxuICAvLyBkZXByZWNhdGVkXG4gIG9uQ2hhbmdlOiBbRnVuY3Rpb24sIEFycmF5XVxufSk7XG5leHBvcnQgZGVmYXVsdCBkZWZpbmVDb21wb25lbnQoe1xuICBuYW1lOiAnSW5wdXROdW1iZXInLFxuICBwcm9wczogaW5wdXROdW1iZXJQcm9wcyxcbiAgc2V0dXAocHJvcHMpIHtcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgd2F0Y2hFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAocHJvcHMub25DaGFuZ2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIHdhcm5PbmNlKCdpbnB1dC1udW1iZXInLCAnYG9uLWNoYW5nZWAgaXMgZGVwcmVjYXRlZCwgcGxlYXNlIHVzZSBgb24tdXBkYXRlOnZhbHVlYCBpbnN0ZWFkJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB7XG4gICAgICBtZXJnZWRCb3JkZXJlZFJlZixcbiAgICAgIG1lcmdlZENsc1ByZWZpeFJlZixcbiAgICAgIG1lcmdlZFJ0bFJlZlxuICAgIH0gPSB1c2VDb25maWcocHJvcHMpO1xuICAgIGNvbnN0IHRoZW1lUmVmID0gdXNlVGhlbWUoJ0lucHV0TnVtYmVyJywgJy1pbnB1dC1udW1iZXInLCBzdHlsZSwgaW5wdXROdW1iZXJMaWdodCwgcHJvcHMsIG1lcmdlZENsc1ByZWZpeFJlZik7XG4gICAgY29uc3Qge1xuICAgICAgbG9jYWxlUmVmXG4gICAgfSA9IHVzZUxvY2FsZSgnSW5wdXROdW1iZXInKTtcbiAgICBjb25zdCBmb3JtSXRlbSA9IHVzZUZvcm1JdGVtKHByb3BzKTtcbiAgICBjb25zdCB7XG4gICAgICBtZXJnZWRTaXplUmVmLFxuICAgICAgbWVyZ2VkRGlzYWJsZWRSZWYsXG4gICAgICBtZXJnZWRTdGF0dXNSZWZcbiAgICB9ID0gZm9ybUl0ZW07XG4gICAgLy8gZG9tIHJlZlxuICAgIGNvbnN0IGlucHV0SW5zdFJlZiA9IHJlZihudWxsKTtcbiAgICBjb25zdCBtaW51c0J1dHRvbkluc3RSZWYgPSByZWYobnVsbCk7XG4gICAgY29uc3QgYWRkQnV0dG9uSW5zdFJlZiA9IHJlZihudWxsKTtcbiAgICAvLyB2YWx1ZVxuICAgIGNvbnN0IHVuY29udHJvbGxlZFZhbHVlUmVmID0gcmVmKHByb3BzLmRlZmF1bHRWYWx1ZSk7XG4gICAgY29uc3QgY29udHJvbGxlZFZhbHVlUmVmID0gdG9SZWYocHJvcHMsICd2YWx1ZScpO1xuICAgIGNvbnN0IG1lcmdlZFZhbHVlUmVmID0gdXNlTWVyZ2VkU3RhdGUoY29udHJvbGxlZFZhbHVlUmVmLCB1bmNvbnRyb2xsZWRWYWx1ZVJlZik7XG4gICAgY29uc3QgZGlzcGxheWVkVmFsdWVSZWYgPSByZWYoJycpO1xuICAgIGNvbnN0IGdldFByZWNpc2lvbiA9IHZhbHVlID0+IHtcbiAgICAgIGNvbnN0IGZyYWN0aW9uID0gU3RyaW5nKHZhbHVlKS5zcGxpdCgnLicpWzFdO1xuICAgICAgcmV0dXJuIGZyYWN0aW9uID8gZnJhY3Rpb24ubGVuZ3RoIDogMDtcbiAgICB9O1xuICAgIGNvbnN0IGdldE1heFByZWNpc2lvbiA9IGN1cnJlbnRWYWx1ZSA9PiB7XG4gICAgICBjb25zdCBwcmVjaXNpb25zID0gW3Byb3BzLm1pbiwgcHJvcHMubWF4LCBwcm9wcy5zdGVwLCBjdXJyZW50VmFsdWVdLm1hcCh2YWx1ZSA9PiB7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSByZXR1cm4gMDtcbiAgICAgICAgcmV0dXJuIGdldFByZWNpc2lvbih2YWx1ZSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBNYXRoLm1heCguLi5wcmVjaXNpb25zKTtcbiAgICB9O1xuICAgIGNvbnN0IG1lcmdlZFBsYWNlaG9sZGVyUmVmID0gdXNlTWVtbygoKSA9PiB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIHBsYWNlaG9sZGVyXG4gICAgICB9ID0gcHJvcHM7XG4gICAgICBpZiAocGxhY2Vob2xkZXIgIT09IHVuZGVmaW5lZCkgcmV0dXJuIHBsYWNlaG9sZGVyO1xuICAgICAgcmV0dXJuIGxvY2FsZVJlZi52YWx1ZS5wbGFjZWhvbGRlcjtcbiAgICB9KTtcbiAgICBjb25zdCBtZXJnZWRTdGVwUmVmID0gdXNlTWVtbygoKSA9PiB7XG4gICAgICBjb25zdCBwYXJzZWROdW1iZXIgPSBwYXJzZU51bWJlcihwcm9wcy5zdGVwKTtcbiAgICAgIGlmIChwYXJzZWROdW1iZXIgIT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHBhcnNlZE51bWJlciA9PT0gMCA/IDEgOiBNYXRoLmFicyhwYXJzZWROdW1iZXIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIDE7XG4gICAgfSk7XG4gICAgY29uc3QgbWVyZ2VkTWluUmVmID0gdXNlTWVtbygoKSA9PiB7XG4gICAgICBjb25zdCBwYXJzZWROdW1iZXIgPSBwYXJzZU51bWJlcihwcm9wcy5taW4pO1xuICAgICAgaWYgKHBhcnNlZE51bWJlciAhPT0gbnVsbCkgcmV0dXJuIHBhcnNlZE51bWJlcjtlbHNlIHJldHVybiBudWxsO1xuICAgIH0pO1xuICAgIGNvbnN0IG1lcmdlZE1heFJlZiA9IHVzZU1lbW8oKCkgPT4ge1xuICAgICAgY29uc3QgcGFyc2VkTnVtYmVyID0gcGFyc2VOdW1iZXIocHJvcHMubWF4KTtcbiAgICAgIGlmIChwYXJzZWROdW1iZXIgIT09IG51bGwpIHJldHVybiBwYXJzZWROdW1iZXI7ZWxzZSByZXR1cm4gbnVsbDtcbiAgICB9KTtcbiAgICBjb25zdCBkb1VwZGF0ZVZhbHVlID0gdmFsdWUgPT4ge1xuICAgICAgY29uc3Qge1xuICAgICAgICB2YWx1ZTogbWVyZ2VkVmFsdWVcbiAgICAgIH0gPSBtZXJnZWRWYWx1ZVJlZjtcbiAgICAgIGlmICh2YWx1ZSA9PT0gbWVyZ2VkVmFsdWUpIHtcbiAgICAgICAgZGVyaXZlRGlzcGxheWVkVmFsdWVGcm9tVmFsdWUoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3Qge1xuICAgICAgICAnb25VcGRhdGU6dmFsdWUnOiBfb25VcGRhdGVWYWx1ZSxcbiAgICAgICAgb25VcGRhdGVWYWx1ZSxcbiAgICAgICAgb25DaGFuZ2VcbiAgICAgIH0gPSBwcm9wcztcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgblRyaWdnZXJGb3JtSW5wdXQsXG4gICAgICAgIG5UcmlnZ2VyRm9ybUNoYW5nZVxuICAgICAgfSA9IGZvcm1JdGVtO1xuICAgICAgaWYgKG9uQ2hhbmdlKSBjYWxsKG9uQ2hhbmdlLCB2YWx1ZSk7XG4gICAgICBpZiAob25VcGRhdGVWYWx1ZSkgY2FsbChvblVwZGF0ZVZhbHVlLCB2YWx1ZSk7XG4gICAgICBpZiAoX29uVXBkYXRlVmFsdWUpIGNhbGwoX29uVXBkYXRlVmFsdWUsIHZhbHVlKTtcbiAgICAgIHVuY29udHJvbGxlZFZhbHVlUmVmLnZhbHVlID0gdmFsdWU7XG4gICAgICBuVHJpZ2dlckZvcm1JbnB1dCgpO1xuICAgICAgblRyaWdnZXJGb3JtQ2hhbmdlKCk7XG4gICAgfTtcbiAgICBjb25zdCBkZXJpdmVWYWx1ZUZyb21EaXNwbGF5ZWRWYWx1ZSA9ICh7XG4gICAgICBvZmZzZXQsXG4gICAgICBkb1VwZGF0ZUlmVmFsaWQsXG4gICAgICBmaXhQcmVjaXNpb24sXG4gICAgICBpc0lucHV0aW5nXG4gICAgfSkgPT4ge1xuICAgICAgY29uc3Qge1xuICAgICAgICB2YWx1ZTogZGlzcGxheWVkVmFsdWVcbiAgICAgIH0gPSBkaXNwbGF5ZWRWYWx1ZVJlZjtcbiAgICAgIGlmIChpc0lucHV0aW5nICYmIGlzV2lwVmFsdWUoZGlzcGxheWVkVmFsdWUpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHBhcnNlZFZhbHVlID0gKHByb3BzLnBhcnNlIHx8IHBhcnNlKShkaXNwbGF5ZWRWYWx1ZSk7XG4gICAgICBpZiAocGFyc2VkVmFsdWUgPT09IG51bGwpIHtcbiAgICAgICAgaWYgKGRvVXBkYXRlSWZWYWxpZCkgZG9VcGRhdGVWYWx1ZShudWxsKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBpZiAodmFsaWRhdG9yKHBhcnNlZFZhbHVlKSkge1xuICAgICAgICBjb25zdCBjdXJyZW50UHJlY2lzaW9uID0gZ2V0UHJlY2lzaW9uKHBhcnNlZFZhbHVlKTtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIHByZWNpc2lvblxuICAgICAgICB9ID0gcHJvcHM7XG4gICAgICAgIGlmIChwcmVjaXNpb24gIT09IHVuZGVmaW5lZCAmJiBwcmVjaXNpb24gPCBjdXJyZW50UHJlY2lzaW9uICYmICFmaXhQcmVjaXNpb24pIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IG5leHRWYWx1ZSA9IHBhcnNlRmxvYXQoKHBhcnNlZFZhbHVlICsgb2Zmc2V0KS50b0ZpeGVkKHByZWNpc2lvbiAhPT0gbnVsbCAmJiBwcmVjaXNpb24gIT09IHZvaWQgMCA/IHByZWNpc2lvbiA6IGdldE1heFByZWNpc2lvbihwYXJzZWRWYWx1ZSkpKTtcbiAgICAgICAgaWYgKHZhbGlkYXRvcihuZXh0VmFsdWUpKSB7XG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgdmFsdWU6IG1lcmdlZE1heFxuICAgICAgICAgIH0gPSBtZXJnZWRNYXhSZWY7XG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgdmFsdWU6IG1lcmdlZE1pblxuICAgICAgICAgIH0gPSBtZXJnZWRNaW5SZWY7XG4gICAgICAgICAgaWYgKG1lcmdlZE1heCAhPT0gbnVsbCAmJiBuZXh0VmFsdWUgPiBtZXJnZWRNYXgpIHtcbiAgICAgICAgICAgIGlmICghZG9VcGRhdGVJZlZhbGlkIHx8IGlzSW5wdXRpbmcpIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIC8vIGlmIGRvVXBkYXRlSWZWYWxpZD10cnVlLCB3ZSB0cnkgdG8gbWFrZSBpdCBhIHZhbGlkIHZhbHVlXG4gICAgICAgICAgICBuZXh0VmFsdWUgPSBtZXJnZWRNYXg7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChtZXJnZWRNaW4gIT09IG51bGwgJiYgbmV4dFZhbHVlIDwgbWVyZ2VkTWluKSB7XG4gICAgICAgICAgICBpZiAoIWRvVXBkYXRlSWZWYWxpZCB8fCBpc0lucHV0aW5nKSByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAvLyBpZiBkb1VwZGF0ZUlmVmFsaWQ9dHJ1ZSwgd2UgdHJ5IHRvIG1ha2UgaXQgYSB2YWxpZCB2YWx1ZVxuICAgICAgICAgICAgbmV4dFZhbHVlID0gbWVyZ2VkTWluO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAocHJvcHMudmFsaWRhdG9yICYmICFwcm9wcy52YWxpZGF0b3IobmV4dFZhbHVlKSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIGlmIChkb1VwZGF0ZUlmVmFsaWQpIGRvVXBkYXRlVmFsdWUobmV4dFZhbHVlKTtcbiAgICAgICAgICByZXR1cm4gbmV4dFZhbHVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBjb25zdCBkZXJpdmVEaXNwbGF5ZWRWYWx1ZUZyb21WYWx1ZSA9ICgpID0+IHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgdmFsdWU6IG1lcmdlZFZhbHVlXG4gICAgICB9ID0gbWVyZ2VkVmFsdWVSZWY7XG4gICAgICBpZiAodmFsaWRhdG9yKG1lcmdlZFZhbHVlKSkge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgZm9ybWF0OiBmb3JtYXRQcm9wLFxuICAgICAgICAgIHByZWNpc2lvblxuICAgICAgICB9ID0gcHJvcHM7XG4gICAgICAgIGlmIChmb3JtYXRQcm9wKSB7XG4gICAgICAgICAgZGlzcGxheWVkVmFsdWVSZWYudmFsdWUgPSBmb3JtYXRQcm9wKG1lcmdlZFZhbHVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAobWVyZ2VkVmFsdWUgPT09IG51bGwgfHwgcHJlY2lzaW9uID09PSB1bmRlZmluZWQgfHxcbiAgICAgICAgICAvLyBwcmVjaXNpb24gb3ZlcmZsb3dcbiAgICAgICAgICBnZXRQcmVjaXNpb24obWVyZ2VkVmFsdWUpID4gcHJlY2lzaW9uKSB7XG4gICAgICAgICAgICBkaXNwbGF5ZWRWYWx1ZVJlZi52YWx1ZSA9IGZvcm1hdChtZXJnZWRWYWx1ZSwgdW5kZWZpbmVkKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGlzcGxheWVkVmFsdWVSZWYudmFsdWUgPSBmb3JtYXQobWVyZ2VkVmFsdWUsIHByZWNpc2lvbik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBudWxsIGNhbiBwYXNzIHRoZSB2YWxpZGF0b3IgY2hlY2tcbiAgICAgICAgLy8gc28gbWVyZ2VkVmFsdWUgaXMgYSBudW1iZXJcbiAgICAgICAgZGlzcGxheWVkVmFsdWVSZWYudmFsdWUgPSBTdHJpbmcobWVyZ2VkVmFsdWUpO1xuICAgICAgfVxuICAgIH07XG4gICAgZGVyaXZlRGlzcGxheWVkVmFsdWVGcm9tVmFsdWUoKTtcbiAgICBjb25zdCBkaXNwbGF5ZWRWYWx1ZUludmFsaWRSZWYgPSB1c2VNZW1vKCgpID0+IHtcbiAgICAgIGNvbnN0IGRlcml2ZWRWYWx1ZSA9IGRlcml2ZVZhbHVlRnJvbURpc3BsYXllZFZhbHVlKHtcbiAgICAgICAgb2Zmc2V0OiAwLFxuICAgICAgICBkb1VwZGF0ZUlmVmFsaWQ6IGZhbHNlLFxuICAgICAgICBpc0lucHV0aW5nOiBmYWxzZSxcbiAgICAgICAgZml4UHJlY2lzaW9uOiBmYWxzZVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gZGVyaXZlZFZhbHVlID09PSBmYWxzZTtcbiAgICB9KTtcbiAgICBjb25zdCBtaW51c2FibGVSZWYgPSB1c2VNZW1vKCgpID0+IHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgdmFsdWU6IG1lcmdlZFZhbHVlXG4gICAgICB9ID0gbWVyZ2VkVmFsdWVSZWY7XG4gICAgICBpZiAocHJvcHMudmFsaWRhdG9yICYmIG1lcmdlZFZhbHVlID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHtcbiAgICAgICAgdmFsdWU6IG1lcmdlZFN0ZXBcbiAgICAgIH0gPSBtZXJnZWRTdGVwUmVmO1xuICAgICAgY29uc3QgZGVyaXZlZE5leHRWYWx1ZSA9IGRlcml2ZVZhbHVlRnJvbURpc3BsYXllZFZhbHVlKHtcbiAgICAgICAgb2Zmc2V0OiAtbWVyZ2VkU3RlcCxcbiAgICAgICAgZG9VcGRhdGVJZlZhbGlkOiBmYWxzZSxcbiAgICAgICAgaXNJbnB1dGluZzogZmFsc2UsXG4gICAgICAgIGZpeFByZWNpc2lvbjogZmFsc2VcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGRlcml2ZWROZXh0VmFsdWUgIT09IGZhbHNlO1xuICAgIH0pO1xuICAgIGNvbnN0IGFkZGFibGVSZWYgPSB1c2VNZW1vKCgpID0+IHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgdmFsdWU6IG1lcmdlZFZhbHVlXG4gICAgICB9ID0gbWVyZ2VkVmFsdWVSZWY7XG4gICAgICBpZiAocHJvcHMudmFsaWRhdG9yICYmIG1lcmdlZFZhbHVlID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHtcbiAgICAgICAgdmFsdWU6IG1lcmdlZFN0ZXBcbiAgICAgIH0gPSBtZXJnZWRTdGVwUmVmO1xuICAgICAgY29uc3QgZGVyaXZlZE5leHRWYWx1ZSA9IGRlcml2ZVZhbHVlRnJvbURpc3BsYXllZFZhbHVlKHtcbiAgICAgICAgb2Zmc2V0OiArbWVyZ2VkU3RlcCxcbiAgICAgICAgZG9VcGRhdGVJZlZhbGlkOiBmYWxzZSxcbiAgICAgICAgaXNJbnB1dGluZzogZmFsc2UsXG4gICAgICAgIGZpeFByZWNpc2lvbjogZmFsc2VcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGRlcml2ZWROZXh0VmFsdWUgIT09IGZhbHNlO1xuICAgIH0pO1xuICAgIGZ1bmN0aW9uIGRvRm9jdXMoZSkge1xuICAgICAgY29uc3Qge1xuICAgICAgICBvbkZvY3VzXG4gICAgICB9ID0gcHJvcHM7XG4gICAgICBjb25zdCB7XG4gICAgICAgIG5UcmlnZ2VyRm9ybUZvY3VzXG4gICAgICB9ID0gZm9ybUl0ZW07XG4gICAgICBpZiAob25Gb2N1cykgY2FsbChvbkZvY3VzLCBlKTtcbiAgICAgIG5UcmlnZ2VyRm9ybUZvY3VzKCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGRvQmx1cihlKSB7XG4gICAgICB2YXIgX2EsIF9iO1xuICAgICAgaWYgKGUudGFyZ2V0ID09PSAoKF9hID0gaW5wdXRJbnN0UmVmLnZhbHVlKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Eud3JhcHBlckVsUmVmKSkge1xuICAgICAgICAvLyBoaXQgaW5wdXQgd3JhcHBlclxuICAgICAgICAvLyB3aGljaCBtZWFucyBub3QgYWN0aXZhdGVkXG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHZhbHVlID0gZGVyaXZlVmFsdWVGcm9tRGlzcGxheWVkVmFsdWUoe1xuICAgICAgICBvZmZzZXQ6IDAsXG4gICAgICAgIGRvVXBkYXRlSWZWYWxpZDogdHJ1ZSxcbiAgICAgICAgaXNJbnB1dGluZzogZmFsc2UsXG4gICAgICAgIGZpeFByZWNpc2lvbjogdHJ1ZVxuICAgICAgfSk7XG4gICAgICAvLyBJZiB2YWxpZCwgdXBkYXRlIGV2ZW50IGhhcyBiZWVuIGVtaXR0ZWRcbiAgICAgIC8vIG1ha2Ugc3VyZSBlLnRhcmdldC52YWx1ZSBpcyBjb3JyZWN0IGluIGJsdXIgY2FsbGJhY2tcbiAgICAgIGlmICh2YWx1ZSAhPT0gZmFsc2UpIHtcbiAgICAgICAgY29uc3QgaW5wdXRFbFJlZiA9IChfYiA9IGlucHV0SW5zdFJlZi52YWx1ZSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmlucHV0RWxSZWY7XG4gICAgICAgIGlmIChpbnB1dEVsUmVmKSB7XG4gICAgICAgICAgaW5wdXRFbFJlZi52YWx1ZSA9IFN0cmluZyh2YWx1ZSB8fCAnJyk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gSWYgdmFsdWUgaXMgbm90IGNoYW5nZWQsIHRoZSBkaXNwbGF5ZWQgdmFsdWUgbWF5IGJlIGdyZWF0ZXIgdGhhbiBvclxuICAgICAgICAvLyBsZXNzIHRoYW4gdGhlIGN1cnJlbnQgdmFsdWUuIFRoZSBkZXJpdmVkIHZhbHVlIGlzIHJlZm9ybWF0dGVkIHNvIHRoZVxuICAgICAgICAvLyB2YWx1ZSBpcyBub3QgY2hhbmdlZC4gV2UgY2FuIHNpbXBseSBkZXJpdmUgYSBuZXcgZGlzcGxheWVkIHZhbHVlXG4gICAgICAgIGlmIChtZXJnZWRWYWx1ZVJlZi52YWx1ZSA9PT0gdmFsdWUpIHtcbiAgICAgICAgICBkZXJpdmVEaXNwbGF5ZWRWYWx1ZUZyb21WYWx1ZSgpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBJZiBub3QgdmFsaWQsIG5vdGhpbmcgd2lsbCBiZSBlbWl0dGVkLCBzbyBkZXJpdmUgZGlzcGxheWVkIHZhbHVlIGZyb21cbiAgICAgICAgLy8gb3JpZ2luIHZhbHVlXG4gICAgICAgIGRlcml2ZURpc3BsYXllZFZhbHVlRnJvbVZhbHVlKCk7XG4gICAgICB9XG4gICAgICBjb25zdCB7XG4gICAgICAgIG9uQmx1clxuICAgICAgfSA9IHByb3BzO1xuICAgICAgY29uc3Qge1xuICAgICAgICBuVHJpZ2dlckZvcm1CbHVyXG4gICAgICB9ID0gZm9ybUl0ZW07XG4gICAgICBpZiAob25CbHVyKSBjYWxsKG9uQmx1ciwgZSk7XG4gICAgICBuVHJpZ2dlckZvcm1CbHVyKCk7XG4gICAgICAvLyBVc2VyIG1heSBjaGFuZ2UgdmFsdWUgaW4gYmx1ciBjYWxsYmFjaywgd2UgbWFrZSBzdXJlIGl0IHdpbGwgYmVcbiAgICAgIC8vIGRpc3BsYXllZC4gU29tZXRpbWVzIG1lcmdlZFZhbHVlIHdvbid0IGJlIHZpZXdlZCBhcyBjaGFuZ2VkXG4gICAgICB2b2lkIG5leHRUaWNrKCgpID0+IHtcbiAgICAgICAgZGVyaXZlRGlzcGxheWVkVmFsdWVGcm9tVmFsdWUoKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBmdW5jdGlvbiBkb0NsZWFyKGUpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgb25DbGVhclxuICAgICAgfSA9IHByb3BzO1xuICAgICAgaWYgKG9uQ2xlYXIpIGNhbGwob25DbGVhciwgZSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGRvQWRkKCkge1xuICAgICAgY29uc3Qge1xuICAgICAgICB2YWx1ZTogYWRkYWJsZVxuICAgICAgfSA9IGFkZGFibGVSZWY7XG4gICAgICBpZiAoIWFkZGFibGUpIHtcbiAgICAgICAgY2xlYXJBZGRIb2xkVGltZW91dCgpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCB7XG4gICAgICAgIHZhbHVlOiBtZXJnZWRWYWx1ZVxuICAgICAgfSA9IG1lcmdlZFZhbHVlUmVmO1xuICAgICAgaWYgKG1lcmdlZFZhbHVlID09PSBudWxsKSB7XG4gICAgICAgIGlmICghcHJvcHMudmFsaWRhdG9yKSB7XG4gICAgICAgICAgZG9VcGRhdGVWYWx1ZShjcmVhdGVWYWxpZFZhbHVlKCkpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgdmFsdWU6IG1lcmdlZFN0ZXBcbiAgICAgICAgfSA9IG1lcmdlZFN0ZXBSZWY7XG4gICAgICAgIGRlcml2ZVZhbHVlRnJvbURpc3BsYXllZFZhbHVlKHtcbiAgICAgICAgICBvZmZzZXQ6IG1lcmdlZFN0ZXAsXG4gICAgICAgICAgZG9VcGRhdGVJZlZhbGlkOiB0cnVlLFxuICAgICAgICAgIGlzSW5wdXRpbmc6IGZhbHNlLFxuICAgICAgICAgIGZpeFByZWNpc2lvbjogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gZG9NaW51cygpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgdmFsdWU6IG1pbnVzYWJsZVxuICAgICAgfSA9IG1pbnVzYWJsZVJlZjtcbiAgICAgIGlmICghbWludXNhYmxlKSB7XG4gICAgICAgIGNsZWFyTWludXNIb2xkVGltZW91dCgpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCB7XG4gICAgICAgIHZhbHVlOiBtZXJnZWRWYWx1ZVxuICAgICAgfSA9IG1lcmdlZFZhbHVlUmVmO1xuICAgICAgaWYgKG1lcmdlZFZhbHVlID09PSBudWxsKSB7XG4gICAgICAgIGlmICghcHJvcHMudmFsaWRhdG9yKSB7XG4gICAgICAgICAgZG9VcGRhdGVWYWx1ZShjcmVhdGVWYWxpZFZhbHVlKCkpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgdmFsdWU6IG1lcmdlZFN0ZXBcbiAgICAgICAgfSA9IG1lcmdlZFN0ZXBSZWY7XG4gICAgICAgIGRlcml2ZVZhbHVlRnJvbURpc3BsYXllZFZhbHVlKHtcbiAgICAgICAgICBvZmZzZXQ6IC1tZXJnZWRTdGVwLFxuICAgICAgICAgIGRvVXBkYXRlSWZWYWxpZDogdHJ1ZSxcbiAgICAgICAgICBpc0lucHV0aW5nOiBmYWxzZSxcbiAgICAgICAgICBmaXhQcmVjaXNpb246IHRydWVcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGhhbmRsZUZvY3VzID0gZG9Gb2N1cztcbiAgICBjb25zdCBoYW5kbGVCbHVyID0gZG9CbHVyO1xuICAgIGZ1bmN0aW9uIGNyZWF0ZVZhbGlkVmFsdWUoKSB7XG4gICAgICBpZiAocHJvcHMudmFsaWRhdG9yKSByZXR1cm4gbnVsbDtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgdmFsdWU6IG1lcmdlZE1pblxuICAgICAgfSA9IG1lcmdlZE1pblJlZjtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgdmFsdWU6IG1lcmdlZE1heFxuICAgICAgfSA9IG1lcmdlZE1heFJlZjtcbiAgICAgIGlmIChtZXJnZWRNaW4gIT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIE1hdGgubWF4KDAsIG1lcmdlZE1pbik7XG4gICAgICB9IGVsc2UgaWYgKG1lcmdlZE1heCAhPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gTWF0aC5taW4oMCwgbWVyZ2VkTWF4KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBoYW5kbGVDbGVhcihlKSB7XG4gICAgICBkb0NsZWFyKGUpO1xuICAgICAgZG9VcGRhdGVWYWx1ZShudWxsKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaGFuZGxlTW91c2VEb3duKGUpIHtcbiAgICAgIHZhciBfYSwgX2IsIF9jO1xuICAgICAgaWYgKChfYSA9IGFkZEJ1dHRvbkluc3RSZWYudmFsdWUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS4kZWwuY29udGFpbnMoZS50YXJnZXQpKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIH1cbiAgICAgIGlmICgoX2IgPSBtaW51c0J1dHRvbkluc3RSZWYudmFsdWUpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi4kZWwuY29udGFpbnMoZS50YXJnZXQpKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIH1cbiAgICAgIChfYyA9IGlucHV0SW5zdFJlZi52YWx1ZSkgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLmFjdGl2YXRlKCk7XG4gICAgfVxuICAgIGxldCBtaW51c0hvbGRTdGF0ZUludGVydmFsSWQgPSBudWxsO1xuICAgIGxldCBhZGRIb2xkU3RhdGVJbnRlcnZhbElkID0gbnVsbDtcbiAgICBsZXQgZmlyc3RNaW51c01vdXNlZG93bklkID0gbnVsbDtcbiAgICBmdW5jdGlvbiBjbGVhck1pbnVzSG9sZFRpbWVvdXQoKSB7XG4gICAgICBpZiAoZmlyc3RNaW51c01vdXNlZG93bklkKSB7XG4gICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQoZmlyc3RNaW51c01vdXNlZG93bklkKTtcbiAgICAgICAgZmlyc3RNaW51c01vdXNlZG93bklkID0gbnVsbDtcbiAgICAgIH1cbiAgICAgIGlmIChtaW51c0hvbGRTdGF0ZUludGVydmFsSWQpIHtcbiAgICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwobWludXNIb2xkU3RhdGVJbnRlcnZhbElkKTtcbiAgICAgICAgbWludXNIb2xkU3RhdGVJbnRlcnZhbElkID0gbnVsbDtcbiAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gY2xlYXJBZGRIb2xkVGltZW91dCgpIHtcbiAgICAgIGlmIChmaXJzdEFkZE1vdXNlZG93bklkKSB7XG4gICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQoZmlyc3RBZGRNb3VzZWRvd25JZCk7XG4gICAgICAgIGZpcnN0QWRkTW91c2Vkb3duSWQgPSBudWxsO1xuICAgICAgfVxuICAgICAgaWYgKGFkZEhvbGRTdGF0ZUludGVydmFsSWQpIHtcbiAgICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwoYWRkSG9sZFN0YXRlSW50ZXJ2YWxJZCk7XG4gICAgICAgIGFkZEhvbGRTdGF0ZUludGVydmFsSWQgPSBudWxsO1xuICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBoYW5kbGVNaW51c01vdXNlZG93bigpIHtcbiAgICAgIGNsZWFyTWludXNIb2xkVGltZW91dCgpO1xuICAgICAgZmlyc3RNaW51c01vdXNlZG93bklkID0gd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBtaW51c0hvbGRTdGF0ZUludGVydmFsSWQgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICAgIGRvTWludXMoKTtcbiAgICAgICAgfSwgSE9MRElOR19DSEFOR0VfSU5URVJWQUwpO1xuICAgICAgfSwgSE9MRElOR19DSEFOR0VfVEhSRVNIT0xEKTtcbiAgICAgIG9uKCdtb3VzZXVwJywgZG9jdW1lbnQsIGNsZWFyTWludXNIb2xkVGltZW91dCwge1xuICAgICAgICBvbmNlOiB0cnVlXG4gICAgICB9KTtcbiAgICB9XG4gICAgbGV0IGZpcnN0QWRkTW91c2Vkb3duSWQgPSBudWxsO1xuICAgIGZ1bmN0aW9uIGhhbmRsZUFkZE1vdXNlZG93bigpIHtcbiAgICAgIGNsZWFyQWRkSG9sZFRpbWVvdXQoKTtcbiAgICAgIGZpcnN0QWRkTW91c2Vkb3duSWQgPSB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGFkZEhvbGRTdGF0ZUludGVydmFsSWQgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICAgIGRvQWRkKCk7XG4gICAgICAgIH0sIEhPTERJTkdfQ0hBTkdFX0lOVEVSVkFMKTtcbiAgICAgIH0sIEhPTERJTkdfQ0hBTkdFX1RIUkVTSE9MRCk7XG4gICAgICBvbignbW91c2V1cCcsIGRvY3VtZW50LCBjbGVhckFkZEhvbGRUaW1lb3V0LCB7XG4gICAgICAgIG9uY2U6IHRydWVcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBoYW5kbGVBZGRDbGljayA9ICgpID0+IHtcbiAgICAgIGlmIChhZGRIb2xkU3RhdGVJbnRlcnZhbElkKSByZXR1cm47XG4gICAgICBkb0FkZCgpO1xuICAgIH07XG4gICAgY29uc3QgaGFuZGxlTWludXNDbGljayA9ICgpID0+IHtcbiAgICAgIGlmIChtaW51c0hvbGRTdGF0ZUludGVydmFsSWQpIHJldHVybjtcbiAgICAgIGRvTWludXMoKTtcbiAgICB9O1xuICAgIGZ1bmN0aW9uIGhhbmRsZUtleURvd24oZSkge1xuICAgICAgdmFyIF9hLCBfYjtcbiAgICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJykge1xuICAgICAgICBpZiAoZS50YXJnZXQgPT09ICgoX2EgPSBpbnB1dEluc3RSZWYudmFsdWUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS53cmFwcGVyRWxSZWYpKSB7XG4gICAgICAgICAgLy8gaGl0IGlucHV0IHdyYXBwZXJcbiAgICAgICAgICAvLyB3aGljaCBtZWFucyBub3QgYWN0aXZhdGVkXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHZhbHVlID0gZGVyaXZlVmFsdWVGcm9tRGlzcGxheWVkVmFsdWUoe1xuICAgICAgICAgIG9mZnNldDogMCxcbiAgICAgICAgICBkb1VwZGF0ZUlmVmFsaWQ6IHRydWUsXG4gICAgICAgICAgaXNJbnB1dGluZzogZmFsc2UsXG4gICAgICAgICAgZml4UHJlY2lzaW9uOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodmFsdWUgIT09IGZhbHNlKSB7XG4gICAgICAgICAgKF9iID0gaW5wdXRJbnN0UmVmLnZhbHVlKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuZGVhY3RpdmF0ZSgpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGUua2V5ID09PSAnQXJyb3dVcCcpIHtcbiAgICAgICAgaWYgKCFhZGRhYmxlUmVmLnZhbHVlKSByZXR1cm47XG4gICAgICAgIGlmIChwcm9wcy5rZXlib2FyZC5BcnJvd1VwID09PSBmYWxzZSkgcmV0dXJuO1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gZGVyaXZlVmFsdWVGcm9tRGlzcGxheWVkVmFsdWUoe1xuICAgICAgICAgIG9mZnNldDogMCxcbiAgICAgICAgICBkb1VwZGF0ZUlmVmFsaWQ6IHRydWUsXG4gICAgICAgICAgaXNJbnB1dGluZzogZmFsc2UsXG4gICAgICAgICAgZml4UHJlY2lzaW9uOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodmFsdWUgIT09IGZhbHNlKSB7XG4gICAgICAgICAgZG9BZGQoKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChlLmtleSA9PT0gJ0Fycm93RG93bicpIHtcbiAgICAgICAgaWYgKCFtaW51c2FibGVSZWYudmFsdWUpIHJldHVybjtcbiAgICAgICAgaWYgKHByb3BzLmtleWJvYXJkLkFycm93RG93biA9PT0gZmFsc2UpIHJldHVybjtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBjb25zdCB2YWx1ZSA9IGRlcml2ZVZhbHVlRnJvbURpc3BsYXllZFZhbHVlKHtcbiAgICAgICAgICBvZmZzZXQ6IDAsXG4gICAgICAgICAgZG9VcGRhdGVJZlZhbGlkOiB0cnVlLFxuICAgICAgICAgIGlzSW5wdXRpbmc6IGZhbHNlLFxuICAgICAgICAgIGZpeFByZWNpc2lvbjogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHZhbHVlICE9PSBmYWxzZSkge1xuICAgICAgICAgIGRvTWludXMoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBoYW5kbGVVcGRhdGVEaXNwbGF5ZWRWYWx1ZSh2YWx1ZSkge1xuICAgICAgZGlzcGxheWVkVmFsdWVSZWYudmFsdWUgPSB2YWx1ZTtcbiAgICAgIGlmIChwcm9wcy51cGRhdGVWYWx1ZU9uSW5wdXQgJiYgIXByb3BzLmZvcm1hdCAmJiAhcHJvcHMucGFyc2UgJiYgcHJvcHMucHJlY2lzaW9uID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgZGVyaXZlVmFsdWVGcm9tRGlzcGxheWVkVmFsdWUoe1xuICAgICAgICAgIG9mZnNldDogMCxcbiAgICAgICAgICBkb1VwZGF0ZUlmVmFsaWQ6IHRydWUsXG4gICAgICAgICAgaXNJbnB1dGluZzogdHJ1ZSxcbiAgICAgICAgICBmaXhQcmVjaXNpb246IGZhbHNlXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICB3YXRjaChtZXJnZWRWYWx1ZVJlZiwgKCkgPT4ge1xuICAgICAgZGVyaXZlRGlzcGxheWVkVmFsdWVGcm9tVmFsdWUoKTtcbiAgICB9KTtcbiAgICBjb25zdCBleHBvc2VkTWV0aG9kcyA9IHtcbiAgICAgIGZvY3VzOiAoKSA9PiB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgcmV0dXJuIChfYSA9IGlucHV0SW5zdFJlZi52YWx1ZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmZvY3VzKCk7XG4gICAgICB9LFxuICAgICAgYmx1cjogKCkgPT4ge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHJldHVybiAoX2EgPSBpbnB1dEluc3RSZWYudmFsdWUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5ibHVyKCk7XG4gICAgICB9LFxuICAgICAgc2VsZWN0OiAoKSA9PiB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgcmV0dXJuIChfYSA9IGlucHV0SW5zdFJlZi52YWx1ZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnNlbGVjdCgpO1xuICAgICAgfVxuICAgIH07XG4gICAgY29uc3QgcnRsRW5hYmxlZFJlZiA9IHVzZVJ0bCgnSW5wdXROdW1iZXInLCBtZXJnZWRSdGxSZWYsIG1lcmdlZENsc1ByZWZpeFJlZik7XG4gICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgZXhwb3NlZE1ldGhvZHMpLCB7XG4gICAgICBydGxFbmFibGVkOiBydGxFbmFibGVkUmVmLFxuICAgICAgaW5wdXRJbnN0UmVmLFxuICAgICAgbWludXNCdXR0b25JbnN0UmVmLFxuICAgICAgYWRkQnV0dG9uSW5zdFJlZixcbiAgICAgIG1lcmdlZENsc1ByZWZpeDogbWVyZ2VkQ2xzUHJlZml4UmVmLFxuICAgICAgbWVyZ2VkQm9yZGVyZWQ6IG1lcmdlZEJvcmRlcmVkUmVmLFxuICAgICAgdW5jb250cm9sbGVkVmFsdWU6IHVuY29udHJvbGxlZFZhbHVlUmVmLFxuICAgICAgbWVyZ2VkVmFsdWU6IG1lcmdlZFZhbHVlUmVmLFxuICAgICAgbWVyZ2VkUGxhY2Vob2xkZXI6IG1lcmdlZFBsYWNlaG9sZGVyUmVmLFxuICAgICAgZGlzcGxheWVkVmFsdWVJbnZhbGlkOiBkaXNwbGF5ZWRWYWx1ZUludmFsaWRSZWYsXG4gICAgICBtZXJnZWRTaXplOiBtZXJnZWRTaXplUmVmLFxuICAgICAgbWVyZ2VkRGlzYWJsZWQ6IG1lcmdlZERpc2FibGVkUmVmLFxuICAgICAgZGlzcGxheWVkVmFsdWU6IGRpc3BsYXllZFZhbHVlUmVmLFxuICAgICAgYWRkYWJsZTogYWRkYWJsZVJlZixcbiAgICAgIG1pbnVzYWJsZTogbWludXNhYmxlUmVmLFxuICAgICAgbWVyZ2VkU3RhdHVzOiBtZXJnZWRTdGF0dXNSZWYsXG4gICAgICBoYW5kbGVGb2N1cyxcbiAgICAgIGhhbmRsZUJsdXIsXG4gICAgICBoYW5kbGVDbGVhcixcbiAgICAgIGhhbmRsZU1vdXNlRG93bixcbiAgICAgIGhhbmRsZUFkZENsaWNrLFxuICAgICAgaGFuZGxlTWludXNDbGljayxcbiAgICAgIGhhbmRsZUFkZE1vdXNlZG93bixcbiAgICAgIGhhbmRsZU1pbnVzTW91c2Vkb3duLFxuICAgICAgaGFuZGxlS2V5RG93bixcbiAgICAgIGhhbmRsZVVwZGF0ZURpc3BsYXllZFZhbHVlLFxuICAgICAgLy8gdGhlbWVcbiAgICAgIG1lcmdlZFRoZW1lOiB0aGVtZVJlZixcbiAgICAgIGlucHV0VGhlbWVPdmVycmlkZXM6IHtcbiAgICAgICAgcGFkZGluZ1NtYWxsOiAnMCA4cHggMCAxMHB4JyxcbiAgICAgICAgcGFkZGluZ01lZGl1bTogJzAgOHB4IDAgMTJweCcsXG4gICAgICAgIHBhZGRpbmdMYXJnZTogJzAgOHB4IDAgMTRweCdcbiAgICAgIH0sXG4gICAgICBidXR0b25UaGVtZU92ZXJyaWRlczogY29tcHV0ZWQoKCkgPT4ge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgc2VsZjoge1xuICAgICAgICAgICAgaWNvbkNvbG9yRGlzYWJsZWRcbiAgICAgICAgICB9XG4gICAgICAgIH0gPSB0aGVtZVJlZi52YWx1ZTtcbiAgICAgICAgY29uc3QgW3IsIGcsIGIsIGFdID0gcmdiYShpY29uQ29sb3JEaXNhYmxlZCk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdGV4dENvbG9yVGV4dERpc2FibGVkOiBgcmdiKCR7cn0sICR7Z30sICR7Yn0pYCxcbiAgICAgICAgICBvcGFjaXR5RGlzYWJsZWQ6IGAke2F9YFxuICAgICAgICB9O1xuICAgICAgfSlcbiAgICB9KTtcbiAgfSxcbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtcbiAgICAgIG1lcmdlZENsc1ByZWZpeCxcbiAgICAgICRzbG90c1xuICAgIH0gPSB0aGlzO1xuICAgIGNvbnN0IHJlbmRlck1pbnVzQnV0dG9uID0gKCkgPT4ge1xuICAgICAgcmV0dXJuIGgoTnhCdXR0b24sIHtcbiAgICAgICAgdGV4dDogdHJ1ZSxcbiAgICAgICAgZGlzYWJsZWQ6ICF0aGlzLm1pbnVzYWJsZSB8fCB0aGlzLm1lcmdlZERpc2FibGVkIHx8IHRoaXMucmVhZG9ubHksXG4gICAgICAgIGZvY3VzYWJsZTogZmFsc2UsXG4gICAgICAgIHRoZW1lOiB0aGlzLm1lcmdlZFRoZW1lLnBlZXJzLkJ1dHRvbixcbiAgICAgICAgdGhlbWVPdmVycmlkZXM6IHRoaXMubWVyZ2VkVGhlbWUucGVlck92ZXJyaWRlcy5CdXR0b24sXG4gICAgICAgIGJ1aWx0aW5UaGVtZU92ZXJyaWRlczogdGhpcy5idXR0b25UaGVtZU92ZXJyaWRlcyxcbiAgICAgICAgb25DbGljazogdGhpcy5oYW5kbGVNaW51c0NsaWNrLFxuICAgICAgICBvbk1vdXNlZG93bjogdGhpcy5oYW5kbGVNaW51c01vdXNlZG93bixcbiAgICAgICAgcmVmOiBcIm1pbnVzQnV0dG9uSW5zdFJlZlwiXG4gICAgICB9LCB7XG4gICAgICAgIGljb246ICgpID0+IHJlc29sdmVTbG90KCRzbG90c1snbWludXMtaWNvbiddLCAoKSA9PiBbaChOQmFzZUljb24sIHtcbiAgICAgICAgICBjbHNQcmVmaXg6IG1lcmdlZENsc1ByZWZpeFxuICAgICAgICB9LCB7XG4gICAgICAgICAgZGVmYXVsdDogKCkgPT4gaChSZW1vdmVJY29uLCBudWxsKVxuICAgICAgICB9KV0pXG4gICAgICB9KTtcbiAgICB9O1xuICAgIGNvbnN0IHJlbmRlckFkZEJ1dHRvbiA9ICgpID0+IHtcbiAgICAgIHJldHVybiBoKE54QnV0dG9uLCB7XG4gICAgICAgIHRleHQ6IHRydWUsXG4gICAgICAgIGRpc2FibGVkOiAhdGhpcy5hZGRhYmxlIHx8IHRoaXMubWVyZ2VkRGlzYWJsZWQgfHwgdGhpcy5yZWFkb25seSxcbiAgICAgICAgZm9jdXNhYmxlOiBmYWxzZSxcbiAgICAgICAgdGhlbWU6IHRoaXMubWVyZ2VkVGhlbWUucGVlcnMuQnV0dG9uLFxuICAgICAgICB0aGVtZU92ZXJyaWRlczogdGhpcy5tZXJnZWRUaGVtZS5wZWVyT3ZlcnJpZGVzLkJ1dHRvbixcbiAgICAgICAgYnVpbHRpblRoZW1lT3ZlcnJpZGVzOiB0aGlzLmJ1dHRvblRoZW1lT3ZlcnJpZGVzLFxuICAgICAgICBvbkNsaWNrOiB0aGlzLmhhbmRsZUFkZENsaWNrLFxuICAgICAgICBvbk1vdXNlZG93bjogdGhpcy5oYW5kbGVBZGRNb3VzZWRvd24sXG4gICAgICAgIHJlZjogXCJhZGRCdXR0b25JbnN0UmVmXCJcbiAgICAgIH0sIHtcbiAgICAgICAgaWNvbjogKCkgPT4gcmVzb2x2ZVNsb3QoJHNsb3RzWydhZGQtaWNvbiddLCAoKSA9PiBbaChOQmFzZUljb24sIHtcbiAgICAgICAgICBjbHNQcmVmaXg6IG1lcmdlZENsc1ByZWZpeFxuICAgICAgICB9LCB7XG4gICAgICAgICAgZGVmYXVsdDogKCkgPT4gaChBZGRJY29uLCBudWxsKVxuICAgICAgICB9KV0pXG4gICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBoKFwiZGl2XCIsIHtcbiAgICAgIGNsYXNzOiBbYCR7bWVyZ2VkQ2xzUHJlZml4fS1pbnB1dC1udW1iZXJgLCB0aGlzLnJ0bEVuYWJsZWQgJiYgYCR7bWVyZ2VkQ2xzUHJlZml4fS1pbnB1dC1udW1iZXItLXJ0bGBdXG4gICAgfSwgaChOSW5wdXQsIHtcbiAgICAgIHJlZjogXCJpbnB1dEluc3RSZWZcIixcbiAgICAgIGF1dG9mb2N1czogdGhpcy5hdXRvZm9jdXMsXG4gICAgICBzdGF0dXM6IHRoaXMubWVyZ2VkU3RhdHVzLFxuICAgICAgYm9yZGVyZWQ6IHRoaXMubWVyZ2VkQm9yZGVyZWQsXG4gICAgICBsb2FkaW5nOiB0aGlzLmxvYWRpbmcsXG4gICAgICB2YWx1ZTogdGhpcy5kaXNwbGF5ZWRWYWx1ZSxcbiAgICAgIG9uVXBkYXRlVmFsdWU6IHRoaXMuaGFuZGxlVXBkYXRlRGlzcGxheWVkVmFsdWUsXG4gICAgICB0aGVtZTogdGhpcy5tZXJnZWRUaGVtZS5wZWVycy5JbnB1dCxcbiAgICAgIHRoZW1lT3ZlcnJpZGVzOiB0aGlzLm1lcmdlZFRoZW1lLnBlZXJPdmVycmlkZXMuSW5wdXQsXG4gICAgICBidWlsdGluVGhlbWVPdmVycmlkZXM6IHRoaXMuaW5wdXRUaGVtZU92ZXJyaWRlcyxcbiAgICAgIHNpemU6IHRoaXMubWVyZ2VkU2l6ZSxcbiAgICAgIHBsYWNlaG9sZGVyOiB0aGlzLm1lcmdlZFBsYWNlaG9sZGVyLFxuICAgICAgZGlzYWJsZWQ6IHRoaXMubWVyZ2VkRGlzYWJsZWQsXG4gICAgICByZWFkb25seTogdGhpcy5yZWFkb25seSxcbiAgICAgIHRleHREZWNvcmF0aW9uOiB0aGlzLmRpc3BsYXllZFZhbHVlSW52YWxpZCA/ICdsaW5lLXRocm91Z2gnIDogdW5kZWZpbmVkLFxuICAgICAgb25Gb2N1czogdGhpcy5oYW5kbGVGb2N1cyxcbiAgICAgIG9uQmx1cjogdGhpcy5oYW5kbGVCbHVyLFxuICAgICAgb25LZXlkb3duOiB0aGlzLmhhbmRsZUtleURvd24sXG4gICAgICBvbk1vdXNlZG93bjogdGhpcy5oYW5kbGVNb3VzZURvd24sXG4gICAgICBvbkNsZWFyOiB0aGlzLmhhbmRsZUNsZWFyLFxuICAgICAgY2xlYXJhYmxlOiB0aGlzLmNsZWFyYWJsZSxcbiAgICAgIGlucHV0UHJvcHM6IHRoaXMuaW5wdXRQcm9wcyxcbiAgICAgIGludGVybmFsTG9hZGluZ0JlZm9yZVN1ZmZpeDogdHJ1ZVxuICAgIH0sIHtcbiAgICAgIHByZWZpeDogKCkgPT4ge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHJldHVybiB0aGlzLnNob3dCdXR0b24gJiYgdGhpcy5idXR0b25QbGFjZW1lbnQgPT09ICdib3RoJyA/IFtyZW5kZXJNaW51c0J1dHRvbigpLCByZXNvbHZlV3JhcHBlZFNsb3QoJHNsb3RzLnByZWZpeCwgY2hpbGRyZW4gPT4ge1xuICAgICAgICAgIGlmIChjaGlsZHJlbikge1xuICAgICAgICAgICAgcmV0dXJuIGgoXCJzcGFuXCIsIHtcbiAgICAgICAgICAgICAgY2xhc3M6IGAke21lcmdlZENsc1ByZWZpeH0taW5wdXQtbnVtYmVyLXByZWZpeGBcbiAgICAgICAgICAgIH0sIGNoaWxkcmVuKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0pXSA6IChfYSA9ICRzbG90cy5wcmVmaXgpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5jYWxsKCRzbG90cyk7XG4gICAgICB9LFxuICAgICAgc3VmZml4OiAoKSA9PiB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2hvd0J1dHRvbiA/IFtyZXNvbHZlV3JhcHBlZFNsb3QoJHNsb3RzLnN1ZmZpeCwgY2hpbGRyZW4gPT4ge1xuICAgICAgICAgIGlmIChjaGlsZHJlbikge1xuICAgICAgICAgICAgcmV0dXJuIGgoXCJzcGFuXCIsIHtcbiAgICAgICAgICAgICAgY2xhc3M6IGAke21lcmdlZENsc1ByZWZpeH0taW5wdXQtbnVtYmVyLXN1ZmZpeGBcbiAgICAgICAgICAgIH0sIGNoaWxkcmVuKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0pLCB0aGlzLmJ1dHRvblBsYWNlbWVudCA9PT0gJ3JpZ2h0JyA/IHJlbmRlck1pbnVzQnV0dG9uKCkgOiBudWxsLCByZW5kZXJBZGRCdXR0b24oKV0gOiAoX2EgPSAkc2xvdHMuc3VmZml4KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuY2FsbCgkc2xvdHMpO1xuICAgICAgfVxuICAgIH0pKTtcbiAgfVxufSk7IiwiaW1wb3J0IHsgY0IsIGMgfSBmcm9tIFwiLi4vLi4vLi4vX3V0aWxzL2Nzc3IvaW5kZXgubWpzXCI7XG5leHBvcnQgZGVmYXVsdCBjKFtjQignaW5wdXQtbnVtYmVyLXN1ZmZpeCcsIGBcbiBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gbWFyZ2luLXJpZ2h0OiAxMHB4O1xuIGApLCBjQignaW5wdXQtbnVtYmVyLXByZWZpeCcsIGBcbiBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gbWFyZ2luLWxlZnQ6IDEwcHg7XG4gYCldKTsiLCIvLyBzdHJpbmcgPT4gc3RyaW5nIChleHBlY3RlZCwgbm90IGltcGxlbWVudGVkKVxuLy8gc3RyaW5nID0+IG51bWJlciAobGVnYWN5KVxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlKHZhbHVlKSB7XG4gIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSBudWxsIHx8IHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYgdmFsdWUudHJpbSgpID09PSAnJykge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIHJldHVybiBOdW1iZXIodmFsdWUpO1xufVxuLy8gY2FuIGJlIHBhcnNlZCB0byBudW1iZXIgYnV0IHNob3VsZG4ndCBiZSBhcHBsaWVkIHdoZW4gaW5wdXRpbmdcbi8vIHdoZW4gdmFsdWUgaW5jbHVkZXMgYC5gLCBlbmRpbmcgd2l0aCAwIGFuZGAuYCwgZG9lc24ndCB1cGRhdGUsIGlmIDAgcGFyc2UgZnVuYyB3aWxsIHJlbW92ZSAwXG5leHBvcnQgZnVuY3Rpb24gaXNXaXBWYWx1ZSh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUuaW5jbHVkZXMoJy4nKSAmJiAoL14oLSk/XFxkKy4qKFxcLnwwKSQvLnRlc3QodmFsdWUpIHx8IC9eXFwuXFxkKyQvLnRlc3QodmFsdWUpKTtcbn1cbi8vIHN0cmluZyA9PiBib29sZWFuIChleHBlY3RlZCwgbm90IGltcGxlbWVudGVkKVxuLy8gbnVtYmVyID0+IGJvb2xlYW4gKGxlZ2FjeSlcbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0b3IodmFsdWUpIHtcbiAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09IG51bGwpIHJldHVybiB0cnVlO1xuICBpZiAoTnVtYmVyLmlzTmFOKHZhbHVlKSkgcmV0dXJuIGZhbHNlO1xuICByZXR1cm4gdHJ1ZTtcbn1cbi8vIHN0cmluZyA9PiBzdHJpbmcgKGV4cGVjdGVkLCBub3QgaW1wbGVtZW50ZWQpXG4vLyBudW1iZXIgPT4gc3RyaW5nIChsZWdhY3kpXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0KHZhbHVlLCBwcmVjaXNpb24pIHtcbiAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09IG51bGwpIHJldHVybiAnJztcbiAgcmV0dXJuIHByZWNpc2lvbiA9PT0gdW5kZWZpbmVkID8gU3RyaW5nKHZhbHVlKSA6IHZhbHVlLnRvRml4ZWQocHJlY2lzaW9uKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZU51bWJlcihudW1iZXIpIHtcbiAgaWYgKG51bWJlciA9PT0gbnVsbCkgcmV0dXJuIG51bGw7XG4gIGlmICh0eXBlb2YgbnVtYmVyID09PSAnbnVtYmVyJykge1xuICAgIHJldHVybiBudW1iZXI7XG4gIH0gZWxzZSB7XG4gICAgY29uc3QgcGFyc2VkTnVtYmVyID0gTnVtYmVyKG51bWJlcik7XG4gICAgaWYgKE51bWJlci5pc05hTihwYXJzZWROdW1iZXIpKSByZXR1cm4gbnVsbDtlbHNlIHtcbiAgICAgIHJldHVybiBwYXJzZWROdW1iZXI7XG4gICAgfVxuICB9XG59IiwiaW1wb3J0IHsgYnV0dG9uTGlnaHQgfSBmcm9tIFwiLi4vLi4vYnV0dG9uL3N0eWxlcy9pbmRleC5tanNcIjtcbmltcG9ydCB7IGlucHV0TGlnaHQgfSBmcm9tIFwiLi4vLi4vaW5wdXQvc3R5bGVzL2luZGV4Lm1qc1wiO1xuaW1wb3J0IHsgY29tbW9uTGlnaHQgfSBmcm9tIFwiLi4vLi4vX3N0eWxlcy9jb21tb24vaW5kZXgubWpzXCI7XG5pbXBvcnQgeyBjcmVhdGVUaGVtZSB9IGZyb20gXCIuLi8uLi9fbWl4aW5zL2luZGV4Lm1qc1wiO1xuY29uc3Qgc2VsZiA9IHZhcnMgPT4ge1xuICBjb25zdCB7XG4gICAgdGV4dENvbG9yRGlzYWJsZWRcbiAgfSA9IHZhcnM7XG4gIHJldHVybiB7XG4gICAgaWNvbkNvbG9yRGlzYWJsZWQ6IHRleHRDb2xvckRpc2FibGVkXG4gIH07XG59O1xuY29uc3QgaW5wdXROdW1iZXJMaWdodCA9IGNyZWF0ZVRoZW1lKHtcbiAgbmFtZTogJ0lucHV0TnVtYmVyJyxcbiAgY29tbW9uOiBjb21tb25MaWdodCxcbiAgcGVlcnM6IHtcbiAgICBCdXR0b246IGJ1dHRvbkxpZ2h0LFxuICAgIElucHV0OiBpbnB1dExpZ2h0XG4gIH0sXG4gIHNlbGZcbn0pO1xuZXhwb3J0IGRlZmF1bHQgaW5wdXROdW1iZXJMaWdodDsiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=