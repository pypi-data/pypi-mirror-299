[build-system]
requires = ["setuptools", "setuptools-scm"]
build-backend = "setuptools.build_meta"

[project]
name = "momotor-bundles"
authors = [
    { name = "Erik Scheffers", email = "e.t.j.scheffers@tue.nl" }
]
description = "Momotor bundle reader, writer, tools"
requires-python = ">=3.9"
dynamic = ["version", "readme"]
license = { text="GNU Lesser General Public License v3 (LGPLv3)" }
classifiers = [
    "Development Status :: 5 - Production/Stable",
    "Intended Audience :: Developers",
    "Programming Language :: Python",
    "Programming Language :: Python :: 3.9",
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Programming Language :: Python :: 3 :: Only",
]
dependencies = [
    "pathvalidate",
    "xsdata>=24.7,<24.8",
    "typing-extensions; python_version < '3.11'",
]

[project.optional-dependencies]
lxml = [
    'xsdata[lxml]>=24.7,<24.8'
]
test = [
    'momotor-bundles[lxml]',
    'pytest~=8.1',
    'pytest-cov',
    'pytest-doctestplus',
    'xmljson',
]
docs = [
    'momotor-bundles[test]',
    'Sphinx',
    'sphinx-autodoc-typehints!=1.14.0',
    'furo',
]
dev = [
    'momotor-bundles[lxml,docs]',
    'docutils-stubs',
    'xsdata[cli]>=24.7,<24.8',
]
build = [
    'momotor-bundles[dev]',
    'setuptools',
    'setuptools-scm',
    'build[virtualenv]',
    'python-semantic-release~=9.0',
]

[project.urls]
Homepage = "https://momotor.org"
Documentation = "https://momotor.org/doc/engine/momotor-bundles/"
Repository = "https://gitlab.tue.nl/momotor/engine-py3/momotor-bundles/"
Tracker = 'https://gitlab.tue.nl/momotor/engine-py3/momotor-bundles/issues'

[tool.setuptools]
include-package-data = true

[tool.setuptools.packages.find]
where = ["src"]
include = ["momotor.*"]

[tool.setuptools.package-data]
"momotor.bundles.schema" = ["*.xsd"]

[tool.setuptools.dynamic]
readme = { file = ["README.md"], content-type = "text/markdown" }

[tool.setuptools_scm]

[tool.pytest.ini_options]
required_plugins = ["pytest-doctestplus"]
norecursedirs = [".git", "files"]
pythonpath = "src"
addopts = "--cov=src --doctest-plus --doctest-rst --doctest-modules -p no:django"
xfail_strict = true

[tool.coverage.report]
exclude_lines = [
    'pragma: no cover',
    'assert False',
    'def __repr__',
    'raise NotImplementedError',
    '\.\.\.',
]

[tool.semantic_release]
version_toml = ["version.toml:semantic_release.version"]
commit_message = 'chore: bump version number'

[tool.semantic_release.changelog]
exclude_commit_patterns = ["^Merge branch ", "^ci\\s*[:(]", "^build\\s*[:(]"]

[tool.semantic_release.release]
upload_to_vcs_release = false

[tool.semantic_release.remote]
type = "gitlab"

[tool.semantic_release.branches.master]
match = "master"
prerelease = false

[tool.semantic_release.branches.other]
match = ".*"
prerelease = true
prerelease-token = "rc"
