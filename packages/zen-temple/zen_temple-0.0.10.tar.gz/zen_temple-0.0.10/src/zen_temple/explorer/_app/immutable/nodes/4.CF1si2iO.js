import{s as it,e as p,c as g,b as w,f,y as wt,o as b,i as Q,h as u,z as Xe,A as Ze,n as $e,B as Et,C as yt,G as Dt,t as Ct,a as O,d as It,g as S,D as xe,j as kt,E as Vt,r as j,m as le,v as Me,w as z,F as et}from"../chunks/scheduler.Bjr9RZaN.js";import{S as at,i as rt,b as B,c as ve,d as me,m as we,t as x,a as se,e as Tt,f as Ee,g as Ht}from"../chunks/index.NoFf4Nre.js";import{S as Lt,B as Mt,b as Ot,c as St,f as jt}from"../chunks/utils.DTNE4jQA.js";import{e as tt}from"../chunks/each.D6YF6ztN.js";function ot(e,n,o){const a=e.slice();return a[8]=n[o],a}function nt(e){let n,o=e[8]+"",a,i,m;return{c(){n=p("option"),a=Ct(o),i=O(),this.h()},l(c){n=g(c,"OPTION",{});var l=w(n);a=It(l,o),i=S(l),l.forEach(f),this.h()},h(){n.__value=m=e[8],xe(n,n.__value)},m(c,l){Q(c,n,l),u(n,a),u(n,i)},p(c,l){l&2&&o!==(o=c[8]+"")&&kt(a,o),l&2&&m!==(m=c[8])&&(n.__value=m,xe(n,n.__value))},d(c){c&&f(n)}}}function zt(e){let n,o,a,i,m,c=tt(e[1]),l=[];for(let s=0;s<c.length;s+=1)l[s]=nt(ot(e,c,s));return{c(){n=p("div"),o=p("select");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){n=g(s,"DIV",{class:!0});var _=w(n);o=g(_,"SELECT",{});var r=w(o);for(let y=0;y<l.length;y+=1)l[y].l(r);r.forEach(f),_.forEach(f),this.h()},h(){o.disabled=a=!e[2],e[0]===void 0&&wt(()=>e[4].call(o)),b(n,"class","dropdown")},m(s,_){Q(s,n,_),u(n,o);for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(o,null);Xe(o,e[0],!0),i||(m=[Ze(o,"change",e[4]),Ze(o,"change",e[5])],i=!0)},p(s,[_]){if(_&2){c=tt(s[1]);let r;for(r=0;r<c.length;r+=1){const y=ot(s,c,r);l[r]?l[r].p(y,_):(l[r]=nt(y),l[r].c(),l[r].m(o,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=c.length}_&4&&a!==(a=!s[2])&&(o.disabled=a),_&3&&Xe(o,s[0])},i:$e,o:$e,d(s){s&&f(n),Et(l,s),i=!1,yt(m)}}}function Bt(e,n,o){let{options:a}=n,{selected_option:i=a[0]}=n,{enabled:m=!0}=n;a.join("_");const c=Dt();function l(){c("selection-changed",i)}function s(){i=Vt(this),o(0,i),o(1,a)}const _=()=>l();return e.$$set=r=>{"options"in r&&o(1,a=r.options),"selected_option"in r&&o(0,i=r.selected_option),"enabled"in r&&o(2,m=r.enabled)},[i,a,m,l,s,_]}class Ne extends at{constructor(n){super(),rt(this,n,Bt,zt,it,{options:1,selected_option:0,enabled:2})}}function lt(e){let n,o='<div class="spinner-border center" role="status"><span class="visually-hidden">Loading...</span></div>';return{c(){n=p("div"),n.innerHTML=o,this.h()},l(a){n=g(a,"DIV",{class:!0,"data-svelte-h":!0}),le(n)!=="svelte-57s7b4"&&(n.innerHTML=o),this.h()},h(){b(n,"class","text-center")},m(a,i){Q(a,n,i)},d(a){a&&f(n)}}}function st(e){let n,o,a,i;function m(l){e[24](l)}let c={zoom:!0};return e[10]!==void 0&&(c.config=e[10]),o=new Mt({props:c}),j.push(()=>B(o,"config",m)),{c(){n=p("div"),ve(o.$$.fragment),this.h()},l(l){n=g(l,"DIV",{style:!0});var s=w(n);me(o.$$.fragment,s),s.forEach(f),this.h()},h(){Me(n,"position","relative")},m(l,s){Q(l,n,s),we(o,n,null),i=!0},p(l,s){const _={};!a&&s&1024&&(a=!0,_.config=l[10],z(()=>a=!1)),o.$set(_)},i(l){i||(x(o.$$.fragment,l),i=!0)},o(l){se(o.$$.fragment,l),i=!1},d(l){l&&f(n),Ee(o)}}}function Pt(e){let n,o='<div class="col"><h2>The Energy Balance</h2></div>',a,i,m,c,l,s,_,r='<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">Solution Selection</button>',y,I,H,D,V,ue,ie,fe,_e,pe,G,R,ye='<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">Data selection</button>',ge,N,M,U,W,X,h="Year",A,L,ee,te,he,T,P,Z,be="Node",d,C,Oe,Se,je,ae,$,re,We="Carrier",ze,q,Be,Pe,De,oe,F,Ce,Ie;function dt(t){e[13](t)}function ct(t){e[14](t)}function ut(t){e[15](t)}function ft(t){e[16](t)}function _t(t){e[17](t)}let de={enabled:!e[2]&&!e[3]};e[6]!==void 0&&(de.carriers=e[6]),e[4]!==void 0&&(de.nodes=e[4]),e[8]!==void 0&&(de.years=e[8]),e[0]!==void 0&&(de.selected_solution=e[0]),e[2]!==void 0&&(de.loading=e[2]),D=new Lt({props:de}),j.push(()=>B(D,"carriers",dt)),j.push(()=>B(D,"nodes",ct)),j.push(()=>B(D,"years",ut)),j.push(()=>B(D,"selected_solution",ft)),j.push(()=>B(D,"loading",_t)),D.$on("solution_selected",e[11]);function pt(t){e[18](t)}function gt(t){e[19](t)}let qe={enabled:!e[3]&&!e[2]};e[8]!==void 0&&(qe.options=e[8]),e[9]!==void 0&&(qe.selected_option=e[9]),L=new Ne({props:qe}),j.push(()=>B(L,"options",pt)),j.push(()=>B(L,"selected_option",gt)),L.$on("selection-changed",e[12]);function ht(t){e[20](t)}function bt(t){e[21](t)}let Fe={enabled:!e[3]&&!e[2]};e[4]!==void 0&&(Fe.options=e[4]),e[5]!==void 0&&(Fe.selected_option=e[5]),C=new Ne({props:Fe}),j.push(()=>B(C,"options",ht)),j.push(()=>B(C,"selected_option",bt)),C.$on("selection-changed",e[12]);function vt(t){e[22](t)}function mt(t){e[23](t)}let Ge={enabled:!e[3]&&!e[2]};e[6]!==void 0&&(Ge.options=e[6]),e[7]!==void 0&&(Ge.selected_option=e[7]),q=new Ne({props:Ge}),j.push(()=>B(q,"options",vt)),j.push(()=>B(q,"selected_option",mt)),q.$on("selection-changed",e[12]);let k=e[3]&&lt(),E=!e[3]&&e[1]&&st(e);return{c(){n=p("div"),n.innerHTML=o,a=O(),i=p("div"),m=p("div"),c=p("div"),l=p("div"),s=p("div"),_=p("h2"),_.innerHTML=r,y=O(),I=p("div"),H=p("div"),ve(D.$$.fragment),pe=O(),G=p("div"),R=p("h2"),R.innerHTML=ye,ge=O(),N=p("div"),M=p("div"),U=p("div"),W=p("div"),X=p("h3"),X.textContent=h,A=O(),ve(L.$$.fragment),he=O(),T=p("div"),P=p("div"),Z=p("h3"),Z.textContent=be,d=O(),ve(C.$$.fragment),je=O(),ae=p("div"),$=p("div"),re=p("h3"),re.textContent=We,ze=O(),ve(q.$$.fragment),De=O(),oe=p("div"),F=p("div"),k&&k.c(),Ce=O(),E&&E.c(),this.h()},l(t){n=g(t,"DIV",{class:!0,"data-svelte-h":!0}),le(n)!=="svelte-1d6fcfp"&&(n.innerHTML=o),a=S(t),i=g(t,"DIV",{class:!0});var v=w(i);m=g(v,"DIV",{class:!0});var K=w(m);c=g(K,"DIV",{class:!0,style:!0});var ne=w(c);l=g(ne,"DIV",{class:!0,id:!0});var Y=w(l);s=g(Y,"DIV",{class:!0});var J=w(s);_=g(J,"H2",{class:!0,"data-svelte-h":!0}),le(_)!=="svelte-1oln34a"&&(_.innerHTML=r),y=S(J),I=g(J,"DIV",{id:!0,class:!0,"data-bs-parent":!0});var Ae=w(I);H=g(Ae,"DIV",{class:!0});var Ke=w(H);me(D.$$.fragment,Ke),Ke.forEach(f),Ae.forEach(f),J.forEach(f),pe=S(Y),G=g(Y,"DIV",{class:!0});var ke=w(G);R=g(ke,"H2",{class:!0,"data-svelte-h":!0}),le(R)!=="svelte-1huxmzt"&&(R.innerHTML=ye),ge=S(ke),N=g(ke,"DIV",{id:!0,class:!0,"data-bs-parent":!0});var Re=w(N);M=g(Re,"DIV",{class:!0});var ce=w(M);U=g(ce,"DIV",{class:!0});var Ye=w(U);W=g(Ye,"DIV",{class:!0});var Ve=w(W);X=g(Ve,"H3",{"data-svelte-h":!0}),le(X)!=="svelte-r9e7qt"&&(X.textContent=h),A=S(Ve),me(L.$$.fragment,Ve),Ve.forEach(f),Ye.forEach(f),he=S(ce),T=g(ce,"DIV",{class:!0});var Je=w(T);P=g(Je,"DIV",{class:!0});var Te=w(P);Z=g(Te,"H3",{"data-svelte-h":!0}),le(Z)!=="svelte-ocjo5w"&&(Z.textContent=be),d=S(Te),me(C.$$.fragment,Te),Te.forEach(f),Je.forEach(f),je=S(ce),ae=g(ce,"DIV",{class:!0});var Qe=w(ae);$=g(Qe,"DIV",{class:!0});var He=w($);re=g(He,"H3",{"data-svelte-h":!0}),le(re)!=="svelte-xc22hm"&&(re.textContent=We),ze=S(He),me(q.$$.fragment,He),He.forEach(f),Qe.forEach(f),ce.forEach(f),Re.forEach(f),ke.forEach(f),Y.forEach(f),ne.forEach(f),K.forEach(f),v.forEach(f),De=S(t),oe=g(t,"DIV",{class:!0});var Ue=w(oe);F=g(Ue,"DIV",{class:!0,style:!0});var Le=w(F);k&&k.l(Le),Ce=S(Le),E&&E.l(Le),Le.forEach(f),Ue.forEach(f),this.h()},h(){b(n,"class","row"),b(_,"class","accordion-header"),b(H,"class","accordion-body"),b(I,"id","collapseOne"),b(I,"class","accordion-collapse collapse show"),b(I,"data-bs-parent","#accordionExample"),b(s,"class","accordion-item solution-selection"),b(R,"class","accordion-header"),b(W,"class","col-6"),b(U,"class","row"),b(P,"class","col-6"),b(T,"class","row"),b($,"class","col-6"),b(ae,"class","row"),b(M,"class","accordion-body"),b(N,"id","collapseTwo"),b(N,"class","accordion-collapse collapse"),b(N,"data-bs-parent","#accordionExample"),b(G,"class","accordion-item"),b(l,"class","accordion"),b(l,"id","accordionExample"),b(c,"class","filters"),Me(c,"position","absolute"),Me(c,"width","100%"),b(m,"class","col position-relative"),b(i,"class","row"),b(F,"class","col"),Me(F,"margin-top","400px"),b(oe,"class","row")},m(t,v){Q(t,n,v),Q(t,a,v),Q(t,i,v),u(i,m),u(m,c),u(c,l),u(l,s),u(s,_),u(s,y),u(s,I),u(I,H),we(D,H,null),u(l,pe),u(l,G),u(G,R),u(G,ge),u(G,N),u(N,M),u(M,U),u(U,W),u(W,X),u(W,A),we(L,W,null),u(M,he),u(M,T),u(T,P),u(P,Z),u(P,d),we(C,P,null),u(M,je),u(M,ae),u(ae,$),u($,re),u($,ze),we(q,$,null),Q(t,De,v),Q(t,oe,v),u(oe,F),k&&k.m(F,null),u(F,Ce),E&&E.m(F,null),Ie=!0},p(t,[v]){const K={};v&12&&(K.enabled=!t[2]&&!t[3]),!V&&v&64&&(V=!0,K.carriers=t[6],z(()=>V=!1)),!ue&&v&16&&(ue=!0,K.nodes=t[4],z(()=>ue=!1)),!ie&&v&256&&(ie=!0,K.years=t[8],z(()=>ie=!1)),!fe&&v&1&&(fe=!0,K.selected_solution=t[0],z(()=>fe=!1)),!_e&&v&4&&(_e=!0,K.loading=t[2],z(()=>_e=!1)),D.$set(K);const ne={};v&12&&(ne.enabled=!t[3]&&!t[2]),!ee&&v&256&&(ee=!0,ne.options=t[8],z(()=>ee=!1)),!te&&v&512&&(te=!0,ne.selected_option=t[9],z(()=>te=!1)),L.$set(ne);const Y={};v&12&&(Y.enabled=!t[3]&&!t[2]),!Oe&&v&16&&(Oe=!0,Y.options=t[4],z(()=>Oe=!1)),!Se&&v&32&&(Se=!0,Y.selected_option=t[5],z(()=>Se=!1)),C.$set(Y);const J={};v&12&&(J.enabled=!t[3]&&!t[2]),!Be&&v&64&&(Be=!0,J.options=t[6],z(()=>Be=!1)),!Pe&&v&128&&(Pe=!0,J.selected_option=t[7],z(()=>Pe=!1)),q.$set(J),t[3]?k||(k=lt(),k.c(),k.m(F,Ce)):k&&(k.d(1),k=null),!t[3]&&t[1]?E?(E.p(t,v),v&10&&x(E,1)):(E=st(t),E.c(),x(E,1),E.m(F,null)):E&&(Ht(),se(E,1,1,()=>{E=null}),Tt())},i(t){Ie||(x(D.$$.fragment,t),x(L.$$.fragment,t),x(C.$$.fragment,t),x(q.$$.fragment,t),x(E),Ie=!0)},o(t){se(D.$$.fragment,t),se(L.$$.fragment,t),se(C.$$.fragment,t),se(q.$$.fragment,t),se(E),Ie=!1},d(t){t&&(f(n),f(a),f(i),f(De),f(oe)),Ee(D),Ee(L),Ee(C),Ee(q),k&&k.d(),E&&E.d()}}}function qt(e,n,o){var a=["rgb(75, 192, 192)","rgb(54, 162, 235)","rgb(255, 206, 86)","rgb(153, 102, 255)","rgb(255, 159, 64)","rgb(255, 99, 132)","rgb(201, 203, 207)","rgb(220,20,60)","rgb(255,99,71)","rgb(255,69,0)","rgb(154,205,50)","rgb(0,100,0)","rgb(50,205,50)","rgb(0,139,139)","rgb(153,50,204)","rgb(255,105,180)"];let i=null,m=!1,c=!1,l=!1,s=[],_=null,r=[],y=null,I=[],H=null;const D={counter:1,type:"line",data:{datasets:[]},options:{animation:!1,normalized:!0,elements:{point:{radius:0}},responsive:!0,scales:{x:{stacked:!0,title:{display:!0,text:"Time"}},y:{stacked:!0,title:{display:!0,text:"Power"}}},borderWidth:1,plugins:{zoom:{pan:{enabled:!0,modifierKey:"ctrl",mode:"x"},zoom:{drag:{enabled:!0},wheel:{enabled:!0},mode:"x"}}}}};let V=structuredClone(D);async function ue(){i&&(o(10,V=structuredClone(D)),o(5,_=s[0]),o(7,y=r[0]),o(9,H=I[0]),o(1,m=!1),await ie())}async function ie(){if(o(3,l=!0),et(),_==null||y==null||H==null||i==null){o(3,l=!1);return}let h=Math.floor((H-i.detail.system.reference_year)/i.detail.system.interval_between_years);console.log("Getting energy balance.");let A=await Ot(i.solution_name,_,y,i.scenario_name,h),L=await St(i.solution_name,"flow_export",i.scenario_name),ee=[],te=0;for(const T in A){let P={node:[_]};if(A[T]==null||A[T].data.length==0)continue;if("technology"in A[T].data[0]){let d=[];for(const C of A[T].data)d.push(C.technology);P={technology:d}}let Z={},be=jt(A[T].data,P,Z);if(be.length!=0)for(let d of be){if(Object.keys(d.data).length==0)continue;switch(T){case"flow_storage_discharge":d.label=d.label+" (discharge)";case"flow_transport_in":d.label=d.label+" (transport in)";case"flow_import":d.label="Import";case"shed_demand":d.label="Shed Demand";case"flow_storage_charge":d.label=d.label+" (charge)";case"flow_transport_out":d.label=d.label+" (transport out)";case"plot_name":d.label="Export"}let C="line";Object.keys(d.data).length==1&&(C="bar"),T=="demand"?(d.label="Demand",d.type="line",d.stack="ownCustomStack",d.fill=!1,d.borderColor="black",d.backgroundColor="white",d.borderWidth=2,d.stepped=!0,Object.keys(d.data).length==1&&(d.pointRadius=2)):(d.type=C,d.fill="origin",d.borderColor=a[te%a.length],d.backgroundColor=a[te%a.length].replace(")",", 1)"),d.stepped=!0,d.cubicInterpolationMode="monotone"),ee.push(d),te++}}o(10,V.data.labels=Object.keys(ee[0].data),V),o(10,V.data.datasets=ee,V),o(10,V.options.scales.y.title.text="Power ["+L+"]",V),o(3,l=!1),o(1,m=!0);let he=performance.now();await et(),console.log("Building plot took",performance.now()-he)}function fe(h){r=h,o(6,r)}function _e(h){s=h,o(4,s)}function pe(h){I=h,o(8,I)}function G(h){i=h,o(0,i)}function R(h){c=h,o(2,c)}function ye(h){I=h,o(8,I)}function ge(h){H=h,o(9,H)}function N(h){s=h,o(4,s)}function M(h){_=h,o(5,_)}function U(h){r=h,o(6,r)}function W(h){y=h,o(7,y)}function X(h){V=h,o(10,V)}return[i,m,c,l,s,_,r,y,I,H,V,ue,ie,fe,_e,pe,G,R,ye,ge,N,M,U,W,X]}class At extends at{constructor(n){super(),rt(this,n,qt,Pt,it,{})}}export{At as component};
