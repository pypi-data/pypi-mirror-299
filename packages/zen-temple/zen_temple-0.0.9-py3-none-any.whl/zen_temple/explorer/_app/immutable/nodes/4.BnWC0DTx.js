import{s as it,e as p,c as g,b as w,f,y as wt,o as b,i as X,h as u,z as Xe,A as Ze,n as $e,B as Et,C as yt,G as Dt,t as Ct,a as M,d as It,g as O,D as xe,j as kt,E as Vt,r as S,m as se,v as Me,w as j,F as et}from"../chunks/scheduler.Bjr9RZaN.js";import{S as at,i as rt,b as z,c as ve,d as me,m as we,t as te,a as ie,e as Tt,f as Ee,g as Ht}from"../chunks/index.NoFf4Nre.js";import{S as Lt,B as Mt,b as Ot,f as St}from"../chunks/utils.B-k6XDWc.js";import{e as tt}from"../chunks/each.D6YF6ztN.js";function ot(e,n,o){const i=e.slice();return i[8]=n[o],i}function nt(e){let n,o=e[8]+"",i,a,m;return{c(){n=p("option"),i=Ct(o),a=M(),this.h()},l(c){n=g(c,"OPTION",{});var l=w(n);i=It(l,o),a=O(l),l.forEach(f),this.h()},h(){n.__value=m=e[8],xe(n,n.__value)},m(c,l){X(c,n,l),u(n,i),u(n,a)},p(c,l){l&2&&o!==(o=c[8]+"")&&kt(i,o),l&2&&m!==(m=c[8])&&(n.__value=m,xe(n,n.__value))},d(c){c&&f(n)}}}function jt(e){let n,o,i,a,m,c=tt(e[1]),l=[];for(let s=0;s<c.length;s+=1)l[s]=nt(ot(e,c,s));return{c(){n=p("div"),o=p("select");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){n=g(s,"DIV",{class:!0});var _=w(n);o=g(_,"SELECT",{});var r=w(o);for(let y=0;y<l.length;y+=1)l[y].l(r);r.forEach(f),_.forEach(f),this.h()},h(){o.disabled=i=!e[2],e[0]===void 0&&wt(()=>e[4].call(o)),b(n,"class","dropdown")},m(s,_){X(s,n,_),u(n,o);for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(o,null);Xe(o,e[0],!0),a||(m=[Ze(o,"change",e[4]),Ze(o,"change",e[5])],a=!0)},p(s,[_]){if(_&2){c=tt(s[1]);let r;for(r=0;r<c.length;r+=1){const y=ot(s,c,r);l[r]?l[r].p(y,_):(l[r]=nt(y),l[r].c(),l[r].m(o,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=c.length}_&4&&i!==(i=!s[2])&&(o.disabled=i),_&3&&Xe(o,s[0])},i:$e,o:$e,d(s){s&&f(n),Et(l,s),a=!1,yt(m)}}}function zt(e,n,o){let{options:i}=n,{selected_option:a=i[0]}=n,{enabled:m=!0}=n;i.join("_");const c=Dt();function l(){c("selection-changed",a)}function s(){a=Vt(this),o(0,a),o(1,i)}const _=()=>l();return e.$$set=r=>{"options"in r&&o(1,i=r.options),"selected_option"in r&&o(0,a=r.selected_option),"enabled"in r&&o(2,m=r.enabled)},[a,i,m,l,s,_]}class Ne extends at{constructor(n){super(),rt(this,n,zt,jt,it,{options:1,selected_option:0,enabled:2})}}function lt(e){let n,o='<div class="spinner-border center" role="status"><span class="visually-hidden">Loading...</span></div>';return{c(){n=p("div"),n.innerHTML=o,this.h()},l(i){n=g(i,"DIV",{class:!0,"data-svelte-h":!0}),se(n)!=="svelte-57s7b4"&&(n.innerHTML=o),this.h()},h(){b(n,"class","text-center")},m(i,a){X(i,n,a)},d(i){i&&f(n)}}}function st(e){let n,o,i,a;function m(l){e[24](l)}let c={zoom:!0};return e[10]!==void 0&&(c.config=e[10]),o=new Mt({props:c}),S.push(()=>z(o,"config",m)),{c(){n=p("div"),ve(o.$$.fragment),this.h()},l(l){n=g(l,"DIV",{style:!0});var s=w(n);me(o.$$.fragment,s),s.forEach(f),this.h()},h(){Me(n,"position","relative")},m(l,s){X(l,n,s),we(o,n,null),a=!0},p(l,s){const _={};!i&&s&1024&&(i=!0,_.config=l[10],j(()=>i=!1)),o.$set(_)},i(l){a||(te(o.$$.fragment,l),a=!0)},o(l){ie(o.$$.fragment,l),a=!1},d(l){l&&f(n),Ee(o)}}}function Bt(e){let n,o='<div class="col"><h2>The Energy Balance</h2></div>',i,a,m,c,l,s,_,r='<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">Solution Selection</button>',y,I,T,D,H,fe,ae,_e,pe,ge,F,K,ye='<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">Data selection</button>',he,G,L,Z,N,$,h="Year",R,k,oe,be,C,Y,W,J,d="Node",x,B,Oe,Se,je,re,ee,de,Re="Carrier",ze,P,Be,Pe,De,ne,q,Ce,Ie;function dt(t){e[13](t)}function ct(t){e[14](t)}function ut(t){e[15](t)}function ft(t){e[16](t)}function _t(t){e[17](t)}let ce={enabled:!e[2]&&!e[3]};e[6]!==void 0&&(ce.carriers=e[6]),e[4]!==void 0&&(ce.nodes=e[4]),e[8]!==void 0&&(ce.years=e[8]),e[0]!==void 0&&(ce.selected_solution=e[0]),e[2]!==void 0&&(ce.loading=e[2]),D=new Lt({props:ce}),S.push(()=>z(D,"carriers",dt)),S.push(()=>z(D,"nodes",ct)),S.push(()=>z(D,"years",ut)),S.push(()=>z(D,"selected_solution",ft)),S.push(()=>z(D,"loading",_t)),D.$on("solution_selected",e[11]);function pt(t){e[18](t)}function gt(t){e[19](t)}let qe={enabled:!e[3]&&!e[2]};e[8]!==void 0&&(qe.options=e[8]),e[9]!==void 0&&(qe.selected_option=e[9]),k=new Ne({props:qe}),S.push(()=>z(k,"options",pt)),S.push(()=>z(k,"selected_option",gt)),k.$on("selection-changed",e[12]);function ht(t){e[20](t)}function bt(t){e[21](t)}let Fe={enabled:!e[3]&&!e[2]};e[4]!==void 0&&(Fe.options=e[4]),e[5]!==void 0&&(Fe.selected_option=e[5]),B=new Ne({props:Fe}),S.push(()=>z(B,"options",ht)),S.push(()=>z(B,"selected_option",bt)),B.$on("selection-changed",e[12]);function vt(t){e[22](t)}function mt(t){e[23](t)}let Ge={enabled:!e[3]&&!e[2]};e[6]!==void 0&&(Ge.options=e[6]),e[7]!==void 0&&(Ge.selected_option=e[7]),P=new Ne({props:Ge}),S.push(()=>z(P,"options",vt)),S.push(()=>z(P,"selected_option",mt)),P.$on("selection-changed",e[12]);let V=e[3]&&lt(),E=!e[3]&&e[1]&&st(e);return{c(){n=p("div"),n.innerHTML=o,i=M(),a=p("div"),m=p("div"),c=p("div"),l=p("div"),s=p("div"),_=p("h2"),_.innerHTML=r,y=M(),I=p("div"),T=p("div"),ve(D.$$.fragment),ge=M(),F=p("div"),K=p("h2"),K.innerHTML=ye,he=M(),G=p("div"),L=p("div"),Z=p("div"),N=p("div"),$=p("h3"),$.textContent=h,R=M(),ve(k.$$.fragment),C=M(),Y=p("div"),W=p("div"),J=p("h3"),J.textContent=d,x=M(),ve(B.$$.fragment),je=M(),re=p("div"),ee=p("div"),de=p("h3"),de.textContent=Re,ze=M(),ve(P.$$.fragment),De=M(),ne=p("div"),q=p("div"),V&&V.c(),Ce=M(),E&&E.c(),this.h()},l(t){n=g(t,"DIV",{class:!0,"data-svelte-h":!0}),se(n)!=="svelte-1d6fcfp"&&(n.innerHTML=o),i=O(t),a=g(t,"DIV",{class:!0});var v=w(a);m=g(v,"DIV",{class:!0});var A=w(m);c=g(A,"DIV",{class:!0,style:!0});var le=w(c);l=g(le,"DIV",{class:!0,id:!0});var Q=w(l);s=g(Q,"DIV",{class:!0});var U=w(s);_=g(U,"H2",{class:!0,"data-svelte-h":!0}),se(_)!=="svelte-1oln34a"&&(_.innerHTML=r),y=O(U),I=g(U,"DIV",{id:!0,class:!0,"data-bs-parent":!0});var We=w(I);T=g(We,"DIV",{class:!0});var Ae=w(T);me(D.$$.fragment,Ae),Ae.forEach(f),We.forEach(f),U.forEach(f),ge=O(Q),F=g(Q,"DIV",{class:!0});var ke=w(F);K=g(ke,"H2",{class:!0,"data-svelte-h":!0}),se(K)!=="svelte-1huxmzt"&&(K.innerHTML=ye),he=O(ke),G=g(ke,"DIV",{id:!0,class:!0,"data-bs-parent":!0});var Ke=w(G);L=g(Ke,"DIV",{class:!0});var ue=w(L);Z=g(ue,"DIV",{class:!0});var Ye=w(Z);N=g(Ye,"DIV",{class:!0});var Ve=w(N);$=g(Ve,"H3",{"data-svelte-h":!0}),se($)!=="svelte-r9e7qt"&&($.textContent=h),R=O(Ve),me(k.$$.fragment,Ve),Ve.forEach(f),Ye.forEach(f),C=O(ue),Y=g(ue,"DIV",{class:!0});var Je=w(Y);W=g(Je,"DIV",{class:!0});var Te=w(W);J=g(Te,"H3",{"data-svelte-h":!0}),se(J)!=="svelte-ocjo5w"&&(J.textContent=d),x=O(Te),me(B.$$.fragment,Te),Te.forEach(f),Je.forEach(f),je=O(ue),re=g(ue,"DIV",{class:!0});var Qe=w(re);ee=g(Qe,"DIV",{class:!0});var He=w(ee);de=g(He,"H3",{"data-svelte-h":!0}),se(de)!=="svelte-xc22hm"&&(de.textContent=Re),ze=O(He),me(P.$$.fragment,He),He.forEach(f),Qe.forEach(f),ue.forEach(f),Ke.forEach(f),ke.forEach(f),Q.forEach(f),le.forEach(f),A.forEach(f),v.forEach(f),De=O(t),ne=g(t,"DIV",{class:!0});var Ue=w(ne);q=g(Ue,"DIV",{class:!0,style:!0});var Le=w(q);V&&V.l(Le),Ce=O(Le),E&&E.l(Le),Le.forEach(f),Ue.forEach(f),this.h()},h(){b(n,"class","row"),b(_,"class","accordion-header"),b(T,"class","accordion-body"),b(I,"id","collapseOne"),b(I,"class","accordion-collapse collapse show"),b(I,"data-bs-parent","#accordionExample"),b(s,"class","accordion-item solution-selection"),b(K,"class","accordion-header"),b(N,"class","col-6"),b(Z,"class","row"),b(W,"class","col-6"),b(Y,"class","row"),b(ee,"class","col-6"),b(re,"class","row"),b(L,"class","accordion-body"),b(G,"id","collapseTwo"),b(G,"class","accordion-collapse collapse"),b(G,"data-bs-parent","#accordionExample"),b(F,"class","accordion-item"),b(l,"class","accordion"),b(l,"id","accordionExample"),b(c,"class","filters"),Me(c,"position","absolute"),Me(c,"width","100%"),b(m,"class","col position-relative"),b(a,"class","row"),b(q,"class","col"),Me(q,"margin-top","400px"),b(ne,"class","row")},m(t,v){X(t,n,v),X(t,i,v),X(t,a,v),u(a,m),u(m,c),u(c,l),u(l,s),u(s,_),u(s,y),u(s,I),u(I,T),we(D,T,null),u(l,ge),u(l,F),u(F,K),u(F,he),u(F,G),u(G,L),u(L,Z),u(Z,N),u(N,$),u(N,R),we(k,N,null),u(L,C),u(L,Y),u(Y,W),u(W,J),u(W,x),we(B,W,null),u(L,je),u(L,re),u(re,ee),u(ee,de),u(ee,ze),we(P,ee,null),X(t,De,v),X(t,ne,v),u(ne,q),V&&V.m(q,null),u(q,Ce),E&&E.m(q,null),Ie=!0},p(t,[v]){const A={};v&12&&(A.enabled=!t[2]&&!t[3]),!H&&v&64&&(H=!0,A.carriers=t[6],j(()=>H=!1)),!fe&&v&16&&(fe=!0,A.nodes=t[4],j(()=>fe=!1)),!ae&&v&256&&(ae=!0,A.years=t[8],j(()=>ae=!1)),!_e&&v&1&&(_e=!0,A.selected_solution=t[0],j(()=>_e=!1)),!pe&&v&4&&(pe=!0,A.loading=t[2],j(()=>pe=!1)),D.$set(A);const le={};v&12&&(le.enabled=!t[3]&&!t[2]),!oe&&v&256&&(oe=!0,le.options=t[8],j(()=>oe=!1)),!be&&v&512&&(be=!0,le.selected_option=t[9],j(()=>be=!1)),k.$set(le);const Q={};v&12&&(Q.enabled=!t[3]&&!t[2]),!Oe&&v&16&&(Oe=!0,Q.options=t[4],j(()=>Oe=!1)),!Se&&v&32&&(Se=!0,Q.selected_option=t[5],j(()=>Se=!1)),B.$set(Q);const U={};v&12&&(U.enabled=!t[3]&&!t[2]),!Be&&v&64&&(Be=!0,U.options=t[6],j(()=>Be=!1)),!Pe&&v&128&&(Pe=!0,U.selected_option=t[7],j(()=>Pe=!1)),P.$set(U),t[3]?V||(V=lt(),V.c(),V.m(q,Ce)):V&&(V.d(1),V=null),!t[3]&&t[1]?E?(E.p(t,v),v&10&&te(E,1)):(E=st(t),E.c(),te(E,1),E.m(q,null)):E&&(Ht(),ie(E,1,1,()=>{E=null}),Tt())},i(t){Ie||(te(D.$$.fragment,t),te(k.$$.fragment,t),te(B.$$.fragment,t),te(P.$$.fragment,t),te(E),Ie=!0)},o(t){ie(D.$$.fragment,t),ie(k.$$.fragment,t),ie(B.$$.fragment,t),ie(P.$$.fragment,t),ie(E),Ie=!1},d(t){t&&(f(n),f(i),f(a),f(De),f(ne)),Ee(D),Ee(k),Ee(B),Ee(P),V&&V.d(),E&&E.d()}}}function Pt(e,n,o){var i=["rgb(75, 192, 192)","rgb(54, 162, 235)","rgb(255, 206, 86)","rgb(153, 102, 255)","rgb(255, 159, 64)","rgb(255, 99, 132)","rgb(201, 203, 207)","rgb(220,20,60)","rgb(255,99,71)","rgb(255,69,0)","rgb(154,205,50)","rgb(0,100,0)","rgb(50,205,50)","rgb(0,139,139)","rgb(153,50,204)","rgb(255,105,180)"];let a=null,m=!1,c=!1,l=!1,s=[],_=null,r=[],y=null,I=[],T=null;const D={counter:1,type:"line",data:{datasets:[]},options:{animation:!1,normalized:!0,elements:{point:{radius:0}},responsive:!0,scales:{x:{stacked:!0,title:{display:!0,text:"Time"}},y:{stacked:!0,title:{display:!0,text:"Power"}}},borderWidth:1,plugins:{zoom:{pan:{enabled:!0,modifierKey:"ctrl",mode:"x"},zoom:{drag:{enabled:!0},wheel:{enabled:!0},mode:"x"}}}}};let H=structuredClone(D);async function fe(){a&&(o(10,H=structuredClone(D)),o(5,_=s[0]),o(7,y=r[0]),o(9,T=I[0]),o(1,m=!1),await ae())}async function ae(){if(o(3,l=!0),et(),_==null||y==null||T==null||a==null){o(3,l=!1);return}let h=Math.floor((T-a.detail.system.reference_year)/a.detail.system.interval_between_years);console.log("Getting energy balance.");let R=await Ot(a.solution_name,_,y,a.scenario_name,h);console.log("Received",R);let k=[],oe=0;for(const C in R){let Y={node:[_]};if(R[C]==null)continue;if("technology"in R[C].data[0]){let d=[];for(const x of R[C].data)d.push(x.technology);Y={technology:d}}let W={},J=St(R[C].data,Y,W);if(J.length!=0)for(let d of J){if(Object.keys(d.data).length==0)continue;C=="flow_storage_discharge"&&(d.label=d.label+" (discharge)"),C=="flow_transport_in"&&(d.label=d.label+" (transport in)"),C=="flow_import"&&(d.label="Import"),C=="shed_demand"&&(d.label="Shed Demand"),C=="flow_storage_charge"&&(d.label=d.label+" (charge)"),C=="flow_transport_out"&&(d.label=d.label+" (transport out)"),C=="flow_export"&&(d.label="Export");let x="line";Object.keys(d.data).length==1&&(x="bar"),C=="demand"?(d.label="Demand",d.type="line",d.stack="ownCustomStack",d.fill=!1,d.borderColor="black",d.backgroundColor="white",d.borderWidth=2,Object.keys(d.data).length==1&&(d.pointRadius=2)):(d.type=x,d.fill="origin",d.borderColor=i[oe%i.length],d.backgroundColor=i[oe%i.length].replace(")",", 1)"),d.stepped=!0,d.cubicInterpolationMode="monotone"),k.push(d),oe++}}o(10,H.data.labels=Object.keys(k[0].data),H),o(10,H.data.datasets=k,H),o(3,l=!1),o(1,m=!0);let be=performance.now();await et(),console.log("Building plot took",performance.now()-be)}function _e(h){r=h,o(6,r)}function pe(h){s=h,o(4,s)}function ge(h){I=h,o(8,I)}function F(h){a=h,o(0,a)}function K(h){c=h,o(2,c)}function ye(h){I=h,o(8,I)}function he(h){T=h,o(9,T)}function G(h){s=h,o(4,s)}function L(h){_=h,o(5,_)}function Z(h){r=h,o(6,r)}function N(h){y=h,o(7,y)}function $(h){H=h,o(10,H)}return[a,m,c,l,s,_,r,y,I,T,H,fe,ae,_e,pe,ge,F,K,ye,he,G,L,Z,N,$]}class Rt extends at{constructor(n){super(),rt(this,n,Pt,Bt,it,{})}}export{Rt as component};
