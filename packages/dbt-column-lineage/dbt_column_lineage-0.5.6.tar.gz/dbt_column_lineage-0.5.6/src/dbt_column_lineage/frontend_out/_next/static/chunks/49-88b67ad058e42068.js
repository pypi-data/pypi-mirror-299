"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[49],{37215:function(e,t,a){a.d(t,{h:function(){return w}});var s=a(57437),o=a(16463),n=a(2265),r=a(67397),l=a(44390),i=a(44839),c=a(6920),u=a(1970);let d=e=>(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsxs)("div",{className:"text-gray-500",children:[(0,s.jsx)(c.G,{icon:u.cC_,className:"h-[12px] mr-1"}),(0,s.jsx)("span",{children:e.label})]}),(0,s.jsx)("div",{className:"ml-auto",children:(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:e.options.length})})]}),m=e=>{let{value:t,label:a,description:o}=e;return(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{children:a}),(0,s.jsx)("div",{className:"text-gray-500",children:o})]})},h={control:{base:"flex border rounded-md bg-input hover:cursor-pointer min-w-[100px] !min-h-[36px] w-[100%] h-[100%] text-foreground text-foreground",focus:"",nonFocus:"border-border"},option:{base:"hover:cursor-pointer px-3 py-2 rounded flex gap-2 items-center hover:bg-muted !text-sm",focus:"bg-[rgba(var(--primary),0.1)]",selected:"bg-[rgba(var(--primary),0.3)] hover:bg-[rgba(var(--primary),0.3)] text-primary font-bold"}},p={control:e=>{let{isFocused:t}=e;return(0,i.W)(t?h.control.focus:h.control.nonFocus,h.control.base)},option:e=>{let{isSelected:t,isFocused:a}=e;return(0,i.W)(h.option.base,t?h.option.selected:"",a?h.option.focus:"")},menu:()=>"p-1 mt-1 bg-white rounded-md shadow-md",placeholder:()=>"text-placeholder pl-1",input:()=>"text-foreground pl-1",valueContainer:()=>"p-1 gap-1",singleValue:()=>"pl-1",multiValue:()=>"flex bg-[rgba(var(--primary),0.15)] p-0 pl-2 rounded-sm text-xs overflow-hidden",multiValueLabel:()=>"py-1",multiValueRemove:()=>"bg-[rgba(var(--primary),0.1)] hover:bg-[rgba(var(--primary),0.2)] text-primary px-1 ml-2",indicatorsContainer:()=>"p-1 gap-1",clearIndicator:()=>"text-muted-foreground px-1 hover:text-error",indicatorSeparator:()=>"bg-border",dropdownIndicator:()=>"p-1 hover:bg-muted text-muted-foreground rounded-md hover:text-foreground",groupHeading:()=>"ml-3 mt-2 mb-1 text-muted-foreground text-sm",noOptionsMessage:()=>"text-placeholder py-3"},g=e=>{let{options:t,className:a,isMulti:o=!1,value:c,onChange:u,useFormatOptionLabel:h=!1}=e;return(0,s.jsx)(r.ZP,{instanceId:(0,n.useId)(),unstyled:!0,options:t,isMulti:o,value:c,onChange:u,classNames:{...p},className:(0,i.W)(a),formatGroupLabel:d,formatOptionLabel:h?m:void 0,components:{Input:e=>(0,s.jsx)(l.c.Input,{...e,"aria-activedescendant":void 0})}})};var x=a(42421);let b=e=>{let{schemas:t,sources:a,selectedSources:o,columns:r,schema:l,activeSource:c,selectedColumns:u,onSchemaChange:d,onSourcesChange:m,onActiveSourceChange:h,onColumnsChange:p,isMulti:b,className:f}=e,[v,w]=(0,n.useState)(!1),y=(0,n.useRef)(null);return(0,n.useEffect)(()=>{function e(e){y.current&&!y.current.contains(e.target)&&w(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[y]),(0,s.jsxs)("div",{ref:y,className:(0,i.W)("relative inline-block text-left",f),children:[(0,s.jsx)("div",{children:(0,s.jsxs)("button",{type:"button",className:(0,i.W)("inline-flex justify-between w-full rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-100 focus:ring-indigo-500",f),onClick:()=>w(!v),children:[(0,s.jsxs)("span",{children:[l," | ",c," | ",u.join(", ")]}),(0,s.jsx)(x.Z,{className:"ml-2 -mr-1 h-5 w-5","aria-hidden":"true"})]})}),v&&(0,s.jsx)("div",{className:"origin-top-left absolute left-0 mt-2 w-[900px] rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none z-50",children:(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 p-4",role:"menu","aria-orientation":"horizontal","aria-labelledby":"options-menu",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-gray-700 mb-2",children:"Schema"}),(0,s.jsx)(g,{options:t,value:{label:l,value:l},onChange:e=>d(e.value),className:"mb-4"}),(0,s.jsx)("div",{className:"font-medium text-gray-700 mb-2",children:"Sources"}),(0,s.jsx)(g,{options:a,value:o.map(e=>({label:e,value:e})),onChange:(e,t)=>{if(console.log(e,t),b){let a=e.map(e=>e.value);m(a),"select-option"===t.action?h(t.option.value):h(a[0])}else m([e.value]),h(e.value)},className:"mb-2",isMulti:b,useFormatOptionLabel:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-gray-700 mb-2",children:"Active Source"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mb-4",children:o.map(e=>(0,s.jsx)("button",{className:(0,i.W)("px-3 py-1 rounded-md text-sm font-medium",e===c?"bg-indigo-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),onClick:()=>h(e),children:e},e))}),(0,s.jsx)("div",{className:"font-medium text-gray-700 mb-2",children:"Columns"}),r[c]&&(0,s.jsx)(g,{options:r[c],value:u.map(e=>({label:e,value:e})),onChange:e=>{b?p(e.map(e=>e.value)):p([e.value])},className:"mb-2",isMulti:b,useFormatOptionLabel:!0})]})]})})]})};var f=a(45079),v=a(71165);let w=e=>{let{handleFetchData:t}=e,[a,r]=(0,n.useState)("/cl"),[l,i]=(0,n.useState)([]),[u,d]=(0,n.useState)([]),[m,h]=(0,n.useState)({}),[p,g]=(0,n.useState)(!0),[x,w]=(0,n.useState)("obt"),[y,j]=(0,n.useState)(["obt_sales_order"]),[C,N]=(0,n.useState)("obt_sales_order"),[S,k]=(0,n.useState)(["week_ver"]),[L,M]=(0,n.useState)({obt_sales_order:["week_ver"]}),E=(0,v.o)(e=>e.loading),_=(0,v.o)(e=>e.setLoading),P=(0,v.o)(e=>e.showColumn),R=(0,v.o)(e=>e.setShowColumn),I=(0,v.o)(e=>e.setColumnModeEdges),O=(0,o.useRouter)(),W=(0,o.usePathname)(),D=(0,o.useSearchParams)(),z=(0,n.useCallback)(async()=>{let e=await fetch("".concat("","/api/v1/schemas")),t=await e.json();return i(t),t},[]),A=(0,n.useCallback)(async e=>{let t=new URLSearchParams({schema:e}),a=await fetch("".concat("","/api/v1/sources?").concat(t)),s=await a.json();return d(s),s},[x]),F=(0,n.useCallback)(async e=>{let t=new URLSearchParams({source:e}),a=await fetch("".concat("","/api/v1/columns?").concat(t)),s=await a.json();return h(t=>({...t,[e]:s})),s},[x]),U=(0,n.useCallback)(async e=>{w(e),await A(e)},[]),V=(0,n.useCallback)(async e=>{j(e)},[]),G=(0,n.useCallback)(async function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];N(e),m[e]||await F(e),t&&k(L[e]||[])},[x,m,L]),T=(0,n.useCallback)(e=>{k(e),M(t=>({...t,[C]:e}))},[C]),H=(0,n.useCallback)(async function(){let e,a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(a){var s;let t=D.get("schema"),a=(null===(s=D.get("sources"))||void 0===s?void 0:s.split(","))||[],o=D.get("activeSource"),n=JSON.parse(D.get("selectedColumns"))||{},r=D.get("showColumn"),l="true"==r,i=parseInt(D.get("depth"));z(),U(t),V(a),G(o,!1),r&&R(l),M(n),k(n[o]||[]),e={schema:t,sources:a,columns:n,showColumn:l,depth:i}}else e={schema:x,sources:y,columns:L,showColumn:P,depth:NaN};_(!0);let o=await t(e);if(_(!1),I([]),!a&&o){let e=new URLSearchParams({schema:x,sources:y.join(","),activeSource:C,selectedColumns:JSON.stringify(L),showColumn:P.toString()});O.push("".concat(W,"?").concat(e))}},[W,x,y,C,P,L]),J=(0,n.useCallback)(()=>"/cl"===a,[a]);return(0,n.useEffect)(()=>{D.size?H(!0):(z(),A(x),F(C)),W!==a&&r(W)},[]),(0,n.useEffect)(()=>{if(x&&y.length>0){for(let e of y)if(J()&&(!L[e]||0===L[e].length)){g(!0);return}g(!1)}else g(!0)},[x,y,C,L]),(0,s.jsx)("header",{className:"bg-white border-b-[1px]",children:(0,s.jsxs)("nav",{className:"container mr-auto flex flex-wrap flex-col md:flex-row items-center",children:[(0,s.jsx)("a",{className:"flex title-font font-medium items-center text-gray-900 mb-4 md:mb-0",children:(0,s.jsx)("span",{className:"ml-3 text-xl",children:(0,s.jsxs)("select",{value:a,onChange:e=>O.push(e.target.value),children:[(0,s.jsx)("option",{value:"/cte",children:"CTE Lineage"}),(0,s.jsx)("option",{value:"/cl",children:"Column Level Lineage"})]})})}),(0,s.jsxs)("nav",{className:"md:mr-auto md:ml-4 md:py-2 md:pl-4 md:border-l md:border-gray-400 flex flex-wrap items-center text-base justify-center",children:[(0,s.jsx)(b,{schemas:l,sources:u,selectedSources:y,columns:m,schema:x,activeSource:C,selectedColumns:S,onSchemaChange:e=>U(e),onSourcesChange:e=>V(e),onActiveSourceChange:e=>G(e),onColumnsChange:T,className:"mr-2 w-[60vw]",isMulti:J()}),(0,s.jsx)("button",{type:"button",className:"border-[1px] border-blue-400 px-3 py-1.5 bg-blue-400 text-s text-white font-semibold rounded hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>H(),disabled:p,children:E?(0,s.jsx)(c.G,{icon:f.LM3,spinPulse:!0}):(0,s.jsx)("span",{children:"Submit"})})]})]})})}},27289:function(e,t,a){a.d(t,{Y:function(){return o}});var s=a(2265);let o=()=>{let[e,t]=(0,s.useState)({width:0,height:100});return(0,s.useEffect)(()=>{{let e=()=>{t({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)}},[]),e}},71165:function(e,t,a){a.d(t,{o:function(){return s}});let s=(0,a(13e3).Ue)()(e=>({options:{rankdir:"LR"},showColumn:!0,sidebarActive:!1,loading:!1,clearNodePosition:!1,columnModeEdges:[],leftMaxDepth:!1,rightMaxDepth:!1,message:null,messageType:null,setOptions:t=>e({options:t}),setShowColumn:t=>e({showColumn:t}),setSidebarActive:t=>e({sidebarActive:t}),setLoading:t=>e({loading:t}),setClearNodePosition:t=>e({clearNodePosition:t}),setColumnModeEdges:t=>e({columnModeEdges:t}),setLeftMaxDepth:t=>e({leftMaxDepth:t}),setRightMaxDepth:t=>e({rightMaxDepth:t}),setMessage:(t,a)=>e({message:t,messageType:a})}))}}]);