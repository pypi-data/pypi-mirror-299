{
   "bool":{
      "must":[
         
      ],
      "filter":[
         {
            "bool":{
               "filter":[
                  {
                     "bool":{
                        "should":[
                           {
                              "match_phrase":{
                                 "payload.name":"$file_name"
                              }
                           }
                        ],
                        "minimum_should_match":1
                     }
                  },
                  {
                     "bool":{
                        "should":[
                           {
                              "match_phrase":{
                                 "payload.scope":"$file_scope"
                              }
                           }
                        ],
                        "minimum_should_match":1
                     }
                  },
                  {
                     "bool":{
                        "should":[
                           {
                              "match_phrase":{
                                 "event_type":"$file_transfer_type"
                              }
                           }
                        ],
                        "minimum_should_match":1
                     }
                  }
               ]
            }
         }
      ]
   }
}
